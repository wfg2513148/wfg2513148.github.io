<!doctype html><html lang=zh-CN><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color><meta content="Hexo 7.3.0" name=generator><link crossorigin href=https://cdnjs.cloudflare.com rel=preconnect><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><meta content=_ZS2imU4knMegUWG7C18NQWvwS2icy1O2n7QI13BfDs name=google-site-verification><style>:root{--body-bg-color:#fff;--content-bg-color:#fff;--card-bg-color:#f5f5f5;--text-color:#555;--selection-bg:#262a30;--selection-color:#eee;--blockquote-color:#666;--link-color:#555;--link-hover-color:#222;--brand-color:#fff;--brand-hover-color:#fff;--table-row-odd-bg-color:#f9f9f9;--table-row-hover-bg-color:#f5f5f5;--menu-item-bg-color:#f5f5f5;--theme-color:#222;--btn-default-bg:#222;--btn-default-color:#fff;--btn-default-border-color:#222;--btn-default-hover-bg:#fff;--btn-default-hover-color:#222;--btn-default-hover-border-color:#222;--highlight-background:#f3f3f3;--highlight-foreground:#444;--highlight-gutter-background:#e1e1e1;--highlight-gutter-foreground:#555;color-scheme:light}html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{margin:.67em 0;font-size:2em}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace;font-size:1em}a{background:0 0}abbr[title]{border-bottom:none;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace;font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:100%;line-height:1.15}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted buttontext}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;white-space:normal;max-width:100%;padding:0;display:table}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}details{display:block}summary{display:list-item}template,[hidden]{display:none}::selection{background:var(--selection-bg);color:var(--selection-color)}html,body{height:100%}body{background:var(--body-bg-color);box-sizing:border-box;color:var(--text-color);min-height:100%;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-size:1em;line-height:2;transition:padding .2s ease-in-out;position:relative}h1,h2,h3,h4,h5,h6{margin:30px 0 15px;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-weight:700;line-height:1.5}h1{font-size:1.5em}h2{font-size:1.375em}h3{font-size:1.25em}h4{font-size:1.125em}h5{font-size:1em}h6{font-size:.875em}a{color:var(--link-color);cursor:pointer;overflow-wrap:break-word;border-bottom:1px solid #999;outline:0;text-decoration:none}a:hover{border-bottom-color:var(--link-hover-color);color:var(--link-hover-color)}iframe,img,video,embed{max-width:100%;margin-left:auto;margin-right:auto;display:block}hr{background-image:repeating-linear-gradient(-45deg,#ddd,#ddd 4px,#0000 4px 8px);border:0;height:3px;margin:40px 0}blockquote{color:var(--blockquote-color);border-left:4px solid #ddd;margin:0;padding:0 15px}blockquote cite:before{content:"-";padding:0 5px}dt{font-weight:700}dd{margin:0;padding:0}.table-container{overflow:auto}table{border-collapse:collapse;border-spacing:0;width:100%;margin:0 0 20px;font-size:.875em}tbody tr:nth-of-type(odd){background:var(--table-row-odd-bg-color)}tbody tr:hover{background:var(--table-row-hover-bg-color)}caption,th,td{padding:8px}th,td{border:1px solid #ddd;border-bottom-width:3px}th{padding-bottom:10px;font-weight:700}td{border-bottom-width:1px}.btn{background:var(--btn-default-bg);border:2px solid var(--btn-default-border-color);color:var(--btn-default-color);border-radius:0;padding:0 20px;font-size:.875em;line-height:2;transition:background-color .2s ease-in-out;display:inline-block}.btn:hover{background:var(--btn-default-hover-bg);border-color:var(--btn-default-hover-border-color);color:var(--btn-default-hover-color)}.btn+.btn{margin:0 0 8px 8px}.btn .fa-fw{text-align:left;width:1.28571em}.toggle{line-height:0}.toggle .toggle-line{background:#fff;width:100%;height:2px;transition:left .4s,opacity .4s,top .4s,transform .4s,width .4s;display:block;position:relative;top:0;left:0}.toggle .toggle-line:first-child{margin-top:1px}.toggle .toggle-line:not(:first-child){margin-top:4px}.toggle.toggle-arrow :first-child{width:50%;top:2px;transform:rotate(-45deg)}.toggle.toggle-arrow :last-child{width:50%;top:-2px;transform:rotate(45deg)}.toggle.toggle-close :nth-child(2){opacity:0}.toggle.toggle-close :first-child{top:6px;transform:rotate(-45deg)}.toggle.toggle-close :last-child{top:-6px;transform:rotate(45deg)}pre code.hljs{padding:1em;display:block;overflow-x:auto}code.hljs{padding:3px 5px}.hljs{color:#444;background:#f3f3f3}.hljs-comment{color:#697070}.hljs-tag,.hljs-punctuation{color:#444a}.hljs-tag .hljs-name,.hljs-tag .hljs-attr{color:#444}.hljs-keyword,.hljs-attribute,.hljs-selector-tag,.hljs-meta .hljs-keyword,.hljs-doctag,.hljs-name{font-weight:700}.hljs-type,.hljs-string,.hljs-number,.hljs-selector-id,.hljs-selector-class,.hljs-quote,.hljs-template-tag,.hljs-deletion{color:#800}.hljs-title,.hljs-section{color:#800;font-weight:700}.hljs-regexp,.hljs-symbol,.hljs-variable,.hljs-template-variable,.hljs-link,.hljs-selector-attr,.hljs-operator,.hljs-selector-pseudo{color:#ab5656}.hljs-literal{color:#695}.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-addition{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta .hljs-string{color:#38a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.highlight:hover .copy-btn,.code-container:hover .copy-btn{opacity:1}.code-container{position:relative}.copy-btn{color:#333;cursor:pointer;opacity:0;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;padding:2px 6px;font-size:.8125em;line-height:1.6;transition:opacity .2s ease-in-out;position:absolute;top:8px;right:4px}code,kbd,figure.highlight,pre{background:var(--highlight-background);color:var(--highlight-foreground)}figure.highlight,pre{margin:0 auto 20px;line-height:1.6}figure.highlight figcaption,pre .caption{background:var(--highlight-gutter-background);color:var(--highlight-foreground);padding:.5em;font-size:.875em;line-height:1.2;display:flow-root}figure.highlight figcaption a,pre .caption a{color:var(--highlight-foreground);float:right}figure.highlight figcaption a:hover,pre .caption a:hover{border-bottom-color:var(--highlight-foreground)}pre,code{font-family:consolas,Menlo,monospace,PingFang SC,Microsoft YaHei}code{overflow-wrap:break-word;border-radius:3px;padding:2px 4px;font-size:.875em}kbd{white-space:nowrap;border:2px solid #ccc;border-radius:.2em;padding:.1em .3em;font-family:inherit;box-shadow:.1em .1em .2em #0000001a}figure.highlight{position:relative;overflow:auto}figure.highlight pre{border:0;margin:0;padding:10px 0}figure.highlight table{border:0;width:auto;margin:0}figure.highlight td{border:0;padding:0}figure.highlight .gutter{-webkit-user-select:none;user-select:none}figure.highlight .gutter pre{background:var(--highlight-gutter-background);color:var(--highlight-gutter-foreground);text-align:right;padding-left:10px;padding-right:10px}figure.highlight .code pre{width:100%;padding-left:10px}figure.highlight .marked{background:#0000004d}pre .caption{margin-bottom:10px}.gist table{width:auto}.gist table td{border:0}pre{padding:10px;overflow:auto}pre code{text-shadow:none;background:0 0;padding:0}.blockquote-center{text-align:center;border-left:0;margin:40px 0;padding:0;position:relative}.blockquote-center:before,.blockquote-center:after{opacity:.6;width:100%;line-height:1;position:absolute;left:0}.blockquote-center:before{text-align:left;content:"";border-top:1px solid #ccc;font-family:"Font Awesome 6 Free";font-weight:900;top:-20px}.blockquote-center:after{text-align:right;content:"";border-bottom:1px solid #ccc;font-family:"Font Awesome 6 Free";font-weight:900;bottom:-20px}.blockquote-center p,.blockquote-center div{text-align:center}.group-picture{margin-bottom:20px}.group-picture .group-picture-row{gap:3px;margin-bottom:3px;display:flex}.group-picture .group-picture-column{flex:1}.group-picture .group-picture-column img{object-fit:cover;width:100%;height:100%;margin:0}.post-body .label{color:#555;padding:0 2px}.post-body .label.default{background:#f0f0f0}.post-body .label.primary{background:#efe6f7}.post-body .label.info{background:#e5f2f8}.post-body .label.success{background:#e7f4e9}.post-body .label.warning{background:#fcf6e1}.post-body .label.danger{background:#fae8eb}.post-body .link-grid{grid-gap:1.5rem;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem;margin-bottom:20px;padding:1rem;display:grid}.post-body .link-grid .link-grid-container{border:solid #ddd;min-width:0;min-height:5rem;padding:.5rem;transition:background .3s;position:relative;box-shadow:1rem 1rem .5rem #00000080}.post-body .link-grid .link-grid-container:hover{background:var(--card-bg-color);animation:.5s next-shake}.post-body .link-grid .link-grid-container:active{transform:translate(.2rem,.2rem);box-shadow:.5rem .5rem .25rem #00000080}.post-body .link-grid .link-grid-container .link-grid-image{box-sizing:border-box;border:1px solid #ddd;border-radius:50%;width:5rem;height:5rem;padding:3px;position:absolute}.post-body .link-grid .link-grid-container p{margin:0 1rem 0 6rem}.post-body .link-grid .link-grid-container p:first-of-type{font-size:1.2em}.post-body .link-grid .link-grid-container p:last-of-type{opacity:.7;font-size:.8em;line-height:1.3rem}.post-body .link-grid .link-grid-container a{border:0;width:100%;height:100%;position:absolute;top:0;left:0}@keyframes next-shake{0%{transform:translate(1pt,1pt)rotate(0)}10%{transform:translate(-1pt,-2pt)rotate(-1deg)}20%{transform:translate(-3pt)rotate(1deg)}30%{transform:translate(3pt,2pt)rotate(0)}40%{transform:translate(1pt,-1pt)rotate(1deg)}50%{transform:translate(-1pt,2pt)rotate(-1deg)}60%{transform:translate(-3pt,1pt)rotate(0)}70%{transform:translate(3pt,1pt)rotate(-1deg)}80%{transform:translate(-1pt,-1pt)rotate(1deg)}90%{transform:translate(1pt,2pt)rotate(0)}to{transform:translate(1pt,-2pt)rotate(-1deg)}}.post-body .note{border:1px solid #eee;border-left-width:5px;border-radius:3px;margin-bottom:20px;padding:1em;position:relative}.post-body .note summary{cursor:pointer;outline:0}.post-body .note summary p{display:inline}.post-body .note h2,.post-body .note h3,.post-body .note h4,.post-body .note h5,.post-body .note h6{border-bottom:initial;margin:0;padding-top:0}.post-body .note :first-child{margin-top:0}.post-body .note :last-child{margin-bottom:0}.post-body .note.default{border-left-color:#777}.post-body .note.default h2,.post-body .note.default h3,.post-body .note.default h4,.post-body .note.default h5,.post-body .note.default h6{color:#777}.post-body .note.primary{border-left-color:#6f42c1}.post-body .note.primary h2,.post-body .note.primary h3,.post-body .note.primary h4,.post-body .note.primary h5,.post-body .note.primary h6{color:#6f42c1}.post-body .note.info{border-left-color:#428bca}.post-body .note.info h2,.post-body .note.info h3,.post-body .note.info h4,.post-body .note.info h5,.post-body .note.info h6{color:#428bca}.post-body .note.success{border-left-color:#5cb85c}.post-body .note.success h2,.post-body .note.success h3,.post-body .note.success h4,.post-body .note.success h5,.post-body .note.success h6{color:#5cb85c}.post-body .note.warning{border-left-color:#f0ad4e}.post-body .note.warning h2,.post-body .note.warning h3,.post-body .note.warning h4,.post-body .note.warning h5,.post-body .note.warning h6{color:#f0ad4e}.post-body .note.danger{border-left-color:#d9534f}.post-body .note.danger h2,.post-body .note.danger h3,.post-body .note.danger h4,.post-body .note.danger h5,.post-body .note.danger h6{color:#d9534f}.post-body .tabs{margin-bottom:20px}.post-body .tabs,.tabs-comment{padding-top:10px}.post-body .tabs ul.nav-tabs,.tabs-comment ul.nav-tabs{background:var(--body-bg-color);z-index:5;flex-wrap:wrap;justify-content:center;margin:0;padding:0;display:flex;position:sticky;top:0}@media (width<=413px){.post-body .tabs ul.nav-tabs,.tabs-comment ul.nav-tabs{margin-bottom:5px;display:block}}.post-body .tabs ul.nav-tabs li.tab,.tabs-comment ul.nav-tabs li.tab{border:1px solid #0000;border-top-width:3px;border-bottom-color:#ddd;border-radius:0;flex-grow:1;list-style-type:none}@media (width<=413px){.post-body .tabs ul.nav-tabs li.tab,.tabs-comment ul.nav-tabs li.tab{border:1px solid #0000;border-left-width:3px;border-radius:0}}.post-body .tabs ul.nav-tabs li.tab a,.tabs-comment ul.nav-tabs li.tab a{border-bottom:initial;text-align:center;padding:.25em .75em;line-height:1.8;transition:all .2s ease-out;display:block}.post-body .tabs ul.nav-tabs li.tab a i[class^=fa],.tabs-comment ul.nav-tabs li.tab a i[class^=fa]{width:1.28571em}.post-body .tabs ul.nav-tabs li.tab.active,.tabs-comment ul.nav-tabs li.tab.active{border-color:#fc6423 #ddd #0000}@media (width<=413px){.post-body .tabs ul.nav-tabs li.tab.active,.tabs-comment ul.nav-tabs li.tab.active{border-color:#ddd #ddd #ddd #fc6423}}.post-body .tabs ul.nav-tabs li.tab.active a,.tabs-comment ul.nav-tabs li.tab.active a{cursor:default}.post-body .tabs .tab-content,.tabs-comment .tab-content{border:1px solid #ddd;border-top-color:#0000;border-radius:0}@media (width<=413px){.post-body .tabs .tab-content,.tabs-comment .tab-content{border-top-color:#ddd;border-radius:0}}.post-body .tabs .tab-content .tab-pane,.tabs-comment .tab-content .tab-pane{padding:20px 20px 0}.post-body .tabs .tab-content .tab-pane:not(.active),.tabs-comment .tab-content .tab-pane:not(.active){display:none}.pagination .prev,.pagination .next,.pagination .page-number,.pagination .space{margin:-1px 10px 0;padding:0 10px;display:inline-block}@media (width<=767px){.pagination .prev,.pagination .next,.pagination .page-number,.pagination .space{margin:0 5px}}.pagination .page-number.current{color:var(--content-bg-color);background:#ccc;border-color:#ccc}.pagination{text-align:center;border-top:1px solid #eee;margin:120px 0 0}.pagination .prev,.pagination .next,.pagination .page-number{border-top:1px solid #eee;border-bottom:0;transition:border-color .2s ease-in-out}.pagination .prev:hover,.pagination .next:hover,.pagination .page-number:hover{border-top-color:var(--link-hover-color)}@media (width<=767px){.pagination{border-top:0}.pagination .prev,.pagination .next,.pagination .page-number{border-top:0;border-bottom:1px solid #eee}.pagination .prev:hover,.pagination .next:hover,.pagination .page-number:hover{border-bottom-color:var(--link-hover-color)}}.pagination .space{margin:0;padding:0}.comments{margin-top:60px;overflow:hidden}.comment-button-group{flex-wrap:wrap;justify-content:center;margin:1em 0;display:flex}.comment-button-group .comment-button{margin:.1em .2em}.comment-button-group .comment-button.active{background:var(--btn-default-hover-bg);border-color:var(--btn-default-hover-border-color);color:var(--btn-default-hover-color)}.comment-position{display:none}.comment-position.active{display:block}.tabs-comment{margin-top:4em;padding-top:0}.tabs-comment .comments{margin-top:0;padding-top:0}.headband{background:var(--theme-color);height:3px}@media (width<=991px){.headband{display:none}}.site-brand-container{flex-shrink:0;padding:0 10px;display:flex}.use-motion .column,.use-motion .site-brand-container .toggle{opacity:0}.site-meta{text-align:center;flex-grow:1}@media (width<=767px){.site-meta{text-align:center}}.custom-logo-image{margin-top:20px}@media (width<=991px){.custom-logo-image{display:none}}.brand{color:var(--brand-color);border-bottom:0;padding:0 40px;display:inline-block}.brand:hover{color:var(--brand-hover-color)}.site-title{margin:0;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-size:1.375em;font-weight:400;line-height:1.5}.site-subtitle{color:#999;margin:10px 0;font-size:.8125em}.use-motion .site-title,.use-motion .site-subtitle,.use-motion .custom-logo-image{opacity:0;position:relative;top:-10px}.site-nav-toggle,.site-nav-right{display:none}@media (width<=767px){.site-nav-toggle,.site-nav-right{flex-direction:column;justify-content:center;display:flex}}.site-nav-toggle .toggle,.site-nav-right .toggle{color:var(--text-color);width:22px;padding:10px}.site-nav-toggle .toggle .toggle-line,.site-nav-right .toggle .toggle-line{background:var(--text-color);border-radius:1px}@media (width<=767px){.site-nav{--scroll-height:0;visibility:hidden;height:0;transition:height .2s ease-in-out,visibility .2s ease-in-out;overflow:hidden}body:not(.site-nav-on) .site-nav .animated{animation:none}body.site-nav-on .site-nav{height:var(--scroll-height);visibility:unset}}.menu{text-align:center;margin:0;padding:1em 0}.menu-item{margin:0 10px;list-style:none;display:inline-block}@media (width<=767px){.menu-item{margin-top:10px;display:block}.menu-item.menu-item-search{display:none}}.menu-item a{border-bottom:0;font-size:.8125em;transition:border-color .2s ease-in-out;display:block}.menu-item a:hover,.menu-item a.menu-item-active{background:var(--menu-item-bg-color)}.menu-item i[class^=fa]{margin-right:8px}.menu-item .badge{color:#555;text-shadow:none;background:#eee;border-radius:0;margin-left:.35em;padding:1px 4px;font-weight:700;line-height:1}.use-motion .menu-item{visibility:hidden}.sidebar{right:-320px}.sidebar-active .sidebar{right:0}.sidebar{z-index:20;background:#222;width:320px;max-height:100vh;transition:left .2s ease-out,right .2s ease-out;position:fixed;top:0;bottom:0;overflow-y:auto;box-shadow:inset 0 2px 6px #000}.sidebar a{color:#999;border-bottom-color:#555}.sidebar a:hover{color:#eee;border-bottom-color:#eee}.links-of-author:not(:first-child){margin-top:15px}.links-of-author a{vertical-align:middle;border-bottom-color:#555;margin-bottom:10px;margin-right:10px;transition:all .2s ease-in-out;display:inline-block}.links-of-author a:before{content:" ";background:#0455ff;border-radius:50%;width:4px;height:4px;margin-right:3px;display:inline-block;transform:translateY(-2px)}.links-of-blogroll-item{padding:0 5px}.popular-posts .popular-posts-item .popular-posts-link:hover{background:0 0}.sidebar-dimmer{opacity:0;visibility:hidden;z-index:10;background:#000;width:100%;height:100%;transition:visibility .4s,opacity .4s;position:fixed;top:0;left:0}.sidebar-active .sidebar-dimmer{opacity:.7;visibility:visible}.sidebar-inner{color:#999;text-align:center;flex-direction:column;justify-content:center;padding:18px 10px;display:flex}.sidebar-toggle{cursor:pointer;opacity:.8;z-index:30;background:#222;width:16px;height:16px;padding:5px;position:fixed;bottom:61px;right:30px}@media (width<=991px){.sidebar-toggle{right:20px}}.sidebar-toggle:hover{opacity:1}@media (width<=991px){.sidebar-toggle{opacity:1}}.sidebar-toggle:hover .toggle-line{background:#87daff}@media (any-hover:hover){body:not(.sidebar-active) .sidebar-toggle:hover :first-child{width:50%;top:2px;transform:rotate(-45deg)}body:not(.sidebar-active) .sidebar-toggle:hover :last-child{width:50%;top:-2px;transform:rotate(45deg)}}.sidebar-active .sidebar-toggle :nth-child(2){opacity:0}.sidebar-active .sidebar-toggle :first-child{top:6px;transform:rotate(-45deg)}.sidebar-active .sidebar-toggle :last-child{top:-6px;transform:rotate(45deg)}.sidebar-nav{pointer-events:none;visibility:hidden;height:0;margin:0;padding-left:0;font-size:.875em;transition:height .2s ease-in-out,visibility .2s ease-in-out;overflow:hidden}.sidebar-nav-active .sidebar-nav{pointer-events:unset;height:calc(2em + 1px);visibility:unset}.sidebar-nav li{color:#666;cursor:pointer;border-bottom:1px solid #0000;transition:border-bottom-color .2s ease-in-out,color .2s ease-in-out;display:inline-block}.sidebar-nav li.sidebar-nav-overview{margin-left:10px}.sidebar-nav li:hover{color:#f5f5f5}.sidebar-toc-active .sidebar-nav-toc,.sidebar-overview-active .sidebar-nav-overview{color:#87daff;border-bottom-color:#87daff;transition-delay:.2s}.sidebar-toc-active .sidebar-nav-toc:hover,.sidebar-overview-active .sidebar-nav-overview:hover{color:#87daff}.sidebar-panel-container{flex:1;align-items:start;padding-top:0;transition:padding-top .2s ease-in-out;display:grid;overflow:hidden auto}.sidebar-nav-active .sidebar-panel-container{padding-top:20px}.sidebar-panel{opacity:0;pointer-events:none;visibility:hidden;grid-area:1/1;height:0;transition:opacity .2s ease-in-out,transform .2s ease-in-out,visibility .2s ease-in-out;animation:.2s ease-in-out deactivate-sidebar-panel;overflow:hidden;transform:translateY(0)}.sidebar-nav-active .sidebar-panel,.sidebar-overview-active .sidebar-panel.post-toc-wrap{transform:translateY(-20px)}.sidebar-overview-active:not(.sidebar-nav-active) .sidebar-panel.post-toc-wrap{transition-delay:0s,.2s,0s}.sidebar-overview-active .sidebar-panel.site-overview-wrap,.sidebar-toc-active .sidebar-panel.post-toc-wrap{opacity:1;pointer-events:unset;height:auto;visibility:unset;transition-delay:.2s,.2s,0s;animation-name:activate-sidebar-panel;transform:translateY(0)}.sidebar-panel.site-overview-wrap{flex-direction:column;justify-content:flex-start;gap:10px;display:flex}@keyframes deactivate-sidebar-panel{0%{height:var(--inactive-panel-height,0)}to{height:var(--active-panel-height,0)}}@keyframes activate-sidebar-panel{0%{height:var(--inactive-panel-height,auto)}to{height:var(--active-panel-height,auto)}}.post-toc{font-size:.875em}.post-toc ol{text-align:left;margin:0;padding:0 2px 0 10px;list-style:none}.post-toc ol>:last-child{margin-bottom:5px}.post-toc ol>ol{padding-left:0}.post-toc ol a{transition:all .2s ease-in-out}.post-toc .nav-item{text-overflow:ellipsis;white-space:nowrap;line-height:1.8;overflow:hidden}.post-toc .nav .nav-child{--height:0;opacity:0;visibility:hidden;height:0;transition:all .2s ease-in-out;overflow:hidden}.post-toc .nav .active>.nav-child{height:var(--height,auto);opacity:1;visibility:unset}.post-toc .nav .active>a{color:#87daff;border-bottom-color:#87daff}.post-toc .nav .active-current>a,.post-toc .nav .active-current>a:hover{color:#87daff}.site-author-image{border:2px solid #333;border-radius:50%;max-width:96px;padding:2px}.site-author-name{color:#f5f5f5;margin:5px 0 0;font-weight:400}.site-description{color:#999;margin-top:5px;font-size:1em}.site-state{flex-wrap:wrap;justify-content:center;line-height:1.4;display:flex}.site-state-item{padding:0 15px}.site-state-item a{border-bottom:0;display:block}.site-state-item-count{font-size:1.25em;font-weight:600;display:block}.site-state-item-name{color:inherit;font-size:.875em}.sidebar .sidebar-button:not(:first-child){margin-top:15px}.sidebar .sidebar-button button{color:#fc6423;cursor:pointer;background:0 0;border:1px solid #fc6423;border-radius:4px;padding:0 15px;line-height:2}.sidebar .sidebar-button button:hover{color:#fff;background:#fc6423}.sidebar .sidebar-button button i[class^=fa]{margin-right:5px}.links-of-author a{font-size:.8125em}.links-of-author i[class^=fa]{margin-right:2px}.cc-license .cc-opacity{opacity:.7;border-bottom:0}.cc-license .cc-opacity:hover{opacity:.9}.cc-license img{display:inline-block}.links-of-blogroll{font-size:.8125em}.links-of-blogroll-title{font-size:.875em;font-weight:600}.links-of-blogroll-list{flex-flow:column wrap;justify-content:center;gap:5px;margin:5px 0 0;padding:0;list-style:none;display:flex}.links-of-blogroll-item{max-width:100%}.links-of-blogroll-item a{box-sizing:border-box;text-overflow:ellipsis;white-space:nowrap;max-width:100%;display:inline-block;overflow:hidden}.footer{color:#999;padding:20px 0;font-size:.875em;transition:left .2s ease-in-out,right .2s ease-in-out}.footer.footer-fixed{position:absolute;bottom:0;left:0;right:0}.footer-inner{box-sizing:border-box;text-align:center;flex-direction:column;justify-content:center;width:700px;margin:0 auto;display:flex}@media (width<=767px){.footer-inner{width:auto}}@media (width>=1200px){.footer-inner{width:800px}}@media (width>=1600px){.footer-inner{width:900px}}.use-motion .footer{opacity:0}.languages{font-size:1.125em;display:inline-block;position:relative}.languages .lang-select-label span{margin:0 .5em}.languages .lang-select{opacity:0;width:100%;height:100%;position:absolute;top:0;left:0}.with-love{color:red;margin:0 5px;animation:1.33s ease-in-out infinite icon-animate;display:inline-block}@keyframes icon-animate{0%,to{transform:scale(1)}10%,30%{transform:scale(.9)}20%,40%,60%,80%{transform:scale(1.1)}50%,70%{transform:scale(1.1)}}.back-to-top{color:#fff;cursor:pointer;opacity:.8;z-index:30;background:#222;align-items:center;height:26px;font-size:12px;transition:bottom .2s ease-in-out;display:flex;position:fixed;bottom:-100px;right:30px}.back-to-top span{margin-right:8px;display:none}.back-to-top .fa{text-align:center;width:26px}@media (width<=991px){.back-to-top{right:20px}}.back-to-top:hover{opacity:1}@media (width<=991px){.back-to-top{opacity:1}}.back-to-top:hover{color:#87daff}.back-to-top.back-to-top-on{bottom:30px}.reading-progress-bar{--progress:0;z-index:50;height:3px;width:var(--progress);background:#37c6c0;position:fixed;top:0;left:0}.rtl.post-body p,.rtl.post-body a,.rtl.post-body h1,.rtl.post-body h2,.rtl.post-body h3,.rtl.post-body h4,.rtl.post-body h5,.rtl.post-body h6,.rtl.post-body li,.rtl.post-body ul,.rtl.post-body ol{direction:rtl;font-family:UKIJ Ekran}.rtl.post-title{font-family:UKIJ Ekran}.post-button{text-align:center;margin-top:40px}.use-motion .post-block,.use-motion .pagination,.use-motion .comments,.use-motion .post-header,.use-motion .post-body,.use-motion .collection-header{visibility:hidden}.posts-collapse .post-content{margin-bottom:35px;margin-left:35px;position:relative}@media (width<=767px){.posts-collapse .post-content{margin-left:0;margin-right:0}}.posts-collapse .post-content .collection-title{font-size:1.125em;position:relative}.posts-collapse .post-content .collection-title:before{content:" ";background:#999;border:1px solid #fff;border-radius:50%;width:10px;height:10px;margin-top:-4px;margin-left:-6px;position:absolute;top:50%}.posts-collapse .post-content .collection-year{margin:60px 0;font-size:1.5em;font-weight:700;position:relative}.posts-collapse .post-content .collection-year .collection-year-count{color:#555;text-shadow:none;background:#eee;border-radius:0;margin-left:.35em;padding:1px 4px;font-size:.75em;font-weight:700;line-height:1}.posts-collapse .post-content .collection-year:before{content:" ";background:#bbb;border-radius:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;position:absolute;top:50%}.posts-collapse .post-content .collection-header{margin-left:20px;display:block}.posts-collapse .post-content .collection-header small{color:#bbb;margin-left:5px}.posts-collapse .post-content .post-header{border-bottom:1px dashed #ccc;margin:30px 2px 0;padding-left:15px;transition:border .2s ease-in-out;position:relative}.posts-collapse .post-content .post-header:before{content:" ";background:#bbb;border:1px solid #fff;border-radius:50%;width:6px;height:6px;transition:background .2s ease-in-out;position:absolute;top:.75em;left:-6px}.posts-collapse .post-content .post-header:hover{border-bottom-color:#666}.posts-collapse .post-content .post-header:hover:before{background:#222}.posts-collapse .post-content .post-meta-container{margin-right:10px;font-size:.75em;display:inline}.posts-collapse .post-content .post-title{display:inline}.posts-collapse .post-content .post-title a{color:var(--link-color);border-bottom:0}.posts-collapse .post-content .post-title .fa{margin-left:5px;font-size:.875em}.posts-collapse .post-content:before{content:" ";background:#f5f5f5;width:4px;height:100%;margin-left:-2px;position:absolute;top:1.25em}.post-body{overflow-wrap:break-word;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif}@media (width>=1200px){.post-body{font-size:1.125em}}@media (width>=992px){.post-body{text-align:justify}}@media (width<=991px){.post-body{text-align:justify}}.post-body h1 .header-anchor,.post-body h2 .header-anchor,.post-body h3 .header-anchor,.post-body h4 .header-anchor,.post-body h5 .header-anchor,.post-body h6 .header-anchor,.post-body h1 .headerlink,.post-body h2 .headerlink,.post-body h3 .headerlink,.post-body h4 .headerlink,.post-body h5 .headerlink,.post-body h6 .headerlink{color:inherit;float:right;opacity:0;border-bottom-style:none;margin-left:10px;font-size:.875em}.post-body h1 .header-anchor:before,.post-body h2 .header-anchor:before,.post-body h3 .header-anchor:before,.post-body h4 .header-anchor:before,.post-body h5 .header-anchor:before,.post-body h6 .header-anchor:before,.post-body h1 .headerlink:before,.post-body h2 .headerlink:before,.post-body h3 .headerlink:before,.post-body h4 .headerlink:before,.post-body h5 .headerlink:before,.post-body h6 .headerlink:before{content:"";font-family:"Font Awesome 6 Free";font-weight:900}.post-body h1:hover .header-anchor,.post-body h2:hover .header-anchor,.post-body h3:hover .header-anchor,.post-body h4:hover .header-anchor,.post-body h5:hover .header-anchor,.post-body h6:hover .header-anchor,.post-body h1:hover .headerlink,.post-body h2:hover .headerlink,.post-body h3:hover .headerlink,.post-body h4:hover .headerlink,.post-body h5:hover .headerlink,.post-body h6:hover .headerlink{opacity:.5}.post-body h1:hover .header-anchor:hover,.post-body h2:hover .header-anchor:hover,.post-body h3:hover .header-anchor:hover,.post-body h4:hover .header-anchor:hover,.post-body h5:hover .header-anchor:hover,.post-body h6:hover .header-anchor:hover,.post-body h1:hover .headerlink:hover,.post-body h2:hover .headerlink:hover,.post-body h3:hover .headerlink:hover,.post-body h4:hover .headerlink:hover,.post-body h5:hover .headerlink:hover,.post-body h6:hover .headerlink:hover{opacity:1}.post-body .exturl .fa{margin-left:4px;font-size:.875em}.post-body figure:not(.highlight) figcaption{color:#999;text-align:center;margin:-15px auto 15px;font-size:.875em;font-weight:700;line-height:1}.post-body iframe,.post-body img,.post-body video,.post-body embed{margin-bottom:20px}.post-body .video-container{width:100%;height:0;margin-bottom:20px;padding-top:75%;position:relative;overflow:hidden}.post-body .video-container iframe,.post-body .video-container object,.post-body .video-container embed{width:100%;height:100%;margin:0;position:absolute;top:0;left:0}.post-gallery{min-height:200px;display:flex}.post-gallery .post-gallery-image{flex:1}.post-gallery .post-gallery-image:not(:first-child){clip-path:polygon(40px 0,100% 0,100% 100%,0 100%);margin-left:-20px}.post-gallery .post-gallery-image:not(:last-child){margin-right:-20px}.post-gallery .post-gallery-image img{object-fit:cover;opacity:1;width:100%;height:100%}.posts-expand .post-gallery{margin-bottom:60px}.posts-collapse .post-gallery{margin:15px 0}.posts-expand .post-header{text-align:center;margin-bottom:60px;font-size:1.125em}.posts-expand .post-title{margin:initial;overflow-wrap:break-word;font-size:1.5em;font-weight:400}.posts-expand .post-title-link{color:var(--link-color);border-bottom:0;max-width:100%;display:inline-block;position:relative}.posts-expand .post-title-link:before{background:var(--link-color);content:"";width:100%;height:2px;transition:transform .2s ease-in-out;position:absolute;bottom:0;left:0;transform:scaleX(0)}.posts-expand .post-title-link:hover:before{transform:scaleX(1)}.posts-expand .post-title-link .fa{margin-left:5px;font-size:.875em}.post-sticky-flag{margin-right:8px;display:inline-block;transform:rotate(30deg)}.posts-expand .post-meta-container{color:#999;margin-top:3px;font-family:Lato,PingFang SC,Microsoft YaHei,sans-serif;font-size:.75em}.posts-expand .post-meta-container .post-description{margin-top:2px;font-size:.875em}.posts-expand .post-meta-container time{border-bottom:1px dashed #999}.post-meta{flex-wrap:wrap;justify-content:center;display:flex}:not(.post-meta-break)+.post-meta-item:before{content:"|";margin:0 .5em}.post-meta-item-icon{margin-right:3px}@media (width<=991px){.post-meta-item-text{display:none}}.post-meta-break{flex-basis:100%;height:0}.post-nav{border-top:1px solid #eee;justify-content:space-between;gap:30px;margin-top:1em;padding:10px 5px 0;display:flex}.post-nav-item{flex:1}.post-nav-item a{border-bottom:0;font-size:.875em;line-height:1.6;display:block}.post-nav-item a:active{top:2px}.post-nav-item .fa{font-size:.75em}.post-nav-item:first-child .fa{margin-right:5px}.post-nav-item:last-child{text-align:right}.post-nav-item:last-child .fa{margin-left:5px}.post-footer{flex-direction:column;justify-content:center;display:flex}.post-eof{background:#ccc;width:8%;height:1px;margin:80px auto 60px}.post-block:last-of-type .post-eof{display:none}.post-copyright ul{background:var(--card-bg-color);border-left:3px solid #ff2a2a;margin:1em 0 0;padding:.5em 1em;list-style:none;position:relative;overflow:hidden}.post-copyright ul:after{content:"";opacity:.1;font-family:"Font Awesome 6 Brands";font-size:200px;position:absolute;top:-150px;right:-50px}.post-tags{text-align:center;margin-top:40px}.post-tags a{font-size:.8125em;display:inline-block}.post-tags a:not(:last-child){margin-right:10px}.social-like{border-top:1px solid #eee;flex-wrap:wrap;justify-content:center;margin-top:1em;padding-top:1em;font-size:.875em;display:flex}.social-like a{border-bottom:none}.reward-container{text-align:center;margin:1em 0 0;padding:1em 0}.reward-container button{color:#87daff;cursor:pointer;vertical-align:text-top;background:0 0;border:2px solid #87daff;border-radius:2px;outline:0;padding:0 15px;line-height:2}.reward-container button:hover{color:#fff;background:#87daff}.post-reward{padding-top:20px;display:none}.post-reward.active{display:block}.post-reward div{display:inline-block}.post-reward div span{display:block}.post-reward img{width:180px;max-width:100%;margin:.8em 2em 0;display:inline-block}@keyframes next-roll{0%{transform:rotate(30deg)}to{transform:rotate(-30deg)}}.category-all-page .category-all-title{text-align:center}.category-all-page .category-all{margin-top:20px}.category-all-page .category-list{margin:0;padding:0;list-style:none}.category-all-page .category-list-item{margin:5px 10px}.category-all-page .category-list-count{color:#555;text-shadow:none;background:#eee;border-radius:0;margin-left:.35em;padding:1px 4px;font-size:.75em;font-weight:700;line-height:1}.category-all-page .category-list-child{padding-left:10px}.event-list hr{background:#222;margin:20px 0 45px}.event-list hr:after{color:#fff;content:"NOW";background:#222;padding:0 5px;font-weight:700;display:inline-block}.event-list .event{--event-background:#222;--event-foreground:#bbb;--event-title:#fff;background:var(--event-background);padding:15px}.event-list .event .event-summary{color:var(--event-title);border-bottom:0;margin:0;padding:0 0 0 35px;position:relative}.event-list .event .event-summary:before{background:var(--event-title);content:" ";border-radius:50%;width:12px;height:12px;margin-top:-6px;animation:1s ease-in-out infinite alternate dot-flash;position:absolute;top:50%;left:0}.event-list .event:nth-of-type(odd) .event-summary:before{animation-delay:.5s}.event-list .event:not(:last-child){margin-bottom:20px}.event-list .event .event-relative-time{color:var(--event-foreground);padding-left:12px;font-size:12px;font-weight:400;display:inline-block}.event-list .event .event-details{color:var(--event-foreground);padding:6px 0 6px 35px;line-height:18px;display:block}.event-list .event .event-details:before{color:var(--event-foreground);width:14px;margin-right:9px;font-family:"Font Awesome 6 Free";font-weight:900;display:inline-block}.event-list .event .event-details.event-location:before{content:""}.event-list .event .event-details.event-duration:before{content:""}.event-list .event .event-details.event-description:before{content:""}.event-list .event-past{--event-background:#f5f5f5;--event-foreground:#999;--event-title:#222}@keyframes dot-flash{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}ul.breadcrumb{text-align:center;margin:1em 0;padding:0 2em;font-size:.75em;list-style:none}ul.breadcrumb li{display:inline}ul.breadcrumb li:not(:first-child):before{content:"/ ";padding:.5em;font-weight:400}ul.breadcrumb li:last-child{font-weight:700}.tag-cloud{text-align:center}.tag-cloud a{margin:10px;display:inline-block}.tag-cloud-0{color:#aaa;border-bottom-color:#aaa}.tag-cloud-1{color:#9a9a9a;border-bottom-color:#9a9a9a}.tag-cloud-2{color:#8b8b8b;border-bottom-color:#8b8b8b}.tag-cloud-3{color:#7c7c7c;border-bottom-color:#7c7c7c}.tag-cloud-4{color:#6c6c6c;border-bottom-color:#6c6c6c}.tag-cloud-5{color:#5d5d5d;border-bottom-color:#5d5d5d}.tag-cloud-6{color:#4e4e4e;border-bottom-color:#4e4e4e}.tag-cloud-7{color:#3e3e3e;border-bottom-color:#3e3e3e}.tag-cloud-8{color:#2f2f2f;border-bottom-color:#2f2f2f}.tag-cloud-9{color:#202020;border-bottom-color:#202020}.tag-cloud-10{color:#111;border-bottom-color:#111}.search-active{overflow:hidden}.search-pop-overlay{visibility:hidden;z-index:40;background:0 0;width:100%;height:100%;transition:visibility .4s,background .4s;display:flex;position:fixed;top:0;left:0}.search-active .search-pop-overlay{visibility:visible;background:#0000004d}.search-popup{background:var(--card-bg-color);border-radius:5px;width:700px;height:80%;margin:auto;transition:transform .4s;transform:scale(0)}.search-active .search-popup{transform:scale(1)}@media (width<=767px){.search-popup{border-radius:0;width:100%;height:100%}}.search-popup .search-icon,.search-popup .popup-btn-close{color:#999;padding:0 10px;font-size:18px}.search-popup .popup-btn-close{cursor:pointer}.search-popup .popup-btn-close:hover .fa{color:#222}.search-popup .search-header{background:#eee;border-top-left-radius:5px;border-top-right-radius:5px;padding:5px;display:flex}.search-popup input.search-input{background:0 0;border:0;outline:0;width:100%}.search-popup input.search-input::-webkit-search-cancel-button{display:none}.search-popup .search-result-container{flex-direction:column;height:calc(100% - 55px);padding:5px 25px;display:flex;overflow:auto}.search-popup .search-result-container hr{flex-shrink:0;margin:5px 0 10px}.search-popup .search-result-container hr:first-child{display:none}.search-popup .search-result-list{margin:0 5px;padding:0}.search-popup a.search-result-title{font-weight:700}.search-popup p.search-result{border-bottom:1px dashed #ccc;margin:0 0 10px;padding:5px 0}.search-popup .search-input-container{flex-grow:1;padding:2px}.search-popup .search-result-icon{color:#ccc;margin:auto}mark.search-keyword{color:#ff2a2a;background:0 0;border-bottom:1px dashed #ff2a2a;font-weight:700}.use-motion .animated{visibility:inherit;animation-fill-mode:none}.use-motion .sidebar .animated{animation-fill-mode:both}header.header{width:700px;margin:0 auto}@media (width<=767px){header.header{width:auto}}@media (width>=1200px){header.header{width:800px}}@media (width>=1600px){header.header{width:900px}}.main-inner{width:700px;margin:0 auto;padding-bottom:60px}@media (width<=767px){.main-inner{width:auto}}@media (width>=1200px){.main-inner{width:800px}}@media (width>=1600px){.main-inner{width:900px}}@media (width<=767px){.main-inner{padding-left:20px;padding-right:20px}}.post-block:first-of-type{padding-top:70px}@media (width<=767px){.post-block:first-of-type{padding-top:35px}}.custom-logo-image{background:#fff;max-width:150px;margin:0 auto 10px;padding:5px}.brand{background:var(--btn-default-bg)}header.header{padding-top:100px}@media (width<=767px){header.header{padding-top:50px}.site-nav{padding-top:30px}.main-menu{border-top:1px solid #ddd;border-bottom:1px solid #ddd}.menu{text-align:left}.menu .menu-item{margin:0 10px}}.menu .menu-item a{border-bottom:1px solid #0000}@media (width<=767px){.menu .menu-item a{align-items:center;padding:5px 10px;display:flex}.menu .menu-item a .badge{margin-left:auto}}.menu .menu-item a:hover,.menu .menu-item a.menu-item-active{border-bottom:1px solid var(--link-hover-color);background:0 0}@media (width<=767px){.menu .menu-item a:hover,.menu .menu-item a.menu-item-active{border-bottom:1px dotted #ddd}}@media (width>=768px){.menu .menu-item i[class^=fa]{width:100%;margin-right:0;line-height:2;display:block}}.sub-menu{margin:10px 0}.sub-menu .menu-item{display:inline-block}@media (width>=1200px){.sidebar-dimmer{display:none}.sidebar-active{padding-right:320px}.sidebar-active .footer-fixed{right:320px}}</style><link integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css rel=stylesheet><link integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"wangfanggang.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"default"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script defer src=/js/config.js></script><meta content="背景介绍该文档是在慕课网实战课程《2019版 微服务时代Spring Boot企业微信点餐系统》基础上总结而成，旨在记录Spring Boot一些相关知识，文章中涉及的代码都经过验证，可以直接使用。该文档作为个人参考资料，会长期更新。  慕课网课程地址：2019版 微服务时代Spring Boot企业微信点餐系统   数据库设计" name=description><meta content=blog property=og:type><meta content="Spring Boot 学习笔记 - 钢钢更新" property=og:title><meta content=https://wangfanggang.com/Java/Spring-Boot/springboot/index.html property=og:url><meta content=钢钢更新 property=og:site_name><meta content="背景介绍该文档是在慕课网实战课程《2019版 微服务时代Spring Boot企业微信点餐系统》基础上总结而成，旨在记录Spring Boot一些相关知识，文章中涉及的代码都经过验证，可以直接使用。该文档作为个人参考资料，会长期更新。  慕课网课程地址：2019版 微服务时代Spring Boot企业微信点餐系统   数据库设计" property=og:description><meta content=zh_CN property=og:locale><meta content=https://ws1.sinaimg.cn/large/006By2pOly1fqtw3beahmj31180hkagc.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtxavgcapj30jo1cutd6.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw5sy788j30ba07iwfj.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw6o45k2j310y0ic775.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw7kkua2j30f20k8dj7.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw8fmgikj30y20kc7ee.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw9uogcsj30xk0k2aif.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwalwu5rj30zw0xaqin.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwb52h5hj30zo0nuady.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwbonwzqj30zq0nq7ah.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwc5p7uxj30vy03gwfu.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwdeszlaj322y0o6hdt.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwe4wby1j31kc0soqcc.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwfjyju6j30tc12s175.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwgrmsg0j31a80mm10h.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwhe1igxj30xy0cmdif.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwin8e8rj31d80wyn9d.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwjifycyj30vi14cwo5.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwk4t00xj30zk0bcq6o.jpg property=og:image><meta content=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwl62vk3j31cq0wkdox.jpg property=og:image><meta content=2018-04-29T14:41:35.000Z property=article:published_time><meta content=2020-01-03T07:39:26.000Z property=article:modified_time><meta content="王方钢 / Kenny Wang" property=article:author><meta content=Java property=article:tag><meta content="Spring Boot" property=article:tag><meta content=summary name=twitter:card><meta content=https://ws1.sinaimg.cn/large/006By2pOly1fqtw3beahmj31180hkagc.jpg name=twitter:image><link href=https://wangfanggang.com/Java/Spring-Boot/springboot/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wangfanggang.com/Java/Spring-Boot/springboot/","path":"Java/Spring-Boot/springboot/","title":"Spring Boot 学习笔记 - 钢钢更新"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Spring Boot 学习笔记 - 钢钢更新 | 钢钢更新</title><script integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script defer src=/js/utils.js></script><script defer src=/js/motion.js></script><script defer src=/js/sidebar.js></script><script defer src=/js/next-boot.js></script><script integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js></script><script defer src=/js/third-party/search/local-search.js></script><script defer src=/js/third-party/addtoany.js></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>钢钢更新</p> <i class=logo-line></i> </a><p class=site-subtitle itemprop=description>用行动改变世界，做个有情怀的技术宅</div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>分类</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-sitemap"><a href=/sitemap.xml rel=section><i class="fa fa-sitemap fa-fw"></i>站点地图</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>搜索 </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=搜索... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D><span class=nav-number>1.</span> <span class=nav-text>背景介绍</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1><span class=nav-number>2.</span> <span class=nav-text>数据库设计</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#API%E6%8E%A5%E5%8F%A3><span class=nav-number>3.</span> <span class=nav-text>API接口</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8><span class=nav-number>3.1.</span> <span class=nav-text>商品列表</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%88%9B%E5%BB%BA%E8%AE%A2%E5%8D%95><span class=nav-number>3.2.</span> <span class=nav-text>创建订单</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8><span class=nav-number>3.3.</span> <span class=nav-text>订单列表</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%9F%A5%E8%AF%A2%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85><span class=nav-number>3.4.</span> <span class=nav-text>查询订单详情</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%96%E6%B6%88%E8%AE%A2%E5%8D%95><span class=nav-number>3.5.</span> <span class=nav-text>取消订单</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%8E%B7%E5%8F%96openid><span class=nav-number>3.6.</span> <span class=nav-text>获取openid</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%94%AF%E4%BB%98%E8%AE%A2%E5%8D%95><span class=nav-number>3.7.</span> <span class=nav-text>支付订单</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#IntelliJ-Idea-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84><span class=nav-number>4.</span> <span class=nav-text>IntelliJ Idea 项目结构</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#POM%E4%BE%9D%E8%B5%96><span class=nav-number>5.</span> <span class=nav-text>POM依赖</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#pom-xml><span class=nav-number>5.1.</span> <span class=nav-text>pom.xml</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE><span class=nav-number>6.</span> <span class=nav-text>应用配置</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6><span class=nav-number>6.1.</span> <span class=nav-text>全局配置文件</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#application-yml><span class=nav-number>6.1.1.</span> <span class=nav-text>application.yml</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%BC%80%E5%8F%91%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6><span class=nav-number>6.2.</span> <span class=nav-text>开发配置文件</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#application-dev-yml><span class=nav-number>6.2.1.</span> <span class=nav-text>application-dev.yml</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%94%9F%E4%BA%A7%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6><span class=nav-number>6.3.</span> <span class=nav-text>生产配置文件</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#application-prod-yml><span class=nav-number>6.3.1.</span> <span class=nav-text>application-prod.yml</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%B1%BB><span class=nav-number>6.4.</span> <span class=nav-text>配置文件类</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#BlogProperties><span class=nav-number>6.4.1.</span> <span class=nav-text>BlogProperties</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%BC%95%E7%94%A8%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF><span class=nav-number>6.5.</span> <span class=nav-text>引用配置信息</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#BlogPropertiesTest><span class=nav-number>6.5.1.</span> <span class=nav-text>BlogPropertiesTest</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6><span class=nav-number>7.</span> <span class=nav-text>自定义配置文件</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#WechatAccountConfig><span class=nav-number>7.1.</span> <span class=nav-text>WechatAccountConfig</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%BC%95%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6><span class=nav-number>8.</span> <span class=nav-text>引用自定义的配置文件</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#WechatMpConfig><span class=nav-number>8.1.</span> <span class=nav-text>WechatMpConfig</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%97%A5%E5%BF%97%E5%A4%84%E7%90%86><span class=nav-number>9.</span> <span class=nav-text>日志处理</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#SLF4j><span class=nav-number>9.1.</span> <span class=nav-text>SLF4j</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Logback><span class=nav-number>9.2.</span> <span class=nav-text>Logback</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#logback-spring-xml><span class=nav-number>9.2.1.</span> <span class=nav-text>logback-spring.xml</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Swagger2-%E6%96%87%E6%A1%A3%E5%B7%A5%E5%85%B7><span class=nav-number>10.</span> <span class=nav-text>Swagger2 文档工具</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%BC%95%E5%85%A5POM%E4%BE%9D%E8%B5%96><span class=nav-number>10.1.</span> <span class=nav-text>引入POM依赖</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%88%9B%E5%BB%BASwagger%E9%85%8D%E7%BD%AE%E7%B1%BB><span class=nav-number>10.2.</span> <span class=nav-text>创建Swagger配置类</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%9C%A8controller%E4%B8%AD%E5%BC%95%E5%85%A5Swagger%E6%B3%A8%E8%A7%A3><span class=nav-number>10.3.</span> <span class=nav-text>在controller中引入Swagger注解</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%90%AF%E5%8A%A8tomcat%E6%9F%A5%E7%9C%8B%E6%96%87%E6%A1%A3><span class=nav-number>10.4.</span> <span class=nav-text>启动tomcat查看文档</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#IDEA%E6%8F%92%E4%BB%B6><span class=nav-number>11.</span> <span class=nav-text>IDEA插件</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#JRebel%E6%8F%92%E4%BB%B6><span class=nav-number>11.1.</span> <span class=nav-text>JRebel插件</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BC%95%E5%85%A5POM%E4%BE%9D%E8%B5%96-1><span class=nav-number>11.1.1.</span> <span class=nav-text>引入POM依赖</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E9%85%8D%E7%BD%AEApplication-java><span class=nav-number>11.1.2.</span> <span class=nav-text>配置Application.java</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E9%85%8D%E7%BD%AEmaven-project%E9%80%89%E9%A1%B9><span class=nav-number>11.1.3.</span> <span class=nav-text>配置maven project选项</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%89%E8%A3%85JRebel%E6%8F%92%E4%BB%B6><span class=nav-number>11.1.4.</span> <span class=nav-text>安装JRebel插件</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E9%85%8D%E7%BD%AEJRebel%E6%8F%92%E4%BB%B6><span class=nav-number>11.1.5.</span> <span class=nav-text>配置JRebel插件</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95><span class=nav-number>11.1.6.</span> <span class=nav-text>运行测试</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#Lombok%E6%8F%92%E4%BB%B6><span class=nav-number>11.2.</span> <span class=nav-text>Lombok插件</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%89%E8%A3%85Lombok%E6%8F%92%E4%BB%B6><span class=nav-number>11.2.1.</span> <span class=nav-text>安装Lombok插件</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%BC%95%E7%94%A8pom%E4%BE%9D%E8%B5%96><span class=nav-number>11.2.2.</span> <span class=nav-text>引用pom依赖</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E7%B1%BB%EF%BC%88%E4%B8%BB%E5%85%A5%E5%8F%A3%EF%BC%89><span class=nav-number>12.</span> <span class=nav-text>项目运行类（主入口）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#SellApplication><span class=nav-number>12.1.</span> <span class=nav-text>SellApplication</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Enums%E6%9E%9A%E4%B8%BE%E7%B1%BB><span class=nav-number>13.</span> <span class=nav-text>Enums枚举类</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#ResultEnum><span class=nav-number>13.1.</span> <span class=nav-text>ResultEnum</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#CodeEnum><span class=nav-number>13.2.</span> <span class=nav-text>CodeEnum</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#OrderStatusEnum><span class=nav-number>13.3.</span> <span class=nav-text>OrderStatusEnum</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#PayStatusEnum><span class=nav-number>13.4.</span> <span class=nav-text>PayStatusEnum</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#ProductStatusEnum><span class=nav-number>13.5.</span> <span class=nav-text>ProductStatusEnum</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Util%E5%B7%A5%E5%85%B7%E7%B1%BB><span class=nav-number>14.</span> <span class=nav-text>Util工具类</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%9E%84%E9%80%A0%E7%BB%93%E6%9E%9CVO%E8%A7%86%E5%9B%BE-ResultVOUtil><span class=nav-number>14.1.</span> <span class=nav-text>构造结果VO视图 - ResultVOUtil</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BAid-KeyUtil><span class=nav-number>14.2.</span> <span class=nav-text>生成随机id - KeyUtil</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#object%E8%BD%ACjson-JsonUtil><span class=nav-number>14.3.</span> <span class=nav-text>object转json - JsonUtil</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Cookie%E5%B7%A5%E5%85%B7%E7%B1%BB-CookieUtil><span class=nav-number>14.4.</span> <span class=nav-text>Cookie工具类 - CookieUtil</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%AF%94%E8%BE%83%E9%87%91%E9%A2%9D-double%E7%B1%BB%E5%9E%8B-%E6%98%AF%E5%90%A6%E7%9B%B8%E7%AD%89-MathUtil><span class=nav-number>14.5.</span> <span class=nav-text>比较金额(double类型)是否相等 - MathUtil</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#EnumUtil><span class=nav-number>14.6.</span> <span class=nav-text>EnumUtil</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Date2LongSerializer><span class=nav-number>14.7.</span> <span class=nav-text>Date2LongSerializer</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Data-Object%E5%B1%82%EF%BC%88Entity%EF%BC%89><span class=nav-number>15.</span> <span class=nav-text>Data Object层（Entity）</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#ProductCategory><span class=nav-number>15.1.</span> <span class=nav-text>ProductCategory</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#ProductInfo><span class=nav-number>15.2.</span> <span class=nav-text>ProductInfo</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#OrderMaster><span class=nav-number>15.3.</span> <span class=nav-text>OrderMaster</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#OrderDetail><span class=nav-number>15.4.</span> <span class=nav-text>OrderDetail</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Repository%E5%B1%82-DAO-JPA><span class=nav-number>16.</span> <span class=nav-text>Repository层 (DAO) - JPA</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Repository%E5%AE%9A%E4%B9%89><span class=nav-number>16.1.</span> <span class=nav-text>Repository定义</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ProductCategoryRepository><span class=nav-number>16.1.1.</span> <span class=nav-text>ProductCategoryRepository</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#repository%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95><span class=nav-number>16.2.</span> <span class=nav-text>repository单元测试</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ProductCategoryRepositoryTest><span class=nav-number>16.2.1.</span> <span class=nav-text>ProductCategoryRepositoryTest</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#ProductInfoRepository><span class=nav-number>16.2.2.</span> <span class=nav-text>ProductInfoRepository</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#OrderMasterRepository><span class=nav-number>16.2.3.</span> <span class=nav-text>OrderMasterRepository</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#OrderDetailRepository><span class=nav-number>16.2.4.</span> <span class=nav-text>OrderDetailRepository</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Service%E5%B1%82><span class=nav-number>17.</span> <span class=nav-text>Service层</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#CategoryService><span class=nav-number>17.1.</span> <span class=nav-text>CategoryService</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#CategoryService-1><span class=nav-number>17.1.1.</span> <span class=nav-text>CategoryService</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#CategoryServiceImpl><span class=nav-number>17.1.2.</span> <span class=nav-text>CategoryServiceImpl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#CategoryServiceImplTest><span class=nav-number>17.1.3.</span> <span class=nav-text>CategoryServiceImplTest</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#ProductService><span class=nav-number>17.2.</span> <span class=nav-text>ProductService</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ProductService-1><span class=nav-number>17.2.1.</span> <span class=nav-text>ProductService</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#ProductServiceImpl><span class=nav-number>17.2.2.</span> <span class=nav-text>ProductServiceImpl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#ProductServiceImplTest><span class=nav-number>17.2.3.</span> <span class=nav-text>ProductServiceImplTest</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#OrderService><span class=nav-number>17.3.</span> <span class=nav-text>OrderService</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#OrderService-1><span class=nav-number>17.3.1.</span> <span class=nav-text>OrderService</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#OrderServiceImpl><span class=nav-number>17.3.2.</span> <span class=nav-text>OrderServiceImpl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#OrderServiceImplTest><span class=nav-number>17.3.3.</span> <span class=nav-text>OrderServiceImplTest</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#BuyerService><span class=nav-number>17.4.</span> <span class=nav-text>BuyerService</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#BuyerService-1><span class=nav-number>17.4.1.</span> <span class=nav-text>BuyerService</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#BuyerServiceImpl><span class=nav-number>17.4.2.</span> <span class=nav-text>BuyerServiceImpl</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Controller%E5%B1%82><span class=nav-number>18.</span> <span class=nav-text>Controller层</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#BuyerProductController><span class=nav-number>18.1.</span> <span class=nav-text>BuyerProductController</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#BuyerOrderController><span class=nav-number>18.2.</span> <span class=nav-text>BuyerOrderController</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#SellerCategoryController><span class=nav-number>18.3.</span> <span class=nav-text>SellerCategoryController</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#SellerOrderController><span class=nav-number>18.4.</span> <span class=nav-text>SellerOrderController</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#SellerProductController><span class=nav-number>18.5.</span> <span class=nav-text>SellerProductController</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#WechatController><span class=nav-number>18.6.</span> <span class=nav-text>WechatController</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#WeixinController><span class=nav-number>18.7.</span> <span class=nav-text>WeixinController</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#VO%E8%A7%86%E5%9B%BE%E5%B1%82><span class=nav-number>19.</span> <span class=nav-text>VO视图层</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%AC%AC%E4%B8%80%E5%B1%82VO-ResultVO><span class=nav-number>19.1.</span> <span class=nav-text>第一层VO - ResultVO</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%AC%AC%E4%BA%8C%E5%B1%82VO-ProductVO><span class=nav-number>19.2.</span> <span class=nav-text>第二层VO - ProductVO</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%AC%AC%E4%B8%89%E5%B1%82VO-ProductInfoVO><span class=nav-number>19.3.</span> <span class=nav-text>第三层VO - ProductInfoVO</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#DTO%E5%B1%82><span class=nav-number>20.</span> <span class=nav-text>DTO层</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#OrderDTO><span class=nav-number>20.1.</span> <span class=nav-text>OrderDTO</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#CartDTO><span class=nav-number>20.2.</span> <span class=nav-text>CartDTO</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Form%E7%B1%BB><span class=nav-number>21.</span> <span class=nav-text>Form类</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#CategoryForm><span class=nav-number>21.1.</span> <span class=nav-text>CategoryForm</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#ProductForm><span class=nav-number>21.2.</span> <span class=nav-text>ProductForm</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#OrderForm><span class=nav-number>21.3.</span> <span class=nav-text>OrderForm</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Exception%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86><span class=nav-number>22.</span> <span class=nav-text>Exception异常处理</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8><span class=nav-number>22.1.</span> <span class=nav-text>自定义异常</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#SellException><span class=nav-number>22.1.1.</span> <span class=nav-text>SellException</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#ResponseBankException><span class=nav-number>22.1.2.</span> <span class=nav-text>ResponseBankException</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#SellerAuthorizeException><span class=nav-number>22.1.3.</span> <span class=nav-text>SellerAuthorizeException</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8><span class=nav-number>22.2.</span> <span class=nav-text>自定义异常处理器</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#SellExceptionHandler><span class=nav-number>22.2.1.</span> <span class=nav-text>SellExceptionHandler</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86><span class=nav-number>22.3.</span> <span class=nav-text>统一异常处理</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ThymeleafTest><span class=nav-number>22.3.1.</span> <span class=nav-text>ThymeleafTest</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%88%9B%E5%BB%BA%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E7%B1%BB><span class=nav-number>22.4.</span> <span class=nav-text>创建全局异常处理类</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%BF%94%E5%9B%9Ejson%E6%A0%BC%E5%BC%8F><span class=nav-number>22.5.</span> <span class=nav-text>返回json格式</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Authorize%E7%94%A8%E6%88%B7%E6%9C%89%E6%95%88%E6%80%A7%E9%89%B4%E5%AE%9A><span class=nav-number>23.</span> <span class=nav-text>Authorize用户有效性鉴定</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#SellerAuthorizeAspect><span class=nav-number>23.1.</span> <span class=nav-text>SellerAuthorizeAspect</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%BD%BF%E7%94%A8Mabatis%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5><span class=nav-number>24.</span> <span class=nav-text>使用Mabatis注解方式实现增删改查</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#mapper%E5%B1%82><span class=nav-number>24.1.</span> <span class=nav-text>mapper层</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ProductCategoryMapper><span class=nav-number>24.1.1.</span> <span class=nav-text>ProductCategoryMapper</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#mapper%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95><span class=nav-number>24.2.</span> <span class=nav-text>mapper单元测试</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ProductCategoryMapperTest><span class=nav-number>24.2.1.</span> <span class=nav-text>ProductCategoryMapperTest</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#DAO%E5%B1%82><span class=nav-number>24.3.</span> <span class=nav-text>DAO层</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#ProductCategoryDao><span class=nav-number>24.3.1.</span> <span class=nav-text>ProductCategoryDao</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AF%B9%E8%B1%A1%E8%BD%AC%E6%8D%A2><span class=nav-number>25.</span> <span class=nav-text>对象转换</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Form%E8%A1%A8%E5%8D%95%E5%AF%B9%E8%B1%A1%EF%BC%88Json%EF%BC%89%E8%BD%AC%E6%88%90DTO><span class=nav-number>25.1.</span> <span class=nav-text>Form表单对象（Json）转成DTO</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#OrderForm2OrderDTOConverter><span class=nav-number>25.1.1.</span> <span class=nav-text>OrderForm2OrderDTOConverter</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#Data-Object%E8%BD%ACDTO><span class=nav-number>25.2.</span> <span class=nav-text>Data Object转DTO</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#OrderMaster2OrderDTOConverter><span class=nav-number>25.2.1.</span> <span class=nav-text>OrderMaster2OrderDTOConverter</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6%E4%B9%B1%E7%A0%81><span class=nav-number>26.</span> <span class=nav-text>中文字符乱码</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#application-properties><span class=nav-number>26.1.</span> <span class=nav-text>application.properties</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#IDEA%E8%AE%BE%E7%BD%AE><span class=nav-number>26.2.</span> <span class=nav-text>IDEA设置</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E7%BD%91%E9%A1%B5%E6%A8%A1%E6%9D%BF><span class=nav-number>27.</span> <span class=nav-text>网页模板</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Freemarker><span class=nav-number>27.1.</span> <span class=nav-text>Freemarker</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#common-header-ftl><span class=nav-number>27.1.1.</span> <span class=nav-text>common/header.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#common-nav-ftl><span class=nav-number>27.1.2.</span> <span class=nav-text>common/nav.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#common-success-ftl><span class=nav-number>27.1.3.</span> <span class=nav-text>common/success.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#common-error-ftl><span class=nav-number>27.1.4.</span> <span class=nav-text>common/error.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#category-index-ftl><span class=nav-number>27.1.5.</span> <span class=nav-text>category/index.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#category-list-ftl><span class=nav-number>27.1.6.</span> <span class=nav-text>category/list.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#product-index-ftl><span class=nav-number>27.1.7.</span> <span class=nav-text>product/index.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#product-list-ftl><span class=nav-number>27.1.8.</span> <span class=nav-text>product/list.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#order-list-ftl><span class=nav-number>27.1.9.</span> <span class=nav-text>order/list.ftl</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#order-detail-ftl><span class=nav-number>27.1.10.</span> <span class=nav-text>order/detail.ftl</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#CSS%E6%A0%B7%E5%BC%8F><span class=nav-number>27.2.</span> <span class=nav-text>CSS样式</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#static-css><span class=nav-number>27.2.1.</span> <span class=nav-text>static/css</span></a><ol class=nav-child><li class="nav-item nav-level-5"><a class=nav-link href=#style-css><span class=nav-number>27.2.1.1.</span> <span class=nav-text>style.css</span></a></ol></ol><li class="nav-item nav-level-3"><a class=nav-link href=#Thymeleaf><span class=nav-number>27.3.</span> <span class=nav-text>Thymeleaf</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#pom-xml-1><span class=nav-number>27.3.1.</span> <span class=nav-text>pom.xml</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#index-html><span class=nav-number>27.3.2.</span> <span class=nav-text>index.html</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#application-properties-1><span class=nav-number>27.3.3.</span> <span class=nav-text>application.properties</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#ThymeleafTest-java><span class=nav-number>27.3.4.</span> <span class=nav-text>ThymeleafTest.java</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C><span class=nav-number>28.</span> <span class=nav-text>数据库操作</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#JDBC%E6%96%B9%E5%BC%8F-JdbcTemplate><span class=nav-number>28.1.</span> <span class=nav-text>JDBC方式 - JdbcTemplate</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#JPA%E6%96%B9%E5%BC%8F-Spring-data-jpa><span class=nav-number>28.2.</span> <span class=nav-text>JPA方式 - Spring-data-jpa</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%AE%9E%E4%BD%93%E7%B1%BB%EF%BC%88Entity%EF%BC%89><span class=nav-number>28.2.1.</span> <span class=nav-text>实体类（Entity）</span></a><ol class=nav-child><li class="nav-item nav-level-5"><a class=nav-link href=#User><span class=nav-number>28.2.1.1.</span> <span class=nav-text>User</span></a></ol><li class="nav-item nav-level-4"><a class=nav-link href=#%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E6%8E%A5%E5%8F%A3%EF%BC%88Repository%EF%BC%89><span class=nav-number>28.2.2.</span> <span class=nav-text>数据访问接口（Repository）</span></a><ol class=nav-child><li class="nav-item nav-level-5"><a class=nav-link href=#UserRepository><span class=nav-number>28.2.2.1.</span> <span class=nav-text>UserRepository</span></a></ol><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95><span class=nav-number>28.2.3.</span> <span class=nav-text>单元测试</span></a><ol class=nav-child><li class="nav-item nav-level-5"><a class=nav-link href=#UserRepositoryTest><span class=nav-number>28.2.3.1.</span> <span class=nav-text>UserRepositoryTest</span></a></ol></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E9%9B%86%E6%88%90Redis><span class=nav-number>29.</span> <span class=nav-text>集成Redis</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE%E9%9B%86%E6%88%90Redis><span class=nav-number>29.1.</span> <span class=nav-text>手动配置集成Redis</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%BF%E7%94%A8spring-boot-starter-data-redis><span class=nav-number>29.2.</span> <span class=nav-text>使用spring-boot-starter-data-redis</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E9%82%AE%E4%BB%B6><span class=nav-number>30.</span> <span class=nav-text>邮件</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BD%BF%E7%94%A8JavaMailSender%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6><span class=nav-number>30.1.</span> <span class=nav-text>使用JavaMailSender发送邮件</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%91%E9%80%81html%E6%A0%BC%E5%BC%8F%E9%82%AE%E4%BB%B6><span class=nav-number>30.2.</span> <span class=nav-text>发送html格式邮件</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%91%E9%80%81%E5%8C%85%E5%90%AB%E5%86%85%E5%B5%8C%E5%9B%BE%E7%89%87%E7%9A%84%E9%82%AE%E4%BB%B6><span class=nav-number>30.3.</span> <span class=nav-text>发送包含内嵌图片的邮件</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%8F%91%E9%80%81%E5%8C%85%E5%90%AB%E9%99%84%E4%BB%B6%E7%9A%84%E9%82%AE%E4%BB%B6><span class=nav-number>30.4.</span> <span class=nav-text>发送包含附件的邮件</span></a></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><img alt="王方钢 / Kenny Wang" class=site-author-image itemprop=image src=/uploads/kwang.jpg><p class=site-author-name itemprop=name>王方钢 / Kenny Wang<div class=site-description itemprop=description></div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>180</span> <span class=site-state-item-name>日志</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>19</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/> <span class=site-state-item-count>64</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/wfg2513148" href=https://github.com/wfg2513148 target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="E-Mail → mailto:wfgdlut@gmail.com" href=mailto:wfgdlut@gmail.com target=_blank><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class=links-of-author-item> <a rel="noopener me" title="Twitter → https://x.com/wfgdlut" href=https://x.com/wfgdlut target=_blank><i class="fab fa-twitter fa-fw"></i>Twitter</a> </span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=zh-CN><link href=https://wangfanggang.com/Java/Spring-Boot/springboot/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/uploads/kwang.jpg itemprop=image> <meta content="王方钢 / Kenny Wang" itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content=钢钢更新 itemprop=name> <meta itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Spring Boot 学习笔记 - 钢钢更新 | 钢钢更新" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Spring Boot 学习笔记 - 钢钢更新</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2018-04-29 14:41:35" datetime=2018-04-29T14:41:35+00:00>2018-04-29</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar-check"></i> </span> <span class=post-meta-item-text>更新于</span> <time title="修改时间：2020-01-03 07:39:26" datetime=2020-01-03T07:39:26+00:00 itemprop=dateModified>2020-01-03</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Java/ itemprop=url rel=index><span itemprop=name>Java</span></a> </span> ， <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/Java/Spring-Boot/ itemprop=url rel=index><span itemprop=name>Spring Boot</span></a> </span> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数> <span class=post-meta-item-icon> <i class="far fa-file-word"></i> </span> <span class=post-meta-item-text>本文字数：</span> <span>15k</span> </span><span class=post-meta-item title=阅读时长> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>阅读时长 ≈</span> <span>53 分钟</span> </span></div></div></header><div class=post-body itemprop=articleBody><h2 id=背景介绍><a class=headerlink href=#背景介绍 title=背景介绍></a>背景介绍</h2><p>该文档是在慕课网实战课程《2019版 微服务时代Spring Boot企业微信点餐系统》基础上总结而成，旨在记录Spring Boot一些相关知识，文章中涉及的代码都经过验证，可以直接使用。<br>该文档作为个人参考资料，会长期更新。<blockquote><p>慕课网课程地址：<a href=https://coding.imooc.com/lesson/117.html rel=noopener target=_blank><strong>2019版 微服务时代Spring Boot企业微信点餐系统</strong> </a></blockquote><h2 id=数据库设计><a class=headerlink href=#数据库设计 title=数据库设计></a>数据库设计</h2><p><img src=https://ws1.sinaimg.cn/large/006By2pOly1fqtw3beahmj31180hkagc.jpg></p><span id=more></span><p><strong>微信点餐数据库</strong> - SQL.md<figure class="highlight sql"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br></pre><td class=code><pre><span class=line><span class=comment>-- 类目</span></span><br><span class=line><span class=keyword>create table</span> `product_category` (</span><br><span class=line>    `category_id` <span class=type>int</span> <span class=keyword>not null</span> auto_increment,</span><br><span class=line>    `category_name` <span class=type>varchar</span>(<span class=number>64</span>) <span class=keyword>not null</span> comment <span class=string>'类目名字'</span>,</span><br><span class=line>    `category_type` <span class=type>int</span> <span class=keyword>not null</span> comment <span class=string>'类目编号'</span>,</span><br><span class=line>    `create_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> comment <span class=string>'创建时间'</span>,</span><br><span class=line>    `update_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> <span class=keyword>on</span> <span class=keyword>update</span> <span class=built_in>current_timestamp</span> comment <span class=string>'修改时间'</span>,</span><br><span class=line>    <span class=keyword>primary key</span> (`category_id`)</span><br><span class=line>);</span><br><span class=line></span><br><span class=line><span class=comment>-- 商品</span></span><br><span class=line><span class=keyword>create table</span> `product_info` (</span><br><span class=line>    `product_id` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `product_name` <span class=type>varchar</span>(<span class=number>64</span>) <span class=keyword>not null</span> comment <span class=string>'商品名称'</span>,</span><br><span class=line>    `product_price` <span class=type>decimal</span>(<span class=number>8</span>,<span class=number>2</span>) <span class=keyword>not null</span> comment <span class=string>'单价'</span>,</span><br><span class=line>    `product_stock` <span class=type>int</span> <span class=keyword>not null</span> comment <span class=string>'库存'</span>,</span><br><span class=line>    `product_description` <span class=type>varchar</span>(<span class=number>64</span>) comment <span class=string>'描述'</span>,</span><br><span class=line>    `product_icon` <span class=type>varchar</span>(<span class=number>512</span>) comment <span class=string>'小图'</span>,</span><br><span class=line>    `product_status` tinyint(<span class=number>3</span>) <span class=keyword>DEFAULT</span> <span class=string>'0'</span> COMMENT <span class=string>'商品状态,0正常1下架'</span>,</span><br><span class=line>    `category_type` <span class=type>int</span> <span class=keyword>not null</span> comment <span class=string>'类目编号'</span>,</span><br><span class=line>    `create_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> comment <span class=string>'创建时间'</span>,</span><br><span class=line>    `update_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> <span class=keyword>on</span> <span class=keyword>update</span> <span class=built_in>current_timestamp</span> comment <span class=string>'修改时间'</span>,</span><br><span class=line>    <span class=keyword>primary key</span> (`product_id`)</span><br><span class=line>);</span><br><span class=line></span><br><span class=line><span class=comment>-- 订单</span></span><br><span class=line><span class=keyword>create table</span> `order_master` (</span><br><span class=line>    `order_id` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `buyer_name` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span> comment <span class=string>'买家名字'</span>,</span><br><span class=line>    `buyer_phone` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span> comment <span class=string>'买家电话'</span>,</span><br><span class=line>    `buyer_address` <span class=type>varchar</span>(<span class=number>128</span>) <span class=keyword>not null</span> comment <span class=string>'买家地址'</span>,</span><br><span class=line>    `buyer_openid` <span class=type>varchar</span>(<span class=number>64</span>) <span class=keyword>not null</span> comment <span class=string>'买家微信openid'</span>,</span><br><span class=line>    `order_amount` <span class=type>decimal</span>(<span class=number>8</span>,<span class=number>2</span>) <span class=keyword>not null</span> comment <span class=string>'订单总金额'</span>,</span><br><span class=line>    `order_status` tinyint(<span class=number>3</span>) <span class=keyword>not null</span> <span class=keyword>default</span> <span class=string>'0'</span> comment <span class=string>'订单状态, 默认为新下单'</span>,</span><br><span class=line>    `pay_status` tinyint(<span class=number>3</span>) <span class=keyword>not null</span> <span class=keyword>default</span> <span class=string>'0'</span> comment <span class=string>'支付状态, 默认未支付'</span>,</span><br><span class=line>    `create_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> comment <span class=string>'创建时间'</span>,</span><br><span class=line>    `update_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> <span class=keyword>on</span> <span class=keyword>update</span> <span class=built_in>current_timestamp</span> comment <span class=string>'修改时间'</span>,</span><br><span class=line>    <span class=keyword>primary key</span> (`order_id`),</span><br><span class=line>    key `idx_buyer_openid` (`buyer_openid`)</span><br><span class=line>);</span><br><span class=line></span><br><span class=line><span class=comment>-- 订单商品</span></span><br><span class=line><span class=keyword>create table</span> `order_detail` (</span><br><span class=line>    `detail_id` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `order_id` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `product_id` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `product_name` <span class=type>varchar</span>(<span class=number>64</span>) <span class=keyword>not null</span> comment <span class=string>'商品名称'</span>,</span><br><span class=line>    `product_price` <span class=type>decimal</span>(<span class=number>8</span>,<span class=number>2</span>) <span class=keyword>not null</span> comment <span class=string>'当前价格,单位分'</span>,</span><br><span class=line>    `product_quantity` <span class=type>int</span> <span class=keyword>not null</span> comment <span class=string>'数量'</span>,</span><br><span class=line>    `product_icon` <span class=type>varchar</span>(<span class=number>512</span>) comment <span class=string>'小图'</span>,</span><br><span class=line>    `create_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> comment <span class=string>'创建时间'</span>,</span><br><span class=line>    `update_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> <span class=keyword>on</span> <span class=keyword>update</span> <span class=built_in>current_timestamp</span> comment <span class=string>'修改时间'</span>,</span><br><span class=line>    <span class=keyword>primary key</span> (`detail_id`),</span><br><span class=line>    key `idx_order_id` (`order_id`)</span><br><span class=line>);</span><br><span class=line></span><br><span class=line><span class=comment>-- 卖家(登录后台使用, 卖家登录之后可能直接采用微信扫码登录，不使用账号密码)</span></span><br><span class=line><span class=keyword>create table</span> `seller_info` (</span><br><span class=line>    `id` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `username` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `password` <span class=type>varchar</span>(<span class=number>32</span>) <span class=keyword>not null</span>,</span><br><span class=line>    `openid` <span class=type>varchar</span>(<span class=number>64</span>) <span class=keyword>not null</span> comment <span class=string>'微信openid'</span>,</span><br><span class=line>    `create_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> comment <span class=string>'创建时间'</span>,</span><br><span class=line>    `update_time` <span class=type>timestamp</span> <span class=keyword>not null</span> <span class=keyword>default</span> <span class=built_in>current_timestamp</span> <span class=keyword>on</span> <span class=keyword>update</span> <span class=built_in>current_timestamp</span> comment <span class=string>'修改时间'</span>,</span><br><span class=line>    <span class=keyword>primary key</span> (`id`)</span><br><span class=line>) comment <span class=string>'卖家信息表'</span>;</span><br></pre></table></figure><h2 id=API接口><a class=headerlink href=#API接口 title=API接口></a>API接口</h2><h3 id=商品列表><a class=headerlink href=#商品列表 title=商品列表></a>商品列表</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>GET /sell/buyer/product/list</span><br></pre></table></figure><p>参数<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>无</span><br></pre></table></figure><p>返回<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line>{</span><br><span class=line>    "code": 0,</span><br><span class=line>    "msg": "成功",</span><br><span class=line>    "data": [</span><br><span class=line>        {</span><br><span class=line>            "name": "热榜",</span><br><span class=line>            "type": 1,</span><br><span class=line>            "foods": [</span><br><span class=line>                {</span><br><span class=line>                    "id": "123456",</span><br><span class=line>                    "name": "皮蛋粥",</span><br><span class=line>                    "price": 1.2,</span><br><span class=line>                    "description": "好吃的皮蛋粥",</span><br><span class=line>                    "icon": "http://xxx.com",</span><br><span class=line>                }</span><br><span class=line>            ]</span><br><span class=line>        },</span><br><span class=line>        {</span><br><span class=line>            "name": "好吃的",</span><br><span class=line>            "type": 2,</span><br><span class=line>            "foods": [</span><br><span class=line>                {</span><br><span class=line>                    "id": "123457",</span><br><span class=line>                    "name": "慕斯蛋糕",</span><br><span class=line>                    "price": 10.9,</span><br><span class=line>                    "description": "美味爽口",</span><br><span class=line>                    "icon": "http://xxx.com",</span><br><span class=line>                }</span><br><span class=line>            ]</span><br><span class=line>        }</span><br><span class=line>    ]</span><br><span class=line>}</span><br></pre></table></figure><h3 id=创建订单><a class=headerlink href=#创建订单 title=创建订单></a>创建订单</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>POST /sell/buyer/order/create</span><br></pre></table></figure><p>参数<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre><td class=code><pre><span class=line>name: "张三"</span><br><span class=line>phone: "18868822111"</span><br><span class=line>address: "慕课网总部"</span><br><span class=line>openid: "ew3euwhd7sjw9diwkq" //用户的微信openid</span><br><span class=line>items: [{</span><br><span class=line>    productId: "1423113435324",</span><br><span class=line>    productQuantity: 2 //购买数量</span><br><span class=line>}]</span><br><span class=line></span><br></pre></table></figure><p>返回<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line>{</span><br><span class=line>  "code": 0,</span><br><span class=line>  "msg": "成功",</span><br><span class=line>  "data": {</span><br><span class=line>      "orderId": "147283992738221" </span><br><span class=line>  }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=订单列表><a class=headerlink href=#订单列表 title=订单列表></a>订单列表</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>GET /sell/buyer/order/list</span><br></pre></table></figure><p>参数<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>openid: 18eu2jwk2kse3r42e2e</span><br><span class=line>page: 0 //从第0页开始</span><br><span class=line>size: 10</span><br></pre></table></figure><p>返回<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br></pre><td class=code><pre><span class=line>{</span><br><span class=line>  "code": 0,</span><br><span class=line>  "msg": "成功",</span><br><span class=line>  "data": [</span><br><span class=line>    {</span><br><span class=line>      "orderId": "161873371171128075",</span><br><span class=line>      "buyerName": "张三",</span><br><span class=line>      "buyerPhone": "18868877111",</span><br><span class=line>      "buyerAddress": "慕课网总部",</span><br><span class=line>      "buyerOpenid": "18eu2jwk2kse3r42e2e",</span><br><span class=line>      "orderAmount": 0,</span><br><span class=line>      "orderStatus": 0,</span><br><span class=line>      "payStatus": 0,</span><br><span class=line>      "createTime": 1490171219,</span><br><span class=line>      "updateTime": 1490171219,</span><br><span class=line>      "orderDetailList": null</span><br><span class=line>    },</span><br><span class=line>    {</span><br><span class=line>      "orderId": "161873371171128076",</span><br><span class=line>      "buyerName": "张三",</span><br><span class=line>      "buyerPhone": "18868877111",</span><br><span class=line>      "buyerAddress": "慕课网总部",</span><br><span class=line>      "buyerOpenid": "18eu2jwk2kse3r42e2e",</span><br><span class=line>      "orderAmount": 0,</span><br><span class=line>      "orderStatus": 0,</span><br><span class=line>      "payStatus": 0,</span><br><span class=line>      "createTime": 1490171219,</span><br><span class=line>      "updateTime": 1490171219,</span><br><span class=line>      "orderDetailList": null</span><br><span class=line>    }]</span><br><span class=line>}</span><br></pre></table></figure><h3 id=查询订单详情><a class=headerlink href=#查询订单详情 title=查询订单详情></a>查询订单详情</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>GET /sell/buyer/order/detail</span><br></pre></table></figure><p>参数<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>openid: 18eu2jwk2kse3r42e2e</span><br><span class=line>orderId: 161899085773669363</span><br></pre></table></figure><p>返回<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line>{</span><br><span class=line>    "code": 0,</span><br><span class=line>    "msg": "成功",</span><br><span class=line>    "data": {</span><br><span class=line>          "orderId": "161899085773669363",</span><br><span class=line>          "buyerName": "李四",</span><br><span class=line>          "buyerPhone": "18868877111",</span><br><span class=line>          "buyerAddress": "慕课网总部",</span><br><span class=line>          "buyerOpenid": "18eu2jwk2kse3r42e2e",</span><br><span class=line>          "orderAmount": 18,</span><br><span class=line>          "orderStatus": 0,</span><br><span class=line>          "payStatus": 0,</span><br><span class=line>          "createTime": 1490177352,</span><br><span class=line>          "updateTime": 1490177352,</span><br><span class=line>          "orderDetailList": [</span><br><span class=line>            {</span><br><span class=line>                "detailId": "161899085974995851",</span><br><span class=line>                "orderId": "161899085773669363",</span><br><span class=line>                "productId": "157875196362360019",</span><br><span class=line>                "productName": "招牌奶茶",</span><br><span class=line>                "productPrice": 9,</span><br><span class=line>                "productQuantity": 2,</span><br><span class=line>                "productIcon": "http://xxx.com",</span><br><span class=line>                "productImage": "http://xxx.com"</span><br><span class=line>            }</span><br><span class=line>        ]</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=取消订单><a class=headerlink href=#取消订单 title=取消订单></a>取消订单</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>POST /sell/buyer/order/cancel</span><br></pre></table></figure><p>参数<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>openid: 18eu2jwk2kse3r42e2e</span><br><span class=line>orderId: 161899085773669363</span><br></pre></table></figure><p>返回<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line>{</span><br><span class=line>    "code": 0,</span><br><span class=line>    "msg": "成功",</span><br><span class=line>    "data": null</span><br><span class=line>}</span><br></pre></table></figure><h3 id=获取openid><a class=headerlink href=#获取openid title=获取openid></a>获取openid</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>重定向到 /sell/wechat/authorize</span><br></pre></table></figure><p>参数<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>returnUrl: http://xxx.com/abc  //【必填】</span><br></pre></table></figure><p>返回<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>http://xxx.com/abc?openid=oZxSYw5ldcxv6H0EU67GgSXOUrVg</span><br></pre></table></figure><h3 id=支付订单><a class=headerlink href=#支付订单 title=支付订单></a>支付订单</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>重定向 /sell/pay/create</span><br></pre></table></figure><p>参数<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line>orderId: 161899085773669363</span><br><span class=line>returnUrl: http://xxx.com/abc/order/161899085773669363</span><br></pre></table></figure><p>返回<figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>http://xxx.com/abc/order/161899085773669363</span><br></pre></table></figure><hr><h2 id=IntelliJ-Idea-项目结构><a title="IntelliJ Idea 项目结构" class=headerlink href=#IntelliJ-Idea-项目结构></a>IntelliJ Idea 项目结构</h2><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtxavgcapj30jo1cutd6.jpg><hr><h2 id=POM依赖><a class=headerlink href=#POM依赖 title=POM依赖></a>POM依赖</h2><h3 id=pom-xml><a class=headerlink href=#pom-xml title=pom.xml></a>pom.xml</h3><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br></pre><td class=code><pre><span class=line><span class=meta>&lt;?xml version=<span class=string>"1.0"</span> encoding=<span class=string>"UTF-8"</span>?></span></span><br><span class=line><span class=tag>&lt;<span class=name>project</span> <span class=attr>xmlns</span>=<span class=string>"http://maven.apache.org/POM/4.0.0"</span> <span class=attr>xmlns:xsi</span>=<span class=string>"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class=line><span class=tag>         <span class=attr>xsi:schemaLocation</span>=<span class=string>"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>modelVersion</span>></span>4.0.0<span class=tag>&lt;/<span class=name>modelVersion</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>com.imooc<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>sell<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>version</span>></span>0.0.1-SNAPSHOT<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>packaging</span>></span>jar<span class=tag>&lt;/<span class=name>packaging</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>name</span>></span>sell<span class=tag>&lt;/<span class=name>name</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>description</span>></span>Demo project for Spring Boot<span class=tag>&lt;/<span class=name>description</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>parent</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-parent<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>version</span>></span>1.5.3.RELEASE<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>relativePath</span>/></span> <span class=comment>&lt;!-- lookup parent from repository --></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>parent</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>properties</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>project.build.sourceEncoding</span>></span>UTF-8<span class=tag>&lt;/<span class=name>project.build.sourceEncoding</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>project.reporting.outputEncoding</span>></span>UTF-8<span class=tag>&lt;/<span class=name>project.reporting.outputEncoding</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>java.version</span>></span>1.8<span class=tag>&lt;/<span class=name>java.version</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>properties</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>dependencies</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-web<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-test<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>scope</span>></span>test<span class=tag>&lt;/<span class=name>scope</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>mysql<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>mysql-connector-java<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-data-jpa<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.projectlombok<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>lombok<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>com.google.code.gson<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>gson<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>com.github.binarywang<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>weixin-java-mp<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>version</span>></span>2.7.0<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>cn.springboot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>best-pay-sdk<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>version</span>></span>1.1.0<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-freemarker<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-data-redis<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-websocket<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.mybatis.spring.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>mybatis-spring-boot-starter<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>version</span>></span>1.2.0<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line></span><br><span class=line>        <span class=comment>&lt;!--&lt;dependency>--></span></span><br><span class=line>        <span class=comment>&lt;!--&lt;groupId>org.springframework.boot&lt;/groupId>--></span></span><br><span class=line>        <span class=comment>&lt;!--&lt;artifactId>spring-boot-starter-cache&lt;/artifactId>--></span></span><br><span class=line>        <span class=comment>&lt;!--&lt;/dependency>--></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>dependencies</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>build</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>finalName</span>></span>sell<span class=tag>&lt;/<span class=name>finalName</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>plugins</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>plugin</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-maven-plugin<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>plugin</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>plugins</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>build</span>></span></span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=tag>&lt;/<span class=name>project</span>></span></span><br></pre></table></figure><hr><h2 id=应用配置><a class=headerlink href=#应用配置 title=应用配置></a>应用配置</h2><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw5sy788j30ba07iwfj.jpg><h3 id=全局配置文件><a class=headerlink href=#全局配置文件 title=全局配置文件></a>全局配置文件</h3><h4 id=application-yml><a class=headerlink href=#application-yml title=application.yml></a>application.yml</h4><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=attr>spring:</span></span><br><span class=line>  <span class=attr>profiles:</span></span><br><span class=line>    <span class=attr>active:</span> <span class=string>dev</span></span><br></pre></table></figure><h3 id=开发配置文件><a class=headerlink href=#开发配置文件 title=开发配置文件></a>开发配置文件</h3><h4 id=application-dev-yml><a class=headerlink href=#application-dev-yml title=application-dev.yml></a>application-dev.yml</h4><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br></pre><td class=code><pre><span class=line><span class=attr>spring:</span></span><br><span class=line>  <span class=attr>datasource:</span></span><br><span class=line>    <span class=attr>driver-class-name:</span> <span class=string>com.mysql.jdbc.Driver</span></span><br><span class=line>    <span class=attr>username:</span> <span class=string>root</span></span><br><span class=line>    <span class=attr>password:</span> <span class=number>123456</span></span><br><span class=line>    <span class=attr>url:</span> <span class=string>jdbc:mysql://192.168.30.113/sell?characterEncoding=utf-8&useSSL=false</span></span><br><span class=line>  <span class=attr>jpa:</span></span><br><span class=line>    <span class=attr>show-sql:</span> <span class=literal>true</span></span><br><span class=line>  <span class=attr>jackson:</span></span><br><span class=line>    <span class=attr>default-property-inclusion:</span> <span class=string>non_null</span></span><br><span class=line>  <span class=attr>redis:</span></span><br><span class=line>    <span class=attr>host:</span> <span class=number>192.168</span><span class=number>.30</span><span class=number>.113</span></span><br><span class=line>    <span class=attr>port:</span> <span class=number>6379</span></span><br><span class=line><span class=attr>server:</span></span><br><span class=line>  <span class=attr>context-path:</span> <span class=string>/sell</span></span><br><span class=line><span class=comment>#logging:</span></span><br><span class=line><span class=comment>#  pattern:</span></span><br><span class=line><span class=comment>#    console: "%d - %msg%n"</span></span><br><span class=line><span class=comment>##  path: /var/log/tomcat/</span></span><br><span class=line><span class=comment>#  file: /var/log/tomcat/sell.log</span></span><br><span class=line><span class=comment>#  level:</span></span><br><span class=line><span class=comment>#    com.imooc.LoggerTest: debug</span></span><br><span class=line></span><br><span class=line><span class=attr>wechat:</span></span><br><span class=line>  <span class=attr>mpAppId:</span> <span class=string>wxd898fcb01713c658</span></span><br><span class=line>  <span class=attr>mpAppSecret:</span> <span class=string>47ccc303338cee6e62894fxxxxxxxxxxx</span></span><br><span class=line>  <span class=attr>openAppId:</span> <span class=string>wx6ad144e54af67d87</span></span><br><span class=line>  <span class=attr>openAppSecret:</span> <span class=string>91a2ff6d38a2bbccfb7e9xxxxxx</span></span><br><span class=line>  <span class=attr>mchId:</span> <span class=number>1483469312</span></span><br><span class=line>  <span class=attr>mchKey:</span> <span class=string>06C56A89949D617xxxxxxxxxxx</span></span><br><span class=line>  <span class=attr>keyPath:</span> <span class=string>/var/weixin_cert/h5.p12</span></span><br><span class=line>  <span class=attr>notifyUrl:</span> <span class=string>http://sell.natapp4.cc/sell/pay/notify</span></span><br><span class=line>  <span class=attr>templateId:</span></span><br><span class=line>    <span class=attr>orderStatus:</span> <span class=string>e-Cqq67QxD6YNI41iRiqawEYdFavW_7pc7LyEMb-yeQ</span></span><br><span class=line></span><br><span class=line><span class=attr>projectUrl:</span></span><br><span class=line>  <span class=attr>wechatMpAuthorize:</span> <span class=string>http://sell.natapp4.cc</span></span><br><span class=line>  <span class=attr>wechatOpenAuthorize:</span> <span class=string>http://sell.natapp4.cc</span></span><br><span class=line>  <span class=attr>sell:</span> <span class=string>http://sell.natapp4.cc</span></span><br><span class=line><span class=attr>logging:</span></span><br><span class=line>  <span class=attr>level:</span></span><br><span class=line>    <span class=attr>com.imooc.dataobject.mapper:</span> <span class=string>trace</span></span><br><span class=line><span class=attr>mybatis:</span></span><br><span class=line>  <span class=attr>mapper-locations:</span> <span class=string>classpath:mapper/*.xml</span></span><br></pre></table></figure><h3 id=生产配置文件><a class=headerlink href=#生产配置文件 title=生产配置文件></a>生产配置文件</h3><h4 id=application-prod-yml><a class=headerlink href=#application-prod-yml title=application-prod.yml></a>application-prod.yml</h4><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br></pre><td class=code><pre><span class=line><span class=attr>spring:</span></span><br><span class=line>  <span class=attr>datasource:</span></span><br><span class=line>    <span class=attr>driver-class-name:</span> <span class=string>com.mysql.jdbc.Driver</span></span><br><span class=line>    <span class=attr>username:</span> <span class=string>root</span></span><br><span class=line>    <span class=attr>password:</span> <span class=number>123456</span></span><br><span class=line>    <span class=attr>url:</span> <span class=string>jdbc:mysql://192.168.30.113/sell?characterEncoding=utf-8&useSSL=false</span></span><br><span class=line>  <span class=attr>jackson:</span></span><br><span class=line>    <span class=attr>default-property-inclusion:</span> <span class=string>non_null</span></span><br><span class=line>  <span class=attr>redis:</span></span><br><span class=line>    <span class=attr>host:</span> <span class=number>192.168</span><span class=number>.30</span><span class=number>.113</span></span><br><span class=line>    <span class=attr>port:</span> <span class=number>6379</span></span><br><span class=line><span class=attr>server:</span></span><br><span class=line>  <span class=attr>context-path:</span> <span class=string>/sell</span></span><br><span class=line><span class=comment>#logging:</span></span><br><span class=line><span class=comment>#  pattern:</span></span><br><span class=line><span class=comment>#    console: "%d - %msg%n"</span></span><br><span class=line><span class=comment>##  path: /var/log/tomcat/</span></span><br><span class=line><span class=comment>#  file: /var/log/tomcat/sell.log</span></span><br><span class=line><span class=comment>#  level:</span></span><br><span class=line><span class=comment>#    com.imooc.LoggerTest: debug</span></span><br><span class=line></span><br><span class=line><span class=attr>wechat:</span></span><br><span class=line>  <span class=attr>mpAppId:</span> <span class=string>wxd898fcb01713c658</span></span><br><span class=line>  <span class=attr>mpAppSecret:</span> <span class=string>47ccc303338cee6e62894fxxxxxxxxxxx</span></span><br><span class=line>  <span class=attr>openAppId:</span> <span class=string>wx6ad144e54af67d87</span></span><br><span class=line>  <span class=attr>openAppSecret:</span> <span class=string>91a2ff6d38a2bbccfb7e9xxxxxx</span></span><br><span class=line>  <span class=attr>mchId:</span> <span class=number>1483469312</span></span><br><span class=line>  <span class=attr>mchKey:</span> <span class=string>06C56A89949D617xxxxxxxxxxx</span></span><br><span class=line>  <span class=attr>keyPath:</span> <span class=string>/var/weixin_cert/h5.p12</span></span><br><span class=line>  <span class=attr>notifyUrl:</span> <span class=string>http://sell.natapp4.cc/sell/pay/notify</span></span><br><span class=line>  <span class=attr>templateId:</span></span><br><span class=line>    <span class=attr>orderStatus:</span> <span class=string>e-Cqq67QxD6YNI41iRiqawEYdFavW_7pc7LyEMb-yeQ</span></span><br><span class=line></span><br><span class=line><span class=attr>projectUrl:</span></span><br><span class=line>  <span class=attr>wechatMpAuthorize:</span> <span class=string>http://sell.natapp4.cc</span></span><br><span class=line>  <span class=attr>wechatOpenAuthorize:</span> <span class=string>http://sell.natapp4.cc</span></span><br><span class=line>  <span class=attr>sell:</span> <span class=string>http://sell.natapp4.cc</span></span><br><span class=line><span class=attr>logging:</span></span><br><span class=line>  <span class=attr>level:</span></span><br><span class=line>    <span class=attr>com.imooc.dataobject.mapper:</span> <span class=string>trace</span></span><br><span class=line><span class=attr>mybatis:</span></span><br><span class=line>  <span class=attr>mapper-locations:</span> <span class=string>classpath:mapper/*.xml</span></span><br></pre></table></figure><h3 id=配置文件类><a class=headerlink href=#配置文件类 title=配置文件类></a>配置文件类</h3><h4 id=BlogProperties><a class=headerlink href=#BlogProperties title=BlogProperties></a>BlogProperties</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.config;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Component;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@ConfigurationProperties(prefix = "com.mindex.blog")</span></span><br><span class=line><span class=meta>@Component</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BlogProperties</span> {</span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>private</span> String desc;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=引用配置信息><a class=headerlink href=#引用配置信息 title=引用配置信息></a>引用配置信息</h3><h4 id=BlogPropertiesTest><a class=headerlink href=#BlogPropertiesTest title=BlogPropertiesTest></a>BlogPropertiesTest</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.config;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BlogPropertiesTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> BlogProperties blogProperties;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">getProperties</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        Assert.assertEquals(<span class=string>"轮子王"</span>, blogProperties.getName());</span><br><span class=line>        Assert.assertEquals(<span class=string>"用行动改变世界"</span>, blogProperties.getDesc());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=自定义配置文件><a class=headerlink href=#自定义配置文件 title=自定义配置文件></a>自定义配置文件</h2><h3 id=WechatAccountConfig><a class=headerlink href=#WechatAccountConfig title=WechatAccountConfig></a>WechatAccountConfig</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.config;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Component;</span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@Component</span></span><br><span class=line><span class=meta>@ConfigurationProperties(prefix = "wechat")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">WechatAccountConfig</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String mpAppId;</span><br><span class=line>    <span class=keyword>private</span> String mpAppSecret;</span><br><span class=line>    <span class=keyword>private</span> String openAppId;</span><br><span class=line>    <span class=keyword>private</span> String openAppSecret;</span><br><span class=line>    <span class=keyword>private</span> String mchId;</span><br><span class=line>    <span class=keyword>private</span> String mchKey;</span><br><span class=line>    <span class=keyword>private</span> String keyPath;</span><br><span class=line>    <span class=keyword>private</span> String notifyUrl;</span><br><span class=line>    <span class=keyword>private</span> Map&lt;String, String> templateId;</span><br><span class=line>}</span><br></pre></table></figure><h2 id=引用自定义的配置文件><a class=headerlink href=#引用自定义的配置文件 title=引用自定义的配置文件></a>引用自定义的配置文件</h2><h3 id=WechatMpConfig><a class=headerlink href=#WechatMpConfig title=WechatMpConfig></a>WechatMpConfig</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.config;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.mp.api.WxMpConfigStorage;</span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.mp.api.WxMpInMemoryConfigStorage;</span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.mp.api.WxMpService;</span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.mp.api.impl.WxMpServiceImpl;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Bean;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Component;</span><br><span class=line></span><br><span class=line><span class=meta>@Component</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">WechatMpConfig</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> WechatAccountConfig accountConfig;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> WxMpService <span class="title function_">wxMpService</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>WxMpService</span> <span class=variable>wxMpService</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">WxMpServiceImpl</span>();</span><br><span class=line>        wxMpService.setWxMpConfigStorage(wxMpConfigStorage());</span><br><span class=line>        <span class=keyword>return</span> wxMpService;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> WxMpConfigStorage <span class="title function_">wxMpConfigStorage</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>WxMpInMemoryConfigStorage</span> <span class=variable>wxMpConfigStorage</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">WxMpInMemoryConfigStorage</span>();</span><br><span class=line>        wxMpConfigStorage.setAppId(accountConfig.getMpAppId());</span><br><span class=line>        wxMpConfigStorage.setSecret(accountConfig.getMpAppSecret());</span><br><span class=line>        <span class=keyword>return</span> wxMpConfigStorage;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=日志处理><a class=headerlink href=#日志处理 title=日志处理></a>日志处理</h2><h3 id=SLF4j><a class=headerlink href=#SLF4j title=SLF4j></a>SLF4j</h3><h3 id=Logback><a class=headerlink href=#Logback title=Logback></a>Logback</h3><h4 id=logback-spring-xml><a class=headerlink href=#logback-spring-xml title=logback-spring.xml></a>logback-spring.xml</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br></pre><td class=code><pre><span class=line><span class=meta>&lt;?xml version=<span class=string>"1.0"</span> encoding=<span class=string>"UTF-8"</span> ?></span></span><br><span class=line></span><br><span class=line><span class=tag>&lt;<span class=name>configuration</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>appender</span> <span class=attr>name</span>=<span class=string>"consoleLog"</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.ConsoleAppender"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>layout</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.classic.PatternLayout"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>pattern</span>></span></span><br><span class=line>                %d - %msg%n</span><br><span class=line>            <span class=tag>&lt;/<span class=name>pattern</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>layout</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>appender</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>appender</span> <span class=attr>name</span>=<span class=string>"fileInfoLog"</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>filter</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.classic.filter.LevelFilter"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>level</span>></span>ERROR<span class=tag>&lt;/<span class=name>level</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>onMatch</span>></span>DENY<span class=tag>&lt;/<span class=name>onMatch</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>onMismatch</span>></span>ACCEPT<span class=tag>&lt;/<span class=name>onMismatch</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>filter</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>encoder</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>pattern</span>></span></span><br><span class=line>                %msg%n</span><br><span class=line>            <span class=tag>&lt;/<span class=name>pattern</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>encoder</span>></span></span><br><span class=line>        <span class=comment>&lt;!--滚动策略--></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>rollingPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>></span></span><br><span class=line>            <span class=comment>&lt;!--路径--></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>fileNamePattern</span>></span>/Users/kwang/imooc/sell/log/info.%d.log<span class=tag>&lt;/<span class=name>fileNamePattern</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>rollingPolicy</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>appender</span>></span></span><br><span class=line></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>appender</span> <span class=attr>name</span>=<span class=string>"fileErrorLog"</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>filter</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.classic.filter.ThresholdFilter"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>level</span>></span>ERROR<span class=tag>&lt;/<span class=name>level</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>filter</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>encoder</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>pattern</span>></span></span><br><span class=line>                %msg%n</span><br><span class=line>            <span class=tag>&lt;/<span class=name>pattern</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>encoder</span>></span></span><br><span class=line>        <span class=comment>&lt;!--滚动策略--></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>rollingPolicy</span> <span class=attr>class</span>=<span class=string>"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>></span></span><br><span class=line>            <span class=comment>&lt;!--路径--></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>fileNamePattern</span>></span>/Users/kwang/imooc/sell/log/error.%d.log<span class=tag>&lt;/<span class=name>fileNamePattern</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>rollingPolicy</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>appender</span>></span></span><br><span class=line></span><br><span class=line>    <span class=tag>&lt;<span class=name>root</span> <span class=attr>level</span>=<span class=string>"info"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"consoleLog"</span> /></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"fileInfoLog"</span> /></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>appender-ref</span> <span class=attr>ref</span>=<span class=string>"fileErrorLog"</span> /></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>root</span>></span></span><br><span class=line></span><br><span class=line><span class=tag>&lt;/<span class=name>configuration</span>></span></span><br></pre></table></figure><hr><h2 id=Swagger2-文档工具><a title="Swagger2 文档工具" class=headerlink href=#Swagger2-文档工具></a>Swagger2 文档工具</h2><h3 id=引入POM依赖><a class=headerlink href=#引入POM依赖 title=引入POM依赖></a>引入POM依赖</h3><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>io.springfox<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>springfox-swagger2<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>version</span>></span>2.8.0<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>io.springfox<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>springfox-swagger-ui<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>version</span>></span>2.8.0<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br></pre></table></figure><h3 id=创建Swagger配置类><a class=headerlink href=#创建Swagger配置类 title=创建Swagger配置类></a>创建Swagger配置类</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.config;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Bean;</span><br><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Configuration;</span><br><span class=line><span class=keyword>import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class=line><span class=keyword>import</span> springfox.documentation.builders.PathSelectors;</span><br><span class=line><span class=keyword>import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class=line><span class=keyword>import</span> springfox.documentation.service.ApiInfo;</span><br><span class=line><span class=keyword>import</span> springfox.documentation.spi.DocumentationType;</span><br><span class=line><span class=keyword>import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class=line><span class=keyword>import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class=line></span><br><span class=line><span class=meta>@Configuration</span></span><br><span class=line><span class=meta>@EnableSwagger2</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Swagger2Configuration</span> {</span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> Docket <span class="title function_">api</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class=line>                .apiInfo(apiInfo())</span><br><span class=line>                .select()</span><br><span class=line>                <span class=comment>// 自行修改为自己的包路径</span></span><br><span class=line>                .apis(RequestHandlerSelectors.basePackage(<span class=string>"com.mindex.controller"</span>))</span><br><span class=line>                .paths(PathSelectors.any())</span><br><span class=line>                .build();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> ApiInfo <span class="title function_">apiInfo</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ApiInfoBuilder</span>()</span><br><span class=line>                .title(<span class=string>"api文档"</span>)</span><br><span class=line>                .description(<span class=string>"Restful 风格接口"</span>)</span><br><span class=line>                .version(<span class=string>"1.0"</span>)</span><br><span class=line>                .build();</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=在controller中引入Swagger注解><a class=headerlink href=#在controller中引入Swagger注解 title=在controller中引入Swagger注解></a>在controller中引入Swagger注解</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.entities.User;</span><br><span class=line><span class=keyword>import</span> io.swagger.annotations.Api;</span><br><span class=line><span class=keyword>import</span> io.swagger.annotations.ApiImplicitParam;</span><br><span class=line><span class=keyword>import</span> io.swagger.annotations.ApiImplicitParams;</span><br><span class=line><span class=keyword>import</span> io.swagger.annotations.ApiOperation;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.*;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.*;</span><br><span class=line></span><br><span class=line><span class=meta>@RestController</span></span><br><span class=line><span class=meta>@RequestMapping(value = "/users")</span></span><br><span class=line><span class=meta>@Api(value = "/users", tags = "测试接口模块")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">UserController</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>//创建线程安全的Map</span></span><br><span class=line>    <span class=keyword>static</span> Map&lt;Long, User> users = Collections.synchronizedMap(<span class=keyword>new</span> <span class="title class_">HashMap</span>&lt;Long, User>());</span><br><span class=line></span><br><span class=line>    <span class=meta>@ApiOperation(value = "获取用户列表", notes = "")</span></span><br><span class=line>    <span class=meta>@RequestMapping(value = "/", method = RequestMethod.GET)</span></span><br><span class=line>    <span class=keyword>public</span> List&lt;User> <span class="title function_">getUserList</span><span class=params>()</span> {</span><br><span class=line>        <span class=comment>// 处理"/users/"的GET请求，用来获取用户列表</span></span><br><span class=line>        <span class=comment>// 还可以通过@RequestParam从页面中传递参数来进行查询条件或者翻页信息的传递</span></span><br><span class=line>        List&lt;User> userList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&lt;User>(users.values());</span><br><span class=line>        <span class=keyword>return</span> userList;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@ApiOperation(value = "创建用户", notes = "根据User对象创建用户")</span></span><br><span class=line>    <span class=meta>@ApiImplicitParam(name = "user", value = "用户详细实体user", required = true, dataType = "User")</span></span><br><span class=line>    <span class=meta>@RequestMapping(value = "/", method = RequestMethod.POST)</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">postUser</span><span class=params>(<span class=meta>@ModelAttribute</span> User user)</span> {</span><br><span class=line>        <span class=comment>// 处理"/users/"的POST请求，用来创建User</span></span><br><span class=line>        <span class=comment>// 除了@ModelAttribute绑定参数之外，还可以通过@RequestParam从页面中传递参数</span></span><br><span class=line>        users.put(user.getId(), user);</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"success"</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line></span><br><span class=line>    <span class=meta>@ApiOperation(value = "获取用户详细信息", notes = "根据url的id来获取用户详细信息")</span></span><br><span class=line>    <span class=meta>@ApiImplicitParam(name = "id", value = "用户ID", required = true, dataType = "Long")</span></span><br><span class=line>    <span class=meta>@RequestMapping(value = "/{id}", method = RequestMethod.GET)</span></span><br><span class=line>    <span class=keyword>public</span> User <span class="title function_">getUser</span><span class=params>(<span class=meta>@PathVariable</span> Long id)</span> {</span><br><span class=line>        <span class=comment>// 处理"/users/{id}"的GET请求，用来获取url中id值的User信息</span></span><br><span class=line>        <span class=comment>// url中的id可通过@PathVariable绑定到函数的参数中</span></span><br><span class=line>        <span class=keyword>return</span> users.get(id);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@ApiOperation(value = "更新用户详细信息", notes = "根据url的id来指定更新对象，并根据传过来的user信息来更新用户详细信息")</span></span><br><span class=line>    <span class=meta>@ApiImplicitParams({</span></span><br><span class=line><span class=meta>            @ApiImplicitParam(name = "id", value = "用户ID", required = true, dataType = "Long"),</span></span><br><span class=line><span class=meta>            @ApiImplicitParam(name = "user", value = "用户详细实体user", required = true, dataType = "User")</span></span><br><span class=line><span class=meta>    })</span></span><br><span class=line>    <span class=meta>@RequestMapping(value = "/{id}", method = RequestMethod.POST)</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">putUser</span><span class=params>(<span class=meta>@PathVariable</span> Long id, <span class=meta>@ModelAttribute</span> User user)</span> {</span><br><span class=line>        <span class=comment>// 处理"/users/{id}"的PUT请求，用来更新User信息</span></span><br><span class=line>        <span class=type>User</span> <span class=variable>u</span> <span class=operator>=</span> users.get(id);</span><br><span class=line>        u.setName(user.getName());</span><br><span class=line>        u.setAge(user.getAge());</span><br><span class=line>        users.put(id, u);</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"success"</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@ApiOperation(value = "删除用户", notes = "根据url的id来指定删除对象")</span></span><br><span class=line>    <span class=meta>@ApiImplicitParam(name = "id", value = "用户ID", required = true, dataType = "Long")</span></span><br><span class=line>    <span class=meta>@RequestMapping(value = "/{id}", method = RequestMethod.DELETE)</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">deleteUser</span><span class=params>(<span class=meta>@PathVariable</span> Long id)</span> {</span><br><span class=line>        <span class=comment>// 处理"/users/{id}"的DELETE请求，用来删除User</span></span><br><span class=line>        users.remove(id);</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"success"</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=启动tomcat查看文档><a class=headerlink href=#启动tomcat查看文档 title=启动tomcat查看文档></a>启动tomcat查看文档</h3><blockquote><p><a href=http://localhost:8080/swagger-ui.html rel=noopener target=_blank>http://localhost:8080/swagger-ui.html</a></blockquote><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw6o45k2j310y0ic775.jpg><hr><h2 id=IDEA插件><a class=headerlink href=#IDEA插件 title=IDEA插件></a>IDEA插件</h2><h3 id=JRebel插件><a class=headerlink href=#JRebel插件 title=JRebel插件></a>JRebel插件</h3><h4 id=引入POM依赖-1><a class=headerlink href=#引入POM依赖-1 title=引入POM依赖></a>引入POM依赖</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-tomcat<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>version</span>></span>1.5.1.RELEASE<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>scope</span>></span>provided<span class=tag>&lt;/<span class=name>scope</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br></pre></table></figure><h4 id=配置Application-java><a class=headerlink href=#配置Application-java title=配置Application.java></a>配置Application.java</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=meta>@SpringBootApplication</span></span><br><span class=line><span class=meta>@ComponentScan(basePackages = "com.mindex")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">Application</span> <span class=keyword>extends</span> <span class="title class_">SpringBootServletInitializer</span> {</span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>protected</span> SpringApplicationBuilder <span class="title function_">configure</span><span class=params>(SpringApplicationBuilder builder)</span> {</span><br><span class=line>        <span class=keyword>return</span> builder.sources(Application.class);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        SpringApplication.run(Application.class, args);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h4 id=配置maven-project选项><a title="配置maven project选项" class=headerlink href=#配置maven-project选项></a>配置maven project选项</h4><p>选中Lifecycle-clean及compile<p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw7kkua2j30f20k8dj7.jpg><h4 id=安装JRebel插件><a class=headerlink href=#安装JRebel插件 title=安装JRebel插件></a>安装JRebel插件</h4><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw8fmgikj30y20kc7ee.jpg><h4 id=配置JRebel插件><a class=headerlink href=#配置JRebel插件 title=配置JRebel插件></a>配置JRebel插件</h4><p>在IDEA里新建一个部署配置项。<p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtw9uogcsj30xk0k2aif.jpg><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwalwu5rj30zw0xaqin.jpg><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwb52h5hj30zo0nuady.jpg><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwbonwzqj30zq0nq7ah.jpg><h4 id=运行测试><a class=headerlink href=#运行测试 title=运行测试></a>运行测试</h4><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwc5p7uxj30vy03gwfu.jpg><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwdeszlaj322y0o6hdt.jpg><h3 id=Lombok插件><a class=headerlink href=#Lombok插件 title=Lombok插件></a>Lombok插件</h3><blockquote><p>好处：安装了Lombok插件和pom引用依赖后，可以简化代码，例如：无需再写get/set/toString方法，打印日志时直接使用log关键字等。</blockquote><h4 id=安装Lombok插件><a class=headerlink href=#安装Lombok插件 title=安装Lombok插件></a>安装Lombok插件</h4><p><a href=https://github.com/mplushnikov/lombok-intellij-plugin rel=noopener target=_blank>安装步骤在这里</a><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwe4wby1j31kc0soqcc.jpg><h4 id=引用pom依赖><a class=headerlink href=#引用pom依赖 title=引用pom依赖></a>引用pom依赖</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>dependencies</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>groupId</span>></span>org.projectlombok<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>artifactId</span>></span>lombok<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependencies</span>></span></span><br></pre></table></figure><blockquote><p>好处1：只要使用**@Data**、<strong>@Getter</strong>、<strong>@Setter</strong>、<strong>@ToString</strong>等注解，无需再写繁琐的get/set/toString方法，Lombok会在编译时自动加入代码。</blockquote><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.hibernate.annotations.DynamicUpdate;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.persistence.Entity;</span><br><span class=line><span class=keyword>import</span> javax.persistence.GeneratedValue;</span><br><span class=line><span class=keyword>import</span> javax.persistence.Id;</span><br><span class=line><span class=keyword>import</span> java.util.Date;</span><br><span class=line></span><br><span class=line><span class=meta>@Entity</span></span><br><span class=line><span class=meta>@DynamicUpdate</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductCategory</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Id</span></span><br><span class=line>    <span class=meta>@GeneratedValue</span></span><br><span class=line>    <span class=keyword>private</span> Integer categoryId;</span><br><span class=line>    </span><br><span class=line>    <span class=keyword>private</span> String categoryName;</span><br><span class=line>    <span class=keyword>private</span> Integer categoryType;</span><br><span class=line>    <span class=keyword>private</span> Date createTime;</span><br><span class=line>    <span class=keyword>private</span> Date updateTime;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ProductCategory</span><span class=params>(String categoryName, Integer categoryType)</span> {</span><br><span class=line>        <span class=built_in>this</span>.categoryName = categoryName;</span><br><span class=line>        <span class=built_in>this</span>.categoryType = categoryType;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ProductCategory</span><span class=params>()</span> {</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><blockquote><p>好处2：输出日志时，可以直接使用log关键字输出，支持参数引用。</blockquote><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest(classes = LoggerTest.class)</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">LoggerTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>//    无需再写LoggerFactory</span></span><br><span class=line>    <span class=comment>//    private final Logger logger = LoggerFactory.getLogger(LoggerTest.class);</span></span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">test1</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>String</span> <span class=variable>name</span> <span class=operator>=</span> <span class=string>"imooc"</span>;</span><br><span class=line>        <span class=type>String</span> <span class=variable>password</span> <span class=operator>=</span> <span class=string>"12345"</span>;</span><br><span class=line>        log.debug(<span class=string>"debug..."</span>);</span><br><span class=line>        log.info(<span class=string>"name: {}, password: {}"</span>, name, password);</span><br><span class=line>        log.error(<span class=string>"error..."</span>);</span><br><span class=line>        log.warn(<span class=string>"warning..."</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=项目运行类（主入口）><a class=headerlink href=#项目运行类（主入口） title=项目运行类（主入口）></a>项目运行类（主入口）</h2><h3 id=SellApplication><a class=headerlink href=#SellApplication title=SellApplication></a>SellApplication</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> org.springframework.boot.SpringApplication;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class=line></span><br><span class=line><span class=meta>@SpringBootApplication</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellApplication</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">main</span><span class=params>(String[] args)</span> {</span><br><span class=line>        SpringApplication.run(SellApplication.class, args);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Enums枚举类><a class=headerlink href=#Enums枚举类 title=Enums枚举类></a>Enums枚举类</h2><h3 id=ResultEnum><a class=headerlink href=#ResultEnum title=ResultEnum></a>ResultEnum</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.enums;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Getter;</span><br><span class=line></span><br><span class=line><span class=meta>@Getter</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span> <span class="title class_">ResultEnum</span> {</span><br><span class=line>    PARAM_ERROR(<span class=number>1</span>, <span class=string>"参数错误"</span>),</span><br><span class=line>    PRODUCT_NOT_EXIST(<span class=number>10</span>, <span class=string>"商品不存在"</span>),</span><br><span class=line>    PRODUCT_STOCK_ERROR(<span class=number>11</span>, <span class=string>"商品库存不足"</span>),</span><br><span class=line>    ORDER_NOT_EXIST(<span class=number>12</span>, <span class=string>"订单不存在"</span>),</span><br><span class=line>    ORDERDETAIL_NOT_EXIST(<span class=number>13</span>, <span class=string>"订单详情不存在"</span>),</span><br><span class=line>    ORDER_STATUS_ERROR(<span class=number>14</span>, <span class=string>"订单状态错误"</span>),</span><br><span class=line>    ORDER_UPDATE_ERROR(<span class=number>15</span>, <span class=string>"订单更新失败"</span>),</span><br><span class=line>    ORDER_DETAIL_EMPTY(<span class=number>16</span>, <span class=string>"订单详情为空"</span>),</span><br><span class=line>    ORDER_PAY_STATUS_ERROR(<span class=number>17</span>, <span class=string>"订单支付状态不正确"</span>),</span><br><span class=line>    CART_IS_EMPTY(<span class=number>18</span>, <span class=string>"购物车为空"</span>),</span><br><span class=line>    ORDER_OWNER_ERROR(<span class=number>19</span>, <span class=string>"该订单不属于当前用户"</span>),</span><br><span class=line>    WECHAT_MP_ERROR(<span class=number>20</span>, <span class=string>"微信公众号授权错误"</span>),</span><br><span class=line>    ORDER_FINISH_SUCCESS(<span class=number>21</span>, <span class=string>"订单完结成功"</span>),</span><br><span class=line>    ORDER_CANCEL_SUCCESS(<span class=number>22</span>, <span class=string>"订单取消成功"</span>),</span><br><span class=line>    PRODUCT_STATUS_ERROR(<span class=number>23</span>, <span class=string>"商品状态错误"</span>),</span><br><span class=line>    ;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String msg;</span><br><span class=line></span><br><span class=line>    ResultEnum(Integer code, String msg) {</span><br><span class=line>        <span class=built_in>this</span>.code = code;</span><br><span class=line>        <span class=built_in>this</span>.msg = msg;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h3 id=CodeEnum><a class=headerlink href=#CodeEnum title=CodeEnum></a>CodeEnum</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.enums;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">CodeEnum</span> {</span><br><span class=line></span><br><span class=line>    Integer <span class="title function_">getCode</span><span class=params>()</span>;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=OrderStatusEnum><a class=headerlink href=#OrderStatusEnum title=OrderStatusEnum></a>OrderStatusEnum</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.enums;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Getter;</span><br><span class=line></span><br><span class=line><span class=meta>@Getter</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span> <span class="title class_">OrderStatusEnum</span> <span class=keyword>implements</span> <span class="title class_">CodeEnum</span> {</span><br><span class=line>    NEW(<span class=number>0</span>, <span class=string>"新订单"</span>),</span><br><span class=line>    FINISH(<span class=number>1</span>, <span class=string>"已完结"</span>),</span><br><span class=line>    CANCEL(<span class=number>2</span>, <span class=string>"已取消"</span>),</span><br><span class=line>    ;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String msg;</span><br><span class=line></span><br><span class=line>    OrderStatusEnum(Integer code, String msg) {</span><br><span class=line>        <span class=built_in>this</span>.code = code;</span><br><span class=line>        <span class=built_in>this</span>.msg = msg;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h3 id=PayStatusEnum><a class=headerlink href=#PayStatusEnum title=PayStatusEnum></a>PayStatusEnum</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.enums;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Getter;</span><br><span class=line></span><br><span class=line><span class=meta>@Getter</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span> <span class="title class_">PayStatusEnum</span> <span class=keyword>implements</span> <span class="title class_">CodeEnum</span> {</span><br><span class=line>    WAIT(<span class=number>0</span>, <span class=string>"等待支付"</span>),</span><br><span class=line>    SUCCESS(<span class=number>1</span>, <span class=string>"已支付"</span>);</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String msg;</span><br><span class=line></span><br><span class=line>    PayStatusEnum(Integer code, String msg) {</span><br><span class=line>        <span class=built_in>this</span>.code = code;</span><br><span class=line>        <span class=built_in>this</span>.msg = msg;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=ProductStatusEnum><a class=headerlink href=#ProductStatusEnum title=ProductStatusEnum></a>ProductStatusEnum</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.enums;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Getter;</span><br><span class=line></span><br><span class=line><span class=meta>@Getter</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span> <span class="title class_">ProductStatusEnum</span> <span class=keyword>implements</span> <span class="title class_">CodeEnum</span> {</span><br><span class=line>    UP(<span class=number>0</span>, <span class=string>"上架"</span>),</span><br><span class=line>    DOWN(<span class=number>1</span>, <span class=string>"下架"</span>);</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String message;</span><br><span class=line></span><br><span class=line>    ProductStatusEnum(Integer code, String message) {</span><br><span class=line>        <span class=built_in>this</span>.code = code;</span><br><span class=line>        <span class=built_in>this</span>.message = message;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Util工具类><a class=headerlink href=#Util工具类 title=Util工具类></a>Util工具类</h2><blockquote><p>可以把常用的方法放在util包里，比如拼接VO视图、生成唯一编码等；</blockquote><h3 id=构造结果VO视图-ResultVOUtil><a title="构造结果VO视图 - ResultVOUtil" class=headerlink href=#构造结果VO视图-ResultVOUtil></a>构造结果VO视图 - ResultVOUtil</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.utils;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.VO.ResultVO;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ResultVOUtil</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> ResultVO <span class="title function_">success</span><span class=params>(Object object)</span> {</span><br><span class=line>        <span class=type>ResultVO</span> <span class=variable>resultVO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ResultVO</span>();</span><br><span class=line>        resultVO.setData(object);</span><br><span class=line>        resultVO.setCode(<span class=number>0</span>);</span><br><span class=line>        resultVO.setMsg(<span class=string>"成功"</span>);</span><br><span class=line>        <span class=keyword>return</span> resultVO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> ResultVO <span class="title function_">success</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> success(<span class=literal>null</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> ResultVO <span class="title function_">error</span><span class=params>(Integer code, String msg)</span> {</span><br><span class=line>        <span class=type>ResultVO</span> <span class=variable>resultVO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ResultVO</span>();</span><br><span class=line>        resultVO.setCode(code);</span><br><span class=line>        resultVO.setMsg(msg);</span><br><span class=line>        <span class=keyword>return</span> resultVO;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=生成随机id-KeyUtil><a title="生成随机id - KeyUtil" class=headerlink href=#生成随机id-KeyUtil></a>生成随机id - KeyUtil</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.utils;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Random;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">KeyUtil</span> {</span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 生成唯一的主键</span></span><br><span class=line><span class=comment>     * 格式: 时间+随机数</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>synchronized</span> String <span class="title function_">genUniqueKey</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>Random</span> <span class=variable>random</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Random</span>();</span><br><span class=line></span><br><span class=line>        <span class=type>Integer</span> <span class=variable>number</span> <span class=operator>=</span> random.nextInt(<span class=number>900000</span>) + <span class=number>100000</span>;</span><br><span class=line>        <span class=keyword>return</span> System.currentTimeMillis() + String.valueOf(number);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=object转json-JsonUtil><a title="object转json - JsonUtil" class=headerlink href=#object转json-JsonUtil></a>object转json - JsonUtil</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.utils;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.google.gson.Gson;</span><br><span class=line><span class=keyword>import</span> com.google.gson.GsonBuilder;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">JsonUtil</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> String <span class="title function_">toJson</span><span class=params>(Object object)</span> {</span><br><span class=line>        <span class=type>GsonBuilder</span> <span class=variable>gsonBuilder</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">GsonBuilder</span>();</span><br><span class=line>        gsonBuilder.setPrettyPrinting();</span><br><span class=line>        <span class=type>Gson</span> <span class=variable>gson</span> <span class=operator>=</span> gsonBuilder.create();</span><br><span class=line>        <span class=keyword>return</span> gson.toJson(object);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=Cookie工具类-CookieUtil><a title="Cookie工具类 - CookieUtil" class=headerlink href=#Cookie工具类-CookieUtil></a>Cookie工具类 - CookieUtil</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.utils;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.servlet.http.Cookie;</span><br><span class=line><span class=keyword>import</span> javax.servlet.http.HttpServletRequest;</span><br><span class=line><span class=keyword>import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=line><span class=keyword>import</span> java.util.HashMap;</span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CookieUtil</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 设置</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> response</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> name</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> value</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> maxAge</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class="title function_">set</span><span class=params>(HttpServletResponse response,</span></span><br><span class=line><span class=params>                           String name,</span></span><br><span class=line><span class=params>                           String value,</span></span><br><span class=line><span class=params>                           <span class=type>int</span> maxAge)</span> {</span><br><span class=line>        <span class=type>Cookie</span> <span class=variable>cookie</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Cookie</span>(name, value);</span><br><span class=line>        cookie.setPath(<span class=string>"/"</span>);</span><br><span class=line>        cookie.setMaxAge(maxAge);</span><br><span class=line>        response.addCookie(cookie);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 获取cookie</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> request</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> name</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> Cookie <span class="title function_">get</span><span class=params>(HttpServletRequest request,</span></span><br><span class=line><span class=params>                           String name)</span> {</span><br><span class=line>        Map&lt;String, Cookie> cookieMap = readCookieMap(request);</span><br><span class=line>        <span class=keyword>if</span> (cookieMap.containsKey(name)) {</span><br><span class=line>            <span class=keyword>return</span> cookieMap.get(name);</span><br><span class=line>        }<span class=keyword>else</span> {</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 将cookie封装成Map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> request</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> Map&lt;String, Cookie> <span class="title function_">readCookieMap</span><span class=params>(HttpServletRequest request)</span> {</span><br><span class=line>        Map&lt;String, Cookie> cookieMap = <span class=keyword>new</span> <span class="title class_">HashMap</span>&lt;>();</span><br><span class=line>        Cookie[] cookies = request.getCookies();</span><br><span class=line>        <span class=keyword>if</span> (cookies != <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>for</span> (Cookie cookie: cookies) {</span><br><span class=line>                cookieMap.put(cookie.getName(), cookie);</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> cookieMap;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=比较金额-double类型-是否相等-MathUtil><a title="比较金额(double类型)是否相等 - MathUtil" class=headerlink href=#比较金额-double类型-是否相等-MathUtil></a>比较金额(double类型)是否相等 - MathUtil</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.utils;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">MathUtil</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>Double</span> <span class=variable>MONEY_RANGE</span> <span class=operator>=</span> <span class=number>0.01</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 比较2个金额是否相等</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> d1</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> d2</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> Boolean <span class="title function_">equals</span><span class=params>(Double d1, Double d2)</span> {</span><br><span class=line>        <span class=type>Double</span> <span class=variable>result</span> <span class=operator>=</span> Math.abs(d1 - d2);</span><br><span class=line>        <span class=keyword>if</span> (result &lt; MONEY_RANGE) {</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>true</span>;</span><br><span class=line>        }<span class=keyword>else</span> {</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>false</span>;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=EnumUtil><a class=headerlink href=#EnumUtil title=EnumUtil></a>EnumUtil</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.utils;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.enums.CodeEnum;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">EnumUtil</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> &lt;T <span class=keyword>extends</span> <span class="title class_">CodeEnum</span>> T <span class="title function_">getByCode</span><span class=params>(Integer code, Class&lt;T> enumClass)</span> {</span><br><span class=line>        <span class=keyword>for</span> (T each: enumClass.getEnumConstants()) {</span><br><span class=line>            <span class=keyword>if</span> (code.equals(each.getCode())) {</span><br><span class=line>                <span class=keyword>return</span> each;</span><br><span class=line>            }</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=Date2LongSerializer><a class=headerlink href=#Date2LongSerializer title=Date2LongSerializer></a>Date2LongSerializer</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line>package com.imooc.utils.serializer;</span><br><span class=line></span><br><span class=line>import com.fasterxml.jackson.core.JsonGenerator;</span><br><span class=line>import com.fasterxml.jackson.databind.JsonSerializer;</span><br><span class=line>import com.fasterxml.jackson.databind.SerializerProvider;</span><br><span class=line></span><br><span class=line>import java.io.IOException;</span><br><span class=line>import java.util.Date;</span><br><span class=line></span><br><span class=line>public class Date2LongSerializer extends JsonSerializer&lt;Date> {</span><br><span class=line></span><br><span class=line>    @Override</span><br><span class=line>    public void serialize(Date date, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {</span><br><span class=line>        jsonGenerator.writeNumber(date.getTime() / 1000);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Data-Object层（Entity）><a title="Data Object层（Entity）" class=headerlink href=#Data-Object层（Entity）></a>Data Object层（Entity）</h2><blockquote><p>主要用来映射数据库表及字段关系。</blockquote><h3 id=ProductCategory><a class=headerlink href=#ProductCategory title=ProductCategory></a>ProductCategory</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.hibernate.annotations.DynamicUpdate;</span><br><span class=line><span class=keyword>import</span> org.hibernate.annotations.Proxy;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.persistence.Entity;</span><br><span class=line><span class=keyword>import</span> javax.persistence.GeneratedValue;</span><br><span class=line><span class=keyword>import</span> javax.persistence.Id;</span><br><span class=line><span class=keyword>import</span> java.util.Date;</span><br><span class=line></span><br><span class=line><span class=meta>@Entity</span></span><br><span class=line><span class=meta>@DynamicUpdate</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@Proxy(lazy = false)</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductCategory</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 类目id.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@Id</span></span><br><span class=line>    <span class=meta>@GeneratedValue(strategy = javax.persistence.GenerationType.IDENTITY)</span></span><br><span class=line>    <span class=keyword>private</span> Integer categoryId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 类目名称.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> String categoryName;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 类目编号.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> Integer categoryType;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Date createTime;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Date updateTime;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ProductCategory</span><span class=params>()</span> {</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">ProductCategory</span><span class=params>(String categoryName, Integer categoryType)</span> {</span><br><span class=line>        <span class=built_in>this</span>.categoryName = categoryName;</span><br><span class=line>        <span class=built_in>this</span>.categoryType = categoryType;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=ProductInfo><a class=headerlink href=#ProductInfo title=ProductInfo></a>ProductInfo</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ProductStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.EnumUtil;</span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.hibernate.annotations.DynamicUpdate;</span><br><span class=line><span class=keyword>import</span> org.hibernate.annotations.SelectBeforeUpdate;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.persistence.Entity;</span><br><span class=line><span class=keyword>import</span> javax.persistence.Id;</span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line><span class=keyword>import</span> java.util.Date;</span><br><span class=line></span><br><span class=line><span class=meta>@Entity</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@DynamicUpdate</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductInfo</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Id</span></span><br><span class=line>    <span class=keyword>private</span> String productId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 名字. */</span></span><br><span class=line>    <span class=keyword>private</span> String productName;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 单价. */</span></span><br><span class=line>    <span class=keyword>private</span> BigDecimal productPrice;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 库存. */</span></span><br><span class=line>    <span class=keyword>private</span> Integer productStock;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 描述. */</span></span><br><span class=line>    <span class=keyword>private</span> String productDescription;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 小图. */</span></span><br><span class=line>    <span class=keyword>private</span> String productIcon;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 状态, 0正常1下架. */</span></span><br><span class=line>    <span class=keyword>private</span> Integer productStatus;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 类目编号. */</span></span><br><span class=line>    <span class=keyword>private</span> Integer categoryType;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Date createTime;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Date updateTime;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonIgnore</span></span><br><span class=line>    <span class=keyword>public</span> ProductStatusEnum <span class="title function_">getProductStatusEnum</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> EnumUtil.getByCode(productStatus, ProductStatusEnum.class);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h3 id=OrderMaster><a class=headerlink href=#OrderMaster title=OrderMaster></a>OrderMaster</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.enums.OrderStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.PayStatusEnum;</span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.hibernate.annotations.DynamicUpdate;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.persistence.Entity;</span><br><span class=line><span class=keyword>import</span> javax.persistence.Id;</span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line><span class=keyword>import</span> java.util.Date;</span><br><span class=line></span><br><span class=line><span class=meta>@Entity</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@DynamicUpdate</span></span><br><span class=line><span class=comment>//@Proxy(lazy = false)</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderMaster</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 订单id. */</span></span><br><span class=line>    <span class=meta>@Id</span></span><br><span class=line>    <span class=keyword>private</span> String orderId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 买家名字. */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerName;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 买家手机号. */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerPhone;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 买家地址. */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerAddress;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 买家微信Openid. */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerOpenid;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 订单总金额. */</span></span><br><span class=line>    <span class=keyword>private</span> BigDecimal orderAmount;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 订单状态, 默认为0新下单. */</span></span><br><span class=line>    <span class=keyword>private</span> <span class=type>Integer</span> <span class=variable>orderStatus</span> <span class=operator>=</span> OrderStatusEnum.NEW.getCode();</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 支付状态, 默认为0未支付. */</span></span><br><span class=line>    <span class=keyword>private</span> <span class=type>Integer</span> <span class=variable>payStatus</span> <span class=operator>=</span> PayStatusEnum.WAIT.getCode();</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 创建时间. */</span></span><br><span class=line>    <span class=keyword>private</span> Date createTime;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 更新时间. */</span></span><br><span class=line>    <span class=keyword>private</span> Date updateTime;</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h3 id=OrderDetail><a class=headerlink href=#OrderDetail title=OrderDetail></a>OrderDetail</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.hibernate.annotations.DynamicUpdate;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.persistence.Entity;</span><br><span class=line><span class=keyword>import</span> javax.persistence.Id;</span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line></span><br><span class=line><span class=meta>@Entity</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@DynamicUpdate</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderDetail</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Id</span></span><br><span class=line>    <span class=keyword>private</span> String detailId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 订单id. */</span></span><br><span class=line>    <span class=keyword>private</span> String orderId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 商品id. */</span></span><br><span class=line>    <span class=keyword>private</span> String productId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 商品名称. */</span></span><br><span class=line>    <span class=keyword>private</span> String productName;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 商品单价. */</span></span><br><span class=line>    <span class=keyword>private</span> BigDecimal productPrice;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 商品数量. */</span></span><br><span class=line>    <span class=keyword>private</span> Integer productQuantity;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 商品小图. */</span></span><br><span class=line>    <span class=keyword>private</span> String productIcon;</span><br><span class=line></span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Repository层-DAO-JPA><a title="Repository层 (DAO) - JPA" class=headerlink href=#Repository层-DAO-JPA></a>Repository层 (DAO) - JPA</h2><blockquote><p>JpaRepository对数据库常用操作进行了封装，通过继承JpaRepository可以快速实现数据库操作。<br>JpaRepository第一个参数是data object，第二个是该data object的主键。</blockquote><h3 id=Repository定义><a class=headerlink href=#Repository定义 title=Repository定义></a>Repository定义</h3><h4 id=ProductCategoryRepository><a class=headerlink href=#ProductCategoryRepository title=ProductCategoryRepository></a>ProductCategoryRepository</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.repository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">ProductCategoryRepository</span> <span class=keyword>extends</span> <span class="title class_">JpaRepository</span>&lt;ProductCategory, Integer> {</span><br><span class=line></span><br><span class=line>    List&lt;ProductCategory> <span class="title function_">findByCategoryTypeIn</span><span class=params>(List&lt;Integer> categoryTypeList)</span>;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=repository单元测试><a class=headerlink href=#repository单元测试 title=repository单元测试></a>repository单元测试</h3><h4 id=ProductCategoryRepositoryTest><a class=headerlink href=#ProductCategoryRepositoryTest title=ProductCategoryRepositoryTest></a>ProductCategoryRepositoryTest</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.repository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Arrays;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductCategoryRepositoryTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductCategoryRepository repository;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findOneTest</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> repository.getOne(<span class=number>1</span>);</span><br><span class=line>        System.out.println(productCategory.toString());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">saveTest</span><span class=params>()</span> {</span><br><span class=line><span class=comment>//        ProductCategory productCategory = repository.getOne(2);</span></span><br><span class=line><span class=comment>//        productCategory.setCategoryType(11);</span></span><br><span class=line></span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductCategory</span>(<span class=string>"女生最爱"</span>, <span class=number>3</span>);</span><br><span class=line><span class=comment>//        productCategory.setCategoryId(2);</span></span><br><span class=line><span class=comment>//        productCategory.setCategoryName("男生最爱");</span></span><br><span class=line><span class=comment>//        productCategory.setCategoryType(3);</span></span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>result</span> <span class=operator>=</span> repository.save(productCategory);</span><br><span class=line>        Assert.assertNotNull(result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findByCategoryTypeInTest</span><span class=params>()</span> {</span><br><span class=line>        List&lt;Integer> list = Arrays.asList(<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>);</span><br><span class=line>        List&lt;ProductCategory> result = repository.findByCategoryTypeIn(list);</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h4 id=ProductInfoRepository><a class=headerlink href=#ProductInfoRepository title=ProductInfoRepository></a>ProductInfoRepository</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.repository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductInfo;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">ProductInfoRepository</span> <span class=keyword>extends</span> <span class="title class_">JpaRepository</span>&lt;ProductInfo, String> {</span><br><span class=line></span><br><span class=line>    List&lt;ProductInfo> <span class="title function_">findByProductStatus</span><span class=params>(Integer productStatus)</span>;</span><br><span class=line>}</span><br></pre></table></figure><h4 id=OrderMasterRepository><a class=headerlink href=#OrderMasterRepository title=OrderMasterRepository></a>OrderMasterRepository</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.repository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderMaster;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Pageable;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">OrderMasterRepository</span> <span class=keyword>extends</span> <span class="title class_">JpaRepository</span>&lt;OrderMaster, String> {</span><br><span class=line></span><br><span class=line>    Page&lt;OrderMaster> <span class="title function_">findByBuyerOpenid</span><span class=params>(String buyerOpenid, Pageable pageable)</span>;</span><br><span class=line>}</span><br></pre></table></figure><h4 id=OrderDetailRepository><a class=headerlink href=#OrderDetailRepository title=OrderDetailRepository></a>OrderDetailRepository</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.repository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderDetail;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">OrderDetailRepository</span> <span class=keyword>extends</span> <span class="title class_">JpaRepository</span>&lt;OrderDetail, String> {</span><br><span class=line></span><br><span class=line>    List&lt;OrderDetail> <span class="title function_">findByOrderId</span><span class=params>(String orderId)</span>;</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Service层><a class=headerlink href=#Service层 title=Service层></a>Service层</h2><h3 id=CategoryService><a class=headerlink href=#CategoryService title=CategoryService></a>CategoryService</h3><h4 id=CategoryService-1><a class=headerlink href=#CategoryService-1 title=CategoryService></a>CategoryService</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">CategoryService</span> {</span><br><span class=line></span><br><span class=line>    ProductCategory <span class="title function_">findOne</span><span class=params>(Integer categoryId)</span>;</span><br><span class=line></span><br><span class=line>    List&lt;ProductCategory> <span class="title function_">findAll</span><span class=params>()</span>;</span><br><span class=line></span><br><span class=line>    List&lt;ProductCategory> <span class="title function_">findByCategoryTypeIn</span><span class=params>(List&lt;Integer> categoryTypeList)</span>;</span><br><span class=line></span><br><span class=line>    ProductCategory <span class="title function_">save</span><span class=params>(ProductCategory productCategory)</span>;</span><br><span class=line>}</span><br></pre></table></figure><blockquote><p>需要使用 <code>@Service</code> 注解</blockquote><h4 id=CategoryServiceImpl><a class=headerlink href=#CategoryServiceImpl title=CategoryServiceImpl></a>CategoryServiceImpl</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> com.imooc.repository.ProductCategoryRepository;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.CategoryService;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Service;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=meta>@Service</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CategoryServiceImpl</span> <span class=keyword>implements</span> <span class="title class_">CategoryService</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductCategoryRepository repository;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> ProductCategory <span class="title function_">findOne</span><span class=params>(Integer categoryId)</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.findOne(categoryId);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> List&lt;ProductCategory> <span class="title function_">findAll</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.findAll();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> List&lt;ProductCategory> <span class="title function_">findByCategoryTypeIn</span><span class=params>(List&lt;Integer> categoryTypeList)</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.findByCategoryTypeIn(categoryTypeList);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> ProductCategory <span class="title function_">save</span><span class=params>(ProductCategory productCategory)</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.save(productCategory);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h4 id=CategoryServiceImplTest><a class=headerlink href=#CategoryServiceImplTest title=CategoryServiceImplTest></a>CategoryServiceImplTest</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Arrays;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> org.junit.Assert.*;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CategoryServiceImplTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> CategoryServiceImpl categoryService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findOne</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> categoryService.findOne(<span class=number>1</span>);</span><br><span class=line>        Assert.assertEquals(<span class=keyword>new</span> <span class="title class_">Integer</span>(<span class=number>1</span>), productCategory.getCategoryId());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findAll</span><span class=params>()</span> {</span><br><span class=line>        List&lt;ProductCategory> productCategoryList = categoryService.findAll();</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, productCategoryList.size());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findByCategoryTypeIn</span><span class=params>()</span> {</span><br><span class=line>        List&lt;ProductCategory> productCategoryList = categoryService.findByCategoryTypeIn(Arrays.asList(<span class=number>1</span>, <span class=number>2</span>, <span class=number>3</span>, <span class=number>4</span>));</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, productCategoryList.size());</span><br><span class=line></span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">save</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductCategory</span>(<span class=string>"男生专享"</span>, <span class=number>10</span>);</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>result</span> <span class=operator>=</span> categoryService.save(productCategory);</span><br><span class=line>        Assert.assertNotNull(result);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=ProductService><a class=headerlink href=#ProductService title=ProductService></a>ProductService</h3><h4 id=ProductService-1><a class=headerlink href=#ProductService-1 title=ProductService></a>ProductService</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductInfo;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.CartDTO;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Pageable;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">ProductService</span> {</span><br><span class=line></span><br><span class=line>    ProductInfo <span class="title function_">findOne</span><span class=params>(String productId)</span>;</span><br><span class=line></span><br><span class=line>    List&lt;ProductInfo> <span class="title function_">findUpAll</span><span class=params>()</span>;</span><br><span class=line></span><br><span class=line>    Page&lt;ProductInfo> <span class="title function_">findAll</span><span class=params>(Pageable pageable)</span>;</span><br><span class=line></span><br><span class=line>    ProductInfo <span class="title function_">save</span><span class=params>(ProductInfo productInfo)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>//加库存</span></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">increaseStock</span><span class=params>(List&lt;CartDTO> cartDTOList)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>//减库存</span></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">reduceStock</span><span class=params>(List&lt;CartDTO> cartDTOList)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>//下架</span></span><br><span class=line>    ProductInfo <span class="title function_">offSale</span><span class=params>(String productId)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>//上架</span></span><br><span class=line>    ProductInfo <span class="title function_">onSale</span><span class=params>(String productId)</span>;</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h4 id=ProductServiceImpl><a class=headerlink href=#ProductServiceImpl title=ProductServiceImpl></a>ProductServiceImpl</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductInfo;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.CartDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ProductStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.repository.ProductInfoRepository;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.ProductService;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Pageable;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Service;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.transaction.Transactional;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=meta>@Service</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductServiceImpl</span> <span class=keyword>implements</span> <span class="title class_">ProductService</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductInfoRepository repository;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> ProductInfo <span class="title function_">findOne</span><span class=params>(String productId)</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.getOne(productId);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> List&lt;ProductInfo> <span class="title function_">findUpAll</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.findByProductStatus(ProductStatusEnum.UP.getCode());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Page&lt;ProductInfo> <span class="title function_">findAll</span><span class=params>(Pageable pageable)</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.findAll(pageable);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=meta>@Transactional</span></span><br><span class=line>    <span class=keyword>public</span> ProductInfo <span class="title function_">save</span><span class=params>(ProductInfo productInfo)</span> {</span><br><span class=line>        <span class=keyword>return</span> repository.save(productInfo);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">increaseStock</span><span class=params>(List&lt;CartDTO> cartDTOList)</span> {</span><br><span class=line>        <span class=keyword>for</span> (CartDTO cartDTO : cartDTOList) {</span><br><span class=line>            <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> repository.findById(cartDTO.getProductId()).get();</span><br><span class=line>            <span class=keyword>if</span> (productInfo == <span class=literal>null</span>) {</span><br><span class=line>                <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_NOT_EXIST);</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            <span class=type>Integer</span> <span class=variable>result</span> <span class=operator>=</span> productInfo.getProductStock() + cartDTO.getProductQuantity();</span><br><span class=line>            productInfo.setProductStock(result);</span><br><span class=line>            repository.save(productInfo);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=meta>@Transactional</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">reduceStock</span><span class=params>(List&lt;CartDTO> cartDTOList)</span> {</span><br><span class=line>        <span class=keyword>for</span> (CartDTO cartDTO : cartDTOList) {</span><br><span class=line>            <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> repository.findById(cartDTO.getProductId()).get();</span><br><span class=line>            <span class=keyword>if</span> (productInfo == <span class=literal>null</span>) {</span><br><span class=line>                <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_NOT_EXIST);</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            <span class=type>Integer</span> <span class=variable>result</span> <span class=operator>=</span> productInfo.getProductStock() - cartDTO.getProductQuantity();</span><br><span class=line>            <span class=keyword>if</span> (result &lt; <span class=number>0</span>) {</span><br><span class=line>                <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_STOCK_ERROR);</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            productInfo.setProductStock(result);</span><br><span class=line>            repository.save(productInfo);</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> ProductInfo <span class="title function_">offSale</span><span class=params>(String productId)</span> {</span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> repository.findById(productId).get();</span><br><span class=line>        <span class=keyword>if</span> (productInfo == <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_NOT_EXIST);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (productInfo.getProductStatusEnum() == ProductStatusEnum.DOWN) {</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_STATUS_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        productInfo.setProductStatus(ProductStatusEnum.DOWN.getCode());</span><br><span class=line>        <span class=keyword>return</span> repository.save(productInfo);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> ProductInfo <span class="title function_">onSale</span><span class=params>(String productId)</span> {</span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> repository.findById(productId).get();</span><br><span class=line>        <span class=keyword>if</span> (productInfo == <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_NOT_EXIST);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (productInfo.getProductStatusEnum() == ProductStatusEnum.UP) {</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_STATUS_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        productInfo.setProductStatus(ProductStatusEnum.UP.getCode());</span><br><span class=line>        <span class=keyword>return</span> repository.save(productInfo);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h4 id=ProductServiceImplTest><a class=headerlink href=#ProductServiceImplTest title=ProductServiceImplTest></a>ProductServiceImplTest</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductInfo;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ProductStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.ProductService;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.PageRequest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> org.junit.Assert.*;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductServiceImplTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductServiceImpl productService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findOne</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> productService.findOne(<span class=string>"123456"</span>);</span><br><span class=line>        Assert.assertEquals(<span class=string>"123456"</span>, productInfo.getProductId());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findUpAll</span><span class=params>()</span> {</span><br><span class=line>        List&lt;ProductInfo> productInfoList = productService.findUpAll();</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, productInfoList.size());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findAll</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>PageRequest</span> <span class=variable>request</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PageRequest</span>(<span class=number>0</span>, <span class=number>2</span>);</span><br><span class=line>        Page&lt;ProductInfo> productInfoPage = productService.findAll(request);</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, productInfoPage.getTotalElements());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">save</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductInfo</span>();</span><br><span class=line>        productInfo.setProductId(<span class=string>"123457"</span>);</span><br><span class=line>        productInfo.setProductName(<span class=string>"皮皮虾"</span>);</span><br><span class=line>        productInfo.setProductDescription(<span class=string>"好喝"</span>);</span><br><span class=line>        productInfo.setProductPrice(<span class=keyword>new</span> <span class="title class_">BigDecimal</span>(<span class=number>99.8</span>));</span><br><span class=line>        productInfo.setProductStock(<span class=number>10</span>);</span><br><span class=line>        productInfo.setProductIcon(<span class=string>"http://yyy.jpg"</span>);</span><br><span class=line>        productInfo.setProductStatus(<span class=number>1</span>);</span><br><span class=line>        productInfo.setCategoryType(<span class=number>2</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>result</span> <span class=operator>=</span> productService.save(productInfo);</span><br><span class=line>        Assert.assertNotNull(result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">offSale</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>result</span> <span class=operator>=</span> productService.offSale(<span class=string>"123456"</span>);</span><br><span class=line>        Assert.assertEquals(result.getProductStatusEnum(), ProductStatusEnum.DOWN);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">onSale</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>result</span> <span class=operator>=</span> productService.onSale(<span class=string>"123456"</span>);</span><br><span class=line>        Assert.assertEquals(result.getProductStatusEnum(), ProductStatusEnum.UP);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=OrderService><a class=headerlink href=#OrderService title=OrderService></a>OrderService</h3><h4 id=OrderService-1><a class=headerlink href=#OrderService-1 title=OrderService></a>OrderService</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Pageable;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">OrderService</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 创建订单</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    OrderDTO <span class="title function_">create</span><span class=params>(OrderDTO orderDTO)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 查询单个订单</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    OrderDTO <span class="title function_">findOne</span><span class=params>(String orderId)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 查询订单列表</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    Page&lt;OrderDTO> <span class="title function_">findList</span><span class=params>(String buyerOpenid, Pageable pageable)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 取消订单</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    OrderDTO <span class="title function_">cancel</span><span class=params>(OrderDTO orderDTO)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 完结订单</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    OrderDTO <span class="title function_">finish</span><span class=params>(OrderDTO orderDTO)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 支付订单</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    OrderDTO <span class="title function_">paid</span><span class=params>(OrderDTO orderDTO)</span>;</span><br><span class=line></span><br><span class=line>    Page&lt;OrderDTO> <span class="title function_">findList</span><span class=params>(Pageable pageable)</span>;</span><br><span class=line>}</span><br></pre></table></figure><h4 id=OrderServiceImpl><a class=headerlink href=#OrderServiceImpl title=OrderServiceImpl></a>OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br><span class=line>183</span><br><span class=line>184</span><br><span class=line>185</span><br><span class=line>186</span><br><span class=line>187</span><br><span class=line>188</span><br><span class=line>189</span><br><span class=line>190</span><br><span class=line>191</span><br><span class=line>192</span><br><span class=line>193</span><br><span class=line>194</span><br><span class=line>195</span><br><span class=line>196</span><br><span class=line>197</span><br><span class=line>198</span><br><span class=line>199</span><br><span class=line>200</span><br><span class=line>201</span><br><span class=line>202</span><br><span class=line>203</span><br><span class=line>204</span><br><span class=line>205</span><br><span class=line>206</span><br><span class=line>207</span><br><span class=line>208</span><br><span class=line>209</span><br><span class=line>210</span><br><span class=line>211</span><br><span class=line>212</span><br><span class=line>213</span><br><span class=line>214</span><br><span class=line>215</span><br><span class=line>216</span><br><span class=line>217</span><br><span class=line>218</span><br><span class=line>219</span><br><span class=line>220</span><br><span class=line>221</span><br><span class=line>222</span><br><span class=line>223</span><br><span class=line>224</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.converter.OrderMaster2OrderDTOConverter;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderDetail;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderMaster;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductInfo;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.CartDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.OrderStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.PayStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.repository.OrderDetailRepository;</span><br><span class=line><span class=keyword>import</span> com.imooc.repository.OrderMasterRepository;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.OrderService;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.ProductService;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.KeyUtil;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.BeanUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.PageImpl;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Pageable;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Service;</span><br><span class=line><span class=keyword>import</span> org.springframework.util.CollectionUtils;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.transaction.Transactional;</span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line><span class=keyword>import</span> java.math.BigInteger;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.stream.Collectors;</span><br><span class=line></span><br><span class=line><span class=meta>@Service</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderServiceImpl</span> <span class=keyword>implements</span> <span class="title class_">OrderService</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductService productService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> OrderDetailRepository orderDetailRepository;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> OrderMasterRepository orderMasterRepository;</span><br><span class=line></span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=meta>@Transactional</span></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">create</span><span class=params>(OrderDTO orderDTO)</span> {</span><br><span class=line></span><br><span class=line>        <span class=type>String</span> <span class=variable>orderId</span> <span class=operator>=</span> KeyUtil.genUniqueKey();</span><br><span class=line>        <span class=type>BigDecimal</span> <span class=variable>orderAmount</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">BigDecimal</span>(BigInteger.ZERO);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 1. 查询商品（数量、价格）</span></span><br><span class=line>        <span class=keyword>for</span> (OrderDetail orderDetail :</span><br><span class=line>                orderDTO.getOrderDetailList()) {</span><br><span class=line>            <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> productService.findOne(orderDetail.getProductId());</span><br><span class=line>            <span class=keyword>if</span> (productInfo == <span class=literal>null</span>) {</span><br><span class=line>                <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PRODUCT_NOT_EXIST);</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line></span><br><span class=line>            <span class=comment>// 2. 计算订单总价</span></span><br><span class=line>            orderAmount = productInfo.getProductPrice()</span><br><span class=line>                    .multiply(<span class=keyword>new</span> <span class="title class_">BigDecimal</span>(orderDetail.getProductQuantity()))</span><br><span class=line>                    .add(orderAmount);</span><br><span class=line></span><br><span class=line></span><br><span class=line>            <span class=comment>// 3. 保存订单详情</span></span><br><span class=line>            BeanUtils.copyProperties(productInfo, orderDetail);</span><br><span class=line>            orderDetail.setDetailId(KeyUtil.genUniqueKey());</span><br><span class=line>            orderDetail.setOrderId(orderId);</span><br><span class=line></span><br><span class=line>            orderDetailRepository.save(orderDetail);</span><br><span class=line></span><br><span class=line>        }</span><br><span class=line></span><br><span class=line></span><br><span class=line>        <span class=comment>// 4. 保存订单头</span></span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>orderMaster</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderMaster</span>();</span><br><span class=line>        orderDTO.setOrderId(orderId);</span><br><span class=line>        BeanUtils.copyProperties(orderDTO, orderMaster);</span><br><span class=line>        orderMaster.setOrderStatus(OrderStatusEnum.NEW.getCode());</span><br><span class=line>        orderMaster.setPayStatus(PayStatusEnum.WAIT.getCode());</span><br><span class=line>        orderMaster.setOrderAmount(orderAmount);</span><br><span class=line></span><br><span class=line>        orderMasterRepository.save(orderMaster);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 5. 扣库存</span></span><br><span class=line>        List&lt;CartDTO> cartDTOList = orderDTO.getOrderDetailList().stream()</span><br><span class=line>                .map(e -> <span class=keyword>new</span> <span class="title class_">CartDTO</span>(e.getProductId(), e.getProductQuantity()))</span><br><span class=line>                .collect(Collectors.toList());</span><br><span class=line></span><br><span class=line>        productService.reduceStock(cartDTOList);</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">findOne</span><span class=params>(String orderId)</span> {</span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>orderMaster</span> <span class=operator>=</span> orderMasterRepository.findById(orderId).orElseThrow(() -> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_NOT_EXIST));</span><br><span class=line></span><br><span class=line></span><br><span class=line>        List&lt;OrderDetail> orderDetailList = orderDetailRepository.findByOrderId(orderId);</span><br><span class=line>        <span class=keyword>if</span> (CollectionUtils.isEmpty(orderDetailList)) {</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDERDETAIL_NOT_EXIST);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDTO</span>();</span><br><span class=line>        BeanUtils.copyProperties(orderMaster, orderDTO);</span><br><span class=line>        orderDTO.setOrderDetailList(orderDetailList);</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Page&lt;OrderDTO> <span class="title function_">findList</span><span class=params>(String buyerOpenid, Pageable pageable)</span> {</span><br><span class=line>        Page&lt;OrderMaster> orderMasterPage = orderMasterRepository.findByBuyerOpenid(buyerOpenid, pageable);</span><br><span class=line>        List&lt;OrderDTO> orderDTOList = OrderMaster2OrderDTOConverter.convert(orderMasterPage.getContent());</span><br><span class=line>        Page&lt;OrderDTO> orderDTOPage = <span class=keyword>new</span> <span class="title class_">PageImpl</span>&lt;OrderDTO>(orderDTOList, pageable, orderMasterPage.getTotalElements());</span><br><span class=line>        <span class=keyword>return</span> orderDTOPage;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Page&lt;OrderDTO> <span class="title function_">findList</span><span class=params>(Pageable pageable)</span> {</span><br><span class=line>        Page&lt;OrderMaster> orderMasterPage = orderMasterRepository.findAll(pageable);</span><br><span class=line>        List&lt;OrderDTO> orderDTOList = OrderMaster2OrderDTOConverter.convert(orderMasterPage.getContent());</span><br><span class=line>        Page&lt;OrderDTO> orderDTOPage = <span class=keyword>new</span> <span class="title class_">PageImpl</span>&lt;OrderDTO>(orderDTOList, pageable, orderMasterPage.getTotalElements());</span><br><span class=line>        <span class=keyword>return</span> orderDTOPage;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=meta>@Transactional</span></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">cancel</span><span class=params>(OrderDTO orderDTO)</span> {</span><br><span class=line>        <span class=comment>// 确定订单状态为可取消</span></span><br><span class=line>        <span class=keyword>if</span> (!orderDTO.getOrderStatus().equals(OrderStatusEnum.NEW.getCode())) {</span><br><span class=line>            log.error(<span class=string>"【订单状态错误】order status = {}"</span>, orderDTO.getOrderStatus());</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_STATUS_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=comment>// 取消订单</span></span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>orderMaster</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderMaster</span>();</span><br><span class=line>        orderDTO.setOrderStatus(OrderStatusEnum.CANCEL.getCode());</span><br><span class=line></span><br><span class=line>        <span class=comment>// 拷贝的位置很重要!!</span></span><br><span class=line>        BeanUtils.copyProperties(orderDTO, orderMaster);</span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>updateResult</span> <span class=operator>=</span> orderMasterRepository.save(orderMaster);</span><br><span class=line>        <span class=keyword>if</span> (updateResult == <span class=literal>null</span>) {</span><br><span class=line>            log.error(<span class=string>"【订单状态错误】order status = {}"</span>, orderDTO.getOrderStatus());</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_UPDATE_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=comment>// 回退商品库存</span></span><br><span class=line>        <span class=keyword>if</span> (CollectionUtils.isEmpty(orderDTO.getOrderDetailList())) {</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_DETAIL_EMPTY);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        List&lt;CartDTO> cartDTOList = orderDTO.getOrderDetailList().stream().map(</span><br><span class=line>                e -> <span class=keyword>new</span> <span class="title class_">CartDTO</span>(e.getProductId(), e.getProductQuantity())</span><br><span class=line>        ).collect(Collectors.toList());</span><br><span class=line>        productService.increaseStock(cartDTOList);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 如果用户已付款，需要退款</span></span><br><span class=line>        <span class=keyword>if</span> (orderDTO.getPayStatus().equals(PayStatusEnum.SUCCESS)) {</span><br><span class=line>            <span class=comment>//TODO 退款逻辑</span></span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=meta>@Transactional</span></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">finish</span><span class=params>(OrderDTO orderDTO)</span> {</span><br><span class=line>        <span class=comment>// 判断订单状态</span></span><br><span class=line>        <span class=keyword>if</span> (!orderDTO.getOrderStatus().equals(OrderStatusEnum.NEW.getCode())) {</span><br><span class=line>            log.error(<span class=string>"【完结订单】订单状态不正确，orderDTO = {}"</span>, orderDTO);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_STATUS_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=comment>// 完结订单</span></span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>orderMaster</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderMaster</span>();</span><br><span class=line>        orderDTO.setOrderStatus(OrderStatusEnum.FINISH.getCode());</span><br><span class=line>        BeanUtils.copyProperties(orderDTO, orderMaster);</span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>updateResult</span> <span class=operator>=</span> orderMasterRepository.save(orderMaster);</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (updateResult == <span class=literal>null</span>) {</span><br><span class=line>            log.error(<span class=string>"【完结订单】订单更新失败，orderDTO = {}"</span>, orderDTO);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_UPDATE_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=meta>@Transactional</span></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">paid</span><span class=params>(OrderDTO orderDTO)</span> {</span><br><span class=line>        <span class=comment>// 判断订单状态</span></span><br><span class=line>        <span class=keyword>if</span> (!orderDTO.getOrderStatus().equals(OrderStatusEnum.NEW.getCode())) {</span><br><span class=line>            log.error(<span class=string>"【支付订单】订单状态不正确，orderDTO = {}"</span>, orderDTO);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_STATUS_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=comment>// 判断支付状态</span></span><br><span class=line>        <span class=keyword>if</span> (!orderDTO.getPayStatus().equals(PayStatusEnum.WAIT.getCode())) {</span><br><span class=line>            log.error(<span class=string>"【支付订单】订单支付状态不正确，orderDTO = {}"</span>, orderDTO);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_PAY_STATUS_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=comment>// 更新支付状态</span></span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>orderMaster</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderMaster</span>();</span><br><span class=line>        orderDTO.setPayStatus(PayStatusEnum.SUCCESS.getCode());</span><br><span class=line>        BeanUtils.copyProperties(orderDTO, orderMaster);</span><br><span class=line>        <span class=type>OrderMaster</span> <span class=variable>updateResult</span> <span class=operator>=</span> orderMasterRepository.save(orderMaster);</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (updateResult == <span class=literal>null</span>) {</span><br><span class=line>            log.error(<span class=string>"【支付订单】订单支付状态更新失败，orderDTO = {}"</span>, orderDTO);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_UPDATE_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h4 id=OrderServiceImplTest><a class=headerlink href=#OrderServiceImplTest title=OrderServiceImplTest></a>OrderServiceImplTest</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderDetail;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.OrderStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.PayStatusEnum;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.PageRequest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.ArrayList;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderServiceImplTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> OrderServiceImpl orderService;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> <span class=type>String</span> <span class=variable>BUYER_OPENID</span> <span class=operator>=</span> <span class=string>"110110"</span>;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>final</span> <span class=type>String</span> <span class=variable>ORDER_ID</span> <span class=operator>=</span> <span class=string>"1559635196265398489"</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">create</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDTO</span>();</span><br><span class=line>        orderDTO.setBuyerName(<span class=string>"kenny"</span>);</span><br><span class=line>        orderDTO.setBuyerAddress(<span class=string>"上海"</span>);</span><br><span class=line>        orderDTO.setBuyerPhone(<span class=string>"18612341234"</span>);</span><br><span class=line>        orderDTO.setBuyerOpenid(BUYER_OPENID);</span><br><span class=line></span><br><span class=line>        List&lt;OrderDetail> orderDetailList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&lt;>();</span><br><span class=line></span><br><span class=line>        <span class=type>OrderDetail</span> <span class=variable>o1</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDetail</span>();</span><br><span class=line>        o1.setProductId(<span class=string>"12345678"</span>);</span><br><span class=line>        o1.setProductQuantity(<span class=number>1</span>);</span><br><span class=line>        orderDetailList.add(o1);</span><br><span class=line></span><br><span class=line>        <span class=type>OrderDetail</span> <span class=variable>o2</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDetail</span>();</span><br><span class=line>        o2.setProductId(<span class=string>"123456"</span>);</span><br><span class=line>        o2.setProductQuantity(<span class=number>2</span>);</span><br><span class=line>        orderDetailList.add(o2);</span><br><span class=line></span><br><span class=line>        orderDTO.setOrderDetailList(orderDetailList);</span><br><span class=line></span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>result</span> <span class=operator>=</span> orderService.create(orderDTO);</span><br><span class=line>        log.info(<span class=string>"【创建订单】result={}"</span>, result);</span><br><span class=line></span><br><span class=line>        Assert.assertNotNull(result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findOne</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>result</span> <span class=operator>=</span> orderService.findOne(ORDER_ID);</span><br><span class=line>        log.info(<span class=string>"【订单信息】result={}"</span>, result);</span><br><span class=line>        Assert.assertEquals(ORDER_ID, result.getOrderId());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findList</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>PageRequest</span> <span class=variable>request</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PageRequest</span>(<span class=number>0</span>, <span class=number>2</span>);</span><br><span class=line>        Page&lt;OrderDTO> orderDTOPage = orderService.findList(BUYER_OPENID, request);</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, orderDTOPage);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findAll</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>PageRequest</span> <span class=variable>request</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PageRequest</span>(<span class=number>0</span>, <span class=number>2</span>);</span><br><span class=line>        Page&lt;OrderDTO> orderDTOPage = orderService.findList(request);</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, orderDTOPage);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">cancel</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> orderService.findOne(ORDER_ID);</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>result</span> <span class=operator>=</span> orderService.cancel(orderDTO);</span><br><span class=line>        Assert.assertEquals(OrderStatusEnum.CANCEL.getCode(), result.getOrderStatus());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">finish</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> orderService.findOne(ORDER_ID);</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>result</span> <span class=operator>=</span> orderService.finish(orderDTO);</span><br><span class=line>        Assert.assertEquals(OrderStatusEnum.FINISH.getCode(), result.getOrderStatus());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">paid</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> orderService.findOne(ORDER_ID);</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>result</span> <span class=operator>=</span> orderService.paid(orderDTO);</span><br><span class=line>        Assert.assertEquals(PayStatusEnum.SUCCESS.getCode(), result.getPayStatus());</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=BuyerService><a class=headerlink href=#BuyerService title=BuyerService></a>BuyerService</h3><h4 id=BuyerService-1><a class=headerlink href=#BuyerService-1 title=BuyerService></a>BuyerService</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">BuyerService</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>// 查询一个订单</span></span><br><span class=line>    OrderDTO <span class="title function_">findOrderOne</span><span class=params>(String openid, String orderId)</span>;</span><br><span class=line></span><br><span class=line>    <span class=comment>// 取消一个订单</span></span><br><span class=line>    OrderDTO <span class="title function_">cancelOrder</span><span class=params>(String openid, String orderId)</span>;</span><br><span class=line>}</span><br></pre></table></figure><h4 id=BuyerServiceImpl><a class=headerlink href=#BuyerServiceImpl title=BuyerServiceImpl></a>BuyerServiceImpl</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.BuyerService;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.OrderService;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Service;</span><br><span class=line></span><br><span class=line><span class=meta>@Service</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BuyerServiceImpl</span> <span class=keyword>implements</span> <span class="title class_">BuyerService</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> OrderService orderService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">findOrderOne</span><span class=params>(String openid, String orderId)</span> {</span><br><span class=line>        <span class=keyword>return</span> checkOrderOwner(openid, orderId);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">cancelOrder</span><span class=params>(String openid, String orderId)</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> checkOrderOwner(openid, orderId);</span><br><span class=line>        <span class=keyword>if</span> (orderDTO == <span class=literal>null</span>) {</span><br><span class=line>            log.error(<span class=string>"【检查订单】查询不到该订单。openid={}, orderId={}"</span>, openid, orderId);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_NOT_EXIST);</span><br><span class=line>        }</span><br><span class=line>        orderService.cancel(orderDTO);</span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> OrderDTO <span class="title function_">checkOrderOwner</span><span class=params>(String openid, String orderId)</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> orderService.findOne(orderId);</span><br><span class=line>        <span class=keyword>if</span> (orderDTO == <span class=literal>null</span>) {</span><br><span class=line>            <span class=keyword>return</span> <span class=literal>null</span>;</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (!orderDTO.getBuyerOpenid().equalsIgnoreCase(openid)) {</span><br><span class=line>            log.error(<span class=string>"【检查订单】该订单不属于当前用户。openid={}, orderDTO={}"</span>, openid, orderDTO);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.ORDER_OWNER_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Controller层><a class=headerlink href=#Controller层 title=Controller层></a>Controller层</h2><blockquote><p><strong>@RestController</strong> 注解，直接返回json格式；<br><strong>@RequestMapping(“buyer/product”)</strong> 注解声明服务的url前缀；</blockquote><h3 id=BuyerProductController><a class=headerlink href=#BuyerProductController title=BuyerProductController></a>BuyerProductController</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.VO.ProductInfoVO;</span><br><span class=line><span class=keyword>import</span> com.imooc.VO.ProductVO;</span><br><span class=line><span class=keyword>import</span> com.imooc.VO.ResultVO;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductInfo;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.CategoryService;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.ProductService;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.ResultVOUtil;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.BeanUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.ArrayList;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.stream.Collectors;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=meta>@RestController</span></span><br><span class=line><span class=meta>@RequestMapping("/buyer/product")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BuyerProductController</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductService productService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> CategoryService categoryService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@GetMapping("/list")</span></span><br><span class=line>    <span class=keyword>public</span> ResultVO <span class="title function_">list</span><span class=params>()</span> {</span><br><span class=line></span><br><span class=line>        <span class=comment>//1. 查询所有上架商品</span></span><br><span class=line>        List&lt;ProductInfo> productInfoList = productService.findUpAll();</span><br><span class=line></span><br><span class=line><span class=comment>//        List&lt;Integer> categoryTypeList = new ArrayList&lt;>();</span></span><br><span class=line><span class=comment>//        for (ProductInfo productInfo :</span></span><br><span class=line><span class=comment>//                productInfoList) {</span></span><br><span class=line><span class=comment>//            categoryTypeList.add(productInfo.getCategoryType());</span></span><br><span class=line><span class=comment>//        }</span></span><br><span class=line></span><br><span class=line>        List&lt;Integer> categoryTypeList = productInfoList.stream()</span><br><span class=line>                .map(e -> e.getCategoryType())</span><br><span class=line>                .collect(Collectors.toList());</span><br><span class=line></span><br><span class=line>        <span class=comment>//2. 查询品类</span></span><br><span class=line>        List&lt;ProductCategory> productCategoryList = categoryService.findByCategoryTypeIn(categoryTypeList);</span><br><span class=line></span><br><span class=line></span><br><span class=line>        <span class=comment>//3. 拼装数据</span></span><br><span class=line>        List&lt;ProductVO> productVOList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&lt;>();</span><br><span class=line></span><br><span class=line>        <span class=keyword>for</span> (ProductCategory productCategory :</span><br><span class=line>                productCategoryList) {</span><br><span class=line>            <span class=type>ProductVO</span> <span class=variable>productVO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductVO</span>();</span><br><span class=line>            productVO.setCategoryName(productCategory.getCategoryName());</span><br><span class=line>            productVO.setCategoryType(productCategory.getCategoryType());</span><br><span class=line></span><br><span class=line></span><br><span class=line>            List&lt;ProductInfoVO> productInfoVOList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&lt;>();</span><br><span class=line>            <span class=keyword>for</span> (ProductInfo productInfo :</span><br><span class=line>                    productInfoList) {</span><br><span class=line>                <span class=keyword>if</span> (productInfo.getCategoryType().equals(productCategory.getCategoryType())) {</span><br><span class=line>                    <span class=type>ProductInfoVO</span> <span class=variable>productInfoVO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductInfoVO</span>();</span><br><span class=line>                    BeanUtils.copyProperties(productInfo, productInfoVO);</span><br><span class=line></span><br><span class=line>                    productInfoVOList.add(productInfoVO);</span><br><span class=line>                }</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            productVO.setProductInfoVOList(productInfoVOList);</span><br><span class=line>            productVOList.add(productVO);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> ResultVOUtil.success(productVOList);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=BuyerOrderController><a class=headerlink href=#BuyerOrderController title=BuyerOrderController></a>BuyerOrderController</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.VO.ResultVO;</span><br><span class=line><span class=keyword>import</span> com.imooc.converter.OrderForm2OrderDTOConverter;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.form.OrderForm;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.BuyerService;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.OrderService;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.ResultVOUtil;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.PageRequest;</span><br><span class=line><span class=keyword>import</span> org.springframework.util.CollectionUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.util.StringUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.validation.BindingResult;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.*;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.validation.Valid;</span><br><span class=line><span class=keyword>import</span> java.util.HashMap;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=meta>@RestController</span></span><br><span class=line><span class=meta>@RequestMapping("/buyer/order")</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">BuyerOrderController</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> OrderService orderService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> BuyerService buyerService;</span><br><span class=line></span><br><span class=line>    <span class=comment>// 创建订单</span></span><br><span class=line>    <span class=meta>@PostMapping("/create")</span></span><br><span class=line>    <span class=keyword>public</span> ResultVO&lt;Map&lt;String, String>> <span class="title function_">create</span><span class=params>(<span class=meta>@Valid</span> OrderForm orderForm, BindingResult bindingResult)</span> {</span><br><span class=line></span><br><span class=line>        <span class=keyword>if</span> (bindingResult.hasErrors()) {</span><br><span class=line>            log.error(<span class=string>"【创建订单】参数不正确, orderForm = {}"</span>, orderForm);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PARAM_ERROR.getCode(), bindingResult.getFieldError().getDefaultMessage());</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> OrderForm2OrderDTOConverter.convert(orderForm);</span><br><span class=line>        <span class=keyword>if</span> (CollectionUtils.isEmpty(orderDTO.getOrderDetailList())) {</span><br><span class=line>            log.error(<span class=string>"【创建订单】购物车不能为空, orderDTO={}"</span>, orderDTO);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.CART_IS_EMPTY);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>createResult</span> <span class=operator>=</span> orderService.create(orderDTO);</span><br><span class=line></span><br><span class=line>        Map&lt;String, String> map = <span class=keyword>new</span> <span class="title class_">HashMap</span>&lt;>();</span><br><span class=line>        map.put(<span class=string>"orderId"</span>, createResult.getOrderId());</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> ResultVOUtil.success(map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 订单列表</span></span><br><span class=line>    <span class=meta>@GetMapping("/list")</span></span><br><span class=line>    <span class=keyword>public</span> ResultVO&lt;List&lt;OrderDTO>> <span class="title function_">list</span><span class=params>(<span class=meta>@RequestParam(value = "openid")</span> String openid,</span></span><br><span class=line><span class=params>                                         <span class=meta>@RequestParam(value = "page", defaultValue = "0")</span> Integer page,</span></span><br><span class=line><span class=params>                                         <span class=meta>@RequestParam(value = "size", defaultValue = "10")</span> Integer size)</span> {</span><br><span class=line>        <span class=keyword>if</span> (StringUtils.isEmpty(openid)) {</span><br><span class=line>            log.error(<span class=string>"【查询订单列表】openid不能为空"</span>);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PARAM_ERROR);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=type>PageRequest</span> <span class=variable>request</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PageRequest</span>(page, size);</span><br><span class=line>        Page&lt;OrderDTO> orderDTO = orderService.findList(openid, request);</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> ResultVOUtil.success(orderDTO.getContent());</span><br><span class=line></span><br><span class=line>    }</span><br><span class=line></span><br><span class=line></span><br><span class=line>    <span class=comment>// 订单详情</span></span><br><span class=line>    <span class=meta>@GetMapping("/detail")</span></span><br><span class=line>    <span class=keyword>public</span> ResultVO&lt;List&lt;OrderDTO>> <span class="title function_">detail</span><span class=params>(<span class=meta>@RequestParam("openid")</span> String openid,</span></span><br><span class=line><span class=params>                                           <span class=meta>@RequestParam("orderId")</span> String orderId)</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> buyerService.findOrderOne(openid, orderId);</span><br><span class=line>        <span class=keyword>return</span> ResultVOUtil.success(orderDTO);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>// 取消订单</span></span><br><span class=line>    <span class=meta>@PostMapping("/cancel")</span></span><br><span class=line>    <span class=keyword>public</span> ResultVO&lt;List&lt;OrderDTO>> <span class="title function_">cancel</span><span class=params>(<span class=meta>@RequestParam("openid")</span> String openid,</span></span><br><span class=line><span class=params>                                           <span class=meta>@RequestParam("orderId")</span> String orderId)</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> buyerService.cancelOrder(openid, orderId);</span><br><span class=line>        <span class=keyword>return</span> ResultVOUtil.success();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h3 id=SellerCategoryController><a class=headerlink href=#SellerCategoryController title=SellerCategoryController></a>SellerCategoryController</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.form.CategoryForm;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.CategoryService;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.BeanUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Controller;</span><br><span class=line><span class=keyword>import</span> org.springframework.validation.BindingResult;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.validation.Valid;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 卖家商品类目</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=meta>@Controller</span></span><br><span class=line><span class=meta>@RequestMapping("/seller/category")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellerCategoryController</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> CategoryService categoryService;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 商品类目列表</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@GetMapping("/list")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">list</span><span class=params>(Map&lt;String, Object> map)</span> {</span><br><span class=line>        List&lt;ProductCategory> categoryList = categoryService.findAll();</span><br><span class=line>        map.put(<span class=string>"categoryList"</span>, categoryList);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"category/list"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 商品类目新增/更新</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> categoryId</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@GetMapping("index")</span></span><br><span class=line>    <span class=keyword>private</span> ModelAndView <span class="title function_">index</span><span class=params>(<span class=meta>@RequestParam(value = "categoryId", required = false)</span> Integer categoryId,</span></span><br><span class=line><span class=params>                               Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>if</span> (categoryId != <span class=literal>null</span>) {</span><br><span class=line>            <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> categoryService.findOne(categoryId);</span><br><span class=line>            map.put(<span class=string>"category"</span>, productCategory);</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"category/index"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 保存/更新</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> form</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> bindingResult</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@PostMapping("/save")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">save</span><span class=params>(<span class=meta>@Valid</span> CategoryForm form,</span></span><br><span class=line><span class=params>                             BindingResult bindingResult,</span></span><br><span class=line><span class=params>                             Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>if</span> (bindingResult.hasErrors()) {</span><br><span class=line>            map.put(<span class=string>"msg"</span>, bindingResult.getFieldError().getDefaultMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/category/index"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductCategory</span>();</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            <span class=keyword>if</span> (form.getCategoryId() != <span class=literal>null</span>) {</span><br><span class=line>                productCategory = categoryService.findOne(form.getCategoryId());</span><br><span class=line>            }</span><br><span class=line>            BeanUtils.copyProperties(form, productCategory);</span><br><span class=line>            categoryService.save(productCategory);</span><br><span class=line>        } <span class=keyword>catch</span> (SellException e) {</span><br><span class=line>            map.put(<span class=string>"msg"</span>, e.getMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/category/index"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/category/list"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/success"</span>, map);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=SellerOrderController><a class=headerlink href=#SellerOrderController title=SellerOrderController></a>SellerOrderController</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.OrderStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.OrderService;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.PageRequest;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Controller;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 卖家端订单</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=meta>@Controller</span></span><br><span class=line><span class=meta>@RequestMapping("/seller/order")</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellerOrderController</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> OrderService orderService;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 卖家端订单列表</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> page 第几页, 从1页开始</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> size 一页有多少条数据</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@GetMapping("/list")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">list</span><span class=params>(<span class=meta>@RequestParam(value = "page", defaultValue = "1")</span> Integer page,</span></span><br><span class=line><span class=params>                             <span class=meta>@RequestParam(value = "size", defaultValue = "10")</span> Integer size,</span></span><br><span class=line><span class=params>                             Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=type>PageRequest</span> <span class=variable>request</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PageRequest</span>(page - <span class=number>1</span>, size);</span><br><span class=line>        Page&lt;OrderDTO> orderDTOPage = orderService.findList(request);</span><br><span class=line>        map.put(<span class=string>"orderDTOPage"</span>, orderDTOPage);</span><br><span class=line>        map.put(<span class=string>"currentPage"</span>, page);</span><br><span class=line>        map.put(<span class=string>"size"</span>, size);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"order/list"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 卖家端订单取消</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> orderId</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@GetMapping("/cancel")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">cancel</span><span class=params>(<span class=meta>@RequestParam(value = "orderId")</span> String orderId,</span></span><br><span class=line><span class=params>                               Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> orderService.findOne(orderId);</span><br><span class=line>            orderService.cancel(orderDTO);</span><br><span class=line>        } <span class=keyword>catch</span> (SellException e) {</span><br><span class=line>            log.error(<span class=string>"【取消订单】订单取消异常, {}"</span>, e);</span><br><span class=line>            map.put(<span class=string>"msg"</span>, e.getMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/order/list"</span>);</span><br><span class=line></span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        map.put(<span class=string>"msg"</span>, ResultEnum.ORDER_CANCEL_SUCCESS.getMsg());</span><br><span class=line>        map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/order/list"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/success"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 卖家端订单详情</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> orderId</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@GetMapping("/detail")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">detail</span><span class=params>(<span class=meta>@RequestParam(value = "orderId")</span> String orderId,</span></span><br><span class=line><span class=params>                               Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDTO</span>();</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            orderDTO = orderService.findOne(orderId);</span><br><span class=line>        } <span class=keyword>catch</span> (SellException e) {</span><br><span class=line>            log.error(<span class=string>"【卖家端订单详情】获取订单详情发生异常：{}"</span>, e);</span><br><span class=line>            map.put(<span class=string>"msg"</span>, e.getMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/order/list"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        map.put(<span class=string>"orderDTO"</span>, orderDTO);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"order/detail"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 卖家端订单完结</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> orderId</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@GetMapping("/finish")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">finish</span><span class=params>(<span class=meta>@RequestParam(value = "orderId")</span> String orderId,</span></span><br><span class=line><span class=params>                               Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDTO</span>();</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            orderDTO = orderService.findOne(orderId);</span><br><span class=line>            orderService.finish(orderDTO);</span><br><span class=line>        } <span class=keyword>catch</span> (SellException e) {</span><br><span class=line>            log.error(<span class=string>"【卖家端完结订单异常】{}"</span>, e);</span><br><span class=line>            map.put(<span class=string>"msg"</span>, e.getMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/order/list"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        map.put(<span class=string>"msg"</span>, ResultEnum.ORDER_FINISH_SUCCESS.getMsg());</span><br><span class=line>        map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/order/list"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/success"</span>, map);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=SellerProductController><a class=headerlink href=#SellerProductController title=SellerProductController></a>SellerProductController</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductInfo;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ProductStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.form.ProductForm;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.CategoryService;</span><br><span class=line><span class=keyword>import</span> com.imooc.service.ProductService;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.KeyUtil;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.BeanUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.Page;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.domain.PageRequest;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Controller;</span><br><span class=line><span class=keyword>import</span> org.springframework.util.StringUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.validation.BindingResult;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.validation.Valid;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 卖家端商品列表</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=meta>@Controller</span></span><br><span class=line><span class=meta>@RequestMapping("/seller/product")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellerProductController</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductService productService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> CategoryService categoryService;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 商品列表</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> page</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> size</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param</span> map</span></span><br><span class=line><span class=comment>     * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@GetMapping("/list")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">list</span><span class=params>(<span class=meta>@RequestParam(value = "page", defaultValue = "1")</span> Integer page,</span></span><br><span class=line><span class=params>                             <span class=meta>@RequestParam(value = "size", defaultValue = "10")</span> Integer size,</span></span><br><span class=line><span class=params>                             Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=type>PageRequest</span> <span class=variable>request</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">PageRequest</span>(page - <span class=number>1</span>, size);</span><br><span class=line>        Page&lt;ProductInfo> productInfoPage = productService.findAll(request);</span><br><span class=line>        map.put(<span class=string>"productInfoPage"</span>, productInfoPage);</span><br><span class=line>        map.put(<span class=string>"currentPage"</span>, page);</span><br><span class=line>        map.put(<span class=string>"size"</span>, size);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"product/list"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@RequestMapping("/on_sale")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">onSale</span><span class=params>(<span class=meta>@RequestParam(value = "productId")</span> String productId,</span></span><br><span class=line><span class=params>                               Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            productService.onSale(productId);</span><br><span class=line>        } <span class=keyword>catch</span> (SellException e) {</span><br><span class=line>            map.put(<span class=string>"msg"</span>, e.getMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/product/list"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/product/list"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/success"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@RequestMapping("/off_sale")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">offSale</span><span class=params>(<span class=meta>@RequestParam(value = "productId")</span> String productId,</span></span><br><span class=line><span class=params>                                Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            productService.offSale(productId);</span><br><span class=line>        } <span class=keyword>catch</span> (SellException e) {</span><br><span class=line>            map.put(<span class=string>"msg"</span>, e.getMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/product/list"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/product/list"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/success"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@RequestMapping("/index")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">index</span><span class=params>(<span class=meta>@RequestParam(value = "productId", required = false)</span> String productId,</span></span><br><span class=line><span class=params>                              Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>if</span> (!StringUtils.isEmpty(productId)) {</span><br><span class=line>            <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> productService.findOne(productId);</span><br><span class=line>            map.put(<span class=string>"productInfo"</span>, productInfo);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=comment>//查询所有商品类目</span></span><br><span class=line>        List&lt;ProductCategory> categoryList = categoryService.findAll();</span><br><span class=line>        map.put(<span class=string>"categoryList"</span>, categoryList);</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"product/index"</span>, map);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@PostMapping("/save")</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">save</span><span class=params>(<span class=meta>@Valid</span> ProductForm form,</span></span><br><span class=line><span class=params>                             BindingResult bindingResult,</span></span><br><span class=line><span class=params>                             Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>if</span> (bindingResult.hasErrors()) {</span><br><span class=line>            map.put(<span class=string>"msg"</span>, bindingResult.getFieldError().getDefaultMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/product/index"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=type>ProductInfo</span> <span class=variable>productInfo</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductInfo</span>();</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            <span class=keyword>if</span> (StringUtils.isEmpty(form.getProductId())) {</span><br><span class=line>                form.setProductId(KeyUtil.genUniqueKey());</span><br><span class=line>                productInfo.setProductStatus(ProductStatusEnum.DOWN.getCode());</span><br><span class=line>            } <span class=keyword>else</span> {</span><br><span class=line>                productInfo = productService.findOne(form.getProductId());</span><br><span class=line>            }</span><br><span class=line></span><br><span class=line>            BeanUtils.copyProperties(form, productInfo);</span><br><span class=line>            productService.save(productInfo);</span><br><span class=line>        } <span class=keyword>catch</span> (SellException e) {</span><br><span class=line>            map.put(<span class=string>"msg"</span>, e.getMessage());</span><br><span class=line>            map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/product/index"</span>);</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/error"</span>, map);</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        map.put(<span class=string>"url"</span>, <span class=string>"/sell/seller/product/list"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"common/success"</span>, map);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=WechatController><a class=headerlink href=#WechatController title=WechatController></a>WechatController</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.common.api.WxConsts;</span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.common.exception.WxErrorException;</span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.mp.api.WxMpService;</span><br><span class=line><span class=keyword>import</span> me.chanjar.weixin.mp.bean.result.WxMpOAuth2AccessToken;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Controller;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.net.URLEncoder;</span><br><span class=line></span><br><span class=line><span class=meta>@Controller</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=meta>@RequestMapping("/wechat")</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">WechatController</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> WxMpService wxMpService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@GetMapping("/authorize")</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">authorize</span><span class=params>(<span class=meta>@RequestParam("returnUrl")</span> String returnUrl)</span> {</span><br><span class=line>        <span class=comment>//1. 配置</span></span><br><span class=line>        <span class=comment>//2. 调用方法</span></span><br><span class=line>        <span class=type>String</span> <span class=variable>url</span> <span class=operator>=</span> <span class=string>"http://kwang.natapp1.cc/sell/wechat/userInfo"</span>;</span><br><span class=line>        <span class=type>String</span> <span class=variable>redirectUrl</span> <span class=operator>=</span> wxMpService.oauth2buildAuthorizationUrl(url, WxConsts.OAUTH2_SCOPE_BASE, URLEncoder.encode(returnUrl));</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"redirect:"</span> + redirectUrl;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@GetMapping("/userInfo")</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">userInfo</span><span class=params>(<span class=meta>@RequestParam("code")</span> String code,</span></span><br><span class=line><span class=params>                           <span class=meta>@RequestParam("state")</span> String returnUrl)</span> {</span><br><span class=line>        <span class=type>WxMpOAuth2AccessToken</span> <span class=variable>wxMpOAuth2AccessToken</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">WxMpOAuth2AccessToken</span>();</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            wxMpOAuth2AccessToken = wxMpService.oauth2getAccessToken(code);</span><br><span class=line>        } <span class=keyword>catch</span> (WxErrorException e) {</span><br><span class=line>            log.error(<span class=string>"【微信网页授权】{}"</span>, e);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.WECHAT_MP_ERROR.getCode(), e.getError().getErrorMsg());</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=type>String</span> <span class=variable>openId</span> <span class=operator>=</span> wxMpOAuth2AccessToken.getOpenId();</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> <span class=string>"redirect:"</span> + returnUrl + <span class=string>"?openid="</span> + openId;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h3 id=WeixinController><a class=headerlink href=#WeixinController title=WeixinController></a>WeixinController</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.google.gson.Gson;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.client.RestTemplate;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=meta>@RestController</span></span><br><span class=line><span class=meta>@RequestMapping("/weixin")</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">WeixinController</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>// 不使用第三方SDK，手工获取access_token和openid</span></span><br><span class=line></span><br><span class=line>    <span class=meta>@GetMapping("/auth")</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">auth</span><span class=params>(<span class=meta>@RequestParam("code")</span> String code)</span> {</span><br><span class=line></span><br><span class=line>        <span class=comment>// 1. 获取code</span></span><br><span class=line>        <span class=comment>// https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx1e582ce44016633f&redirect_uri=http://kwang.natapp1.cc/sell/weixin/auth&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect</span></span><br><span class=line></span><br><span class=line>        log.info(<span class=string>"进入auth方法。。。"</span>);</span><br><span class=line>        log.info(<span class=string>"code = {}"</span>, code);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 2. 获取access_token和openid</span></span><br><span class=line>        <span class=type>String</span> <span class=variable>url</span> <span class=operator>=</span> <span class=string>"https://api.weixin.qq.com/sns/oauth2/access_token?appid=wx1e582ce44016633f&secret=12756683d0002884e2f2e7ad2f87e758&code="</span></span><br><span class=line>                + code + <span class=string>"&grant_type=authorization_code"</span>;</span><br><span class=line></span><br><span class=line>        <span class=type>RestTemplate</span> <span class=variable>restTemplate</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">RestTemplate</span>();</span><br><span class=line>        <span class=type>String</span> <span class=variable>response</span> <span class=operator>=</span> restTemplate.getForObject(url, String.class);</span><br><span class=line></span><br><span class=line>        log.info(<span class=string>"微信返回token: response={}"</span>, response);</span><br><span class=line></span><br><span class=line>        <span class=type>Gson</span> <span class=variable>gs</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Gson</span>();</span><br><span class=line>        Map&lt;String, String> map = gs.fromJson(response, Map.class);</span><br><span class=line>        log.info(<span class=string>"access_token={}"</span>, map.get(<span class=string>"access_token"</span>));</span><br><span class=line>        log.info(<span class=string>"openid={}"</span>, map.get(<span class=string>"openid"</span>));</span><br><span class=line></span><br><span class=line>        <span class=comment>// 3. 获取微信用户详细信息</span></span><br><span class=line>        url = <span class=string>"https://api.weixin.qq.com/sns/userinfo?access_token="</span> + map.get(<span class=string>"access_token"</span>)</span><br><span class=line>                + <span class=string>"&openid="</span> + map.get(<span class=string>"openid"</span>) + <span class=string>"&lang=zh_CN"</span>;</span><br><span class=line></span><br><span class=line>        response = restTemplate.getForObject(url, String.class);</span><br><span class=line>        log.info(<span class=string>"微信返回用户详细信息: response={}"</span>, response);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=VO视图层><a class=headerlink href=#VO视图层 title=VO视图层></a>VO视图层</h2><blockquote><p>引入VO对象主要是解决更容易返回前端所需要的数据结构。<br>要返回的数据格式如下：</blockquote><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwfjyju6j30tc12s175.jpg><h3 id=第一层VO-ResultVO><a title="第一层VO - ResultVO" class=headerlink href=#第一层VO-ResultVO></a>第一层VO - ResultVO</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.VO;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * http请求返回的最外层对象</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ResultVO</span>&lt;T> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/* 状态码 */</span></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line></span><br><span class=line>    <span class=comment>/* 提示信息 */</span></span><br><span class=line>    <span class=keyword>private</span> String msg;</span><br><span class=line></span><br><span class=line>    <span class=comment>/* 具体内容 */</span></span><br><span class=line>    <span class=keyword>private</span> T data;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=第二层VO-ProductVO><a title="第二层VO - ProductVO" class=headerlink href=#第二层VO-ProductVO></a>第二层VO - ProductVO</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.VO;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.fasterxml.jackson.annotation.JsonProperty;</span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 商品（包含类目）</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductVO</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("name")</span></span><br><span class=line>    <span class=keyword>private</span> String categoryName;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("type")</span></span><br><span class=line>    <span class=keyword>private</span> Integer categoryType;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("foods")</span></span><br><span class=line>    <span class=keyword>private</span> List&lt;ProductInfoVO> productInfoVOList;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=第三层VO-ProductInfoVO><a title="第三层VO - ProductInfoVO" class=headerlink href=#第三层VO-ProductInfoVO></a>第三层VO - ProductInfoVO</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.VO;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.fasterxml.jackson.annotation.JsonProperty;</span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * 商品详情</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductInfoVO</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("id")</span></span><br><span class=line>    <span class=keyword>private</span> String productId;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("name")</span></span><br><span class=line>    <span class=keyword>private</span> String productName;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("price")</span></span><br><span class=line>    <span class=keyword>private</span> BigDecimal productPrice;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("description")</span></span><br><span class=line>    <span class=keyword>private</span> String productDescription;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonProperty("icon")</span></span><br><span class=line>    <span class=keyword>private</span> String productIcon;</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=DTO层><a class=headerlink href=#DTO层 title=DTO层></a>DTO层</h2><blockquote><p>引入DTO对象主要是为了返回的数据结构与实体对象的数据结构不匹配的问题。<br>可以简单理解成数据库视图。</blockquote><h3 id=OrderDTO><a class=headerlink href=#OrderDTO title=OrderDTO></a>OrderDTO</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dto;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class=line><span class=keyword>import</span> com.fasterxml.jackson.annotation.JsonInclude;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderDetail;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.OrderStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.PayStatusEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.EnumUtil;</span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line><span class=keyword>import</span> java.util.Date;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@JsonInclude(JsonInclude.Include.NON_NULL)</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderDTO</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 订单id.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> String orderId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家名字.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerName;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家手机号.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerPhone;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家地址.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerAddress;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家微信Openid.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> String buyerOpenid;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 订单总金额.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> BigDecimal orderAmount;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 订单状态, 默认为0新下单.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> Integer orderStatus;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 支付状态, 默认为0未支付.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> Integer payStatus;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 创建时间.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line><span class=comment>//    @JsonSerialize(using = Date2LongSerializer.class)</span></span><br><span class=line>    <span class=keyword>private</span> Date createTime;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 更新时间.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line><span class=comment>//    @JsonSerialize(using = Date2LongSerializer.class)</span></span><br><span class=line>    <span class=keyword>private</span> Date updateTime;</span><br><span class=line></span><br><span class=line>    List&lt;OrderDetail> orderDetailList;</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonIgnore</span></span><br><span class=line>    <span class=keyword>public</span> OrderStatusEnum <span class="title function_">getOrderStatusEnum</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> EnumUtil.getByCode(orderStatus, OrderStatusEnum.class);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@JsonIgnore</span></span><br><span class=line>    <span class=keyword>public</span> PayStatusEnum <span class="title function_">getPayStatusEnum</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> EnumUtil.getByCode(payStatus, PayStatusEnum.class);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=CartDTO><a class=headerlink href=#CartDTO title=CartDTO></a>CartDTO</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dto;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CartDTO</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String productId;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer productQuantity;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">CartDTO</span><span class=params>(String productId, Integer productQuantity)</span> {</span><br><span class=line>        <span class=built_in>this</span>.productId = productId;</span><br><span class=line>        <span class=built_in>this</span>.productQuantity = productQuantity;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Form类><a class=headerlink href=#Form类 title=Form类></a>Form类</h2><h3 id=CategoryForm><a class=headerlink href=#CategoryForm title=CategoryForm></a>CategoryForm</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.form;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">CategoryForm</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer categoryId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 类目名称.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> String categoryName;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 类目编号.</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> Integer categoryType;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=ProductForm><a class=headerlink href=#ProductForm title=ProductForm></a>ProductForm</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.form;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.math.BigDecimal;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductForm</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String productId;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 名字. */</span></span><br><span class=line>    <span class=keyword>private</span> String productName;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 单价. */</span></span><br><span class=line>    <span class=keyword>private</span> BigDecimal productPrice;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 库存. */</span></span><br><span class=line>    <span class=keyword>private</span> Integer productStock;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 描述. */</span></span><br><span class=line>    <span class=keyword>private</span> String productDescription;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 小图. */</span></span><br><span class=line>    <span class=keyword>private</span> String productIcon;</span><br><span class=line></span><br><span class=line>    <span class=comment>/** 类目编号. */</span></span><br><span class=line>    <span class=keyword>private</span> Integer categoryType;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=OrderForm><a class=headerlink href=#OrderForm title=OrderForm></a>OrderForm</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.form;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.validation.constraints.NotEmpty;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderForm</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家姓名</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@NotEmpty(message = "买家姓名不能为空")</span></span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家电话</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@NotEmpty(message = "买家电话不能为空")</span></span><br><span class=line>    <span class=keyword>private</span> String phone;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家地址</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@NotEmpty(message = "买家地址不能为空")</span></span><br><span class=line>    <span class=keyword>private</span> String address;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家openid</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@NotEmpty(message = "买家openid不能为空")</span></span><br><span class=line>    <span class=keyword>private</span> String openid;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 买家购物车</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@NotEmpty(message = "购物车不能为空")</span></span><br><span class=line>    <span class=keyword>private</span> String items;</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=Exception异常处理><a class=headerlink href=#Exception异常处理 title=Exception异常处理></a>Exception异常处理</h2><h3 id=自定义异常><a class=headerlink href=#自定义异常 title=自定义异常></a>自定义异常</h3><h4 id=SellException><a class=headerlink href=#SellException title=SellException></a>SellException</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.exception;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellException</span> <span class=keyword>extends</span> <span class="title class_">RuntimeException</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SellException</span><span class=params>(ResultEnum resultEnum)</span> {</span><br><span class=line>        <span class=built_in>super</span>(resultEnum.getMsg());</span><br><span class=line>        <span class=built_in>this</span>.code = resultEnum.getCode();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">SellException</span><span class=params>(Integer code, String message)</span> {</span><br><span class=line>        <span class=built_in>super</span>(message);</span><br><span class=line>        <span class=built_in>this</span>.code = code;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h4 id=ResponseBankException><a class=headerlink href=#ResponseBankException title=ResponseBankException></a>ResponseBankException</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.exception;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ResponseBankException</span> <span class=keyword>extends</span> <span class="title class_">RuntimeException</span> {</span><br><span class=line>}</span><br></pre></table></figure><h4 id=SellerAuthorizeException><a class=headerlink href=#SellerAuthorizeException title=SellerAuthorizeException></a>SellerAuthorizeException</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.exception;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellerAuthorizeException</span> <span class=keyword>extends</span> <span class="title class_">RuntimeException</span> {</span><br><span class=line>}</span><br></pre></table></figure><h3 id=自定义异常处理器><a class=headerlink href=#自定义异常处理器 title=自定义异常处理器></a>自定义异常处理器</h3><h4 id=SellExceptionHandler><a class=headerlink href=#SellExceptionHandler title=SellExceptionHandler></a>SellExceptionHandler</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.handler;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.VO.ResultVO;</span><br><span class=line><span class=keyword>import</span> com.imooc.config.ProjectUrlConfig;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.ResponseBankException;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellerAuthorizeException;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.ResultVOUtil;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.http.HttpStatus;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ResponseStatus;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class=line></span><br><span class=line><span class=meta>@ControllerAdvice</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellExceptionHandler</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProjectUrlConfig projectUrlConfig;</span><br><span class=line></span><br><span class=line>    <span class=comment>//拦截登录异常</span></span><br><span class=line>    <span class=comment>//http://sell.natapp4.cc/sell/wechat/qrAuthorize?returnUrl=http://sell.natapp4.cc/sell/seller/login</span></span><br><span class=line>    <span class=meta>@ExceptionHandler(value = SellerAuthorizeException.class)</span></span><br><span class=line>    <span class=meta>@ResponseStatus(HttpStatus.FORBIDDEN)</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">handlerAuthorizeException</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>(<span class=string>"redirect:"</span></span><br><span class=line>        .concat(projectUrlConfig.getWechatOpenAuthorize())</span><br><span class=line>        .concat(<span class=string>"/sell/wechat/qrAuthorize"</span>)</span><br><span class=line>        .concat(<span class=string>"?returnUrl="</span>)</span><br><span class=line>        .concat(projectUrlConfig.getSell())</span><br><span class=line>        .concat(<span class=string>"/sell/seller/login"</span>));</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@ExceptionHandler(value = SellException.class)</span></span><br><span class=line>    <span class=meta>@ResponseBody</span></span><br><span class=line>    <span class=keyword>public</span> ResultVO <span class="title function_">handlerSellerException</span><span class=params>(SellException e)</span> {</span><br><span class=line>        <span class=keyword>return</span> ResultVOUtil.error(e.getCode(), e.getMessage());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@ExceptionHandler(value = ResponseBankException.class)</span></span><br><span class=line>    <span class=meta>@ResponseStatus(HttpStatus.FORBIDDEN)</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">handleResponseBankException</span><span class=params>()</span> {</span><br><span class=line></span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=统一异常处理><a class=headerlink href=#统一异常处理 title=统一异常处理></a>统一异常处理</h3><h4 id=ThymeleafTest><a class=headerlink href=#ThymeleafTest title=ThymeleafTest></a>ThymeleafTest</h4><p>假设访问一个不存在的页面，抛出异常<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Controller;</span><br><span class=line><span class=keyword>import</span> org.springframework.ui.ModelMap;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class=line></span><br><span class=line><span class=meta>@Controller</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ThymeleafTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@ResponseBody</span></span><br><span class=line>    <span class=meta>@RequestMapping("/hello")</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">hello</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">Exception</span>(<span class=string>"发生错误"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=创建全局异常处理类><a class=headerlink href=#创建全局异常处理类 title=创建全局异常处理类></a>创建全局异常处理类</h3><blockquote><p>通过使用<code>@ControllerAdvice</code>定义统一的异常处理类，而不是在每个Controller中逐个定义。<code>@ExceptionHandler</code>用来定义函数针对的异常类型，最后将Exception对象和请求URL映射到<code>error.html</code>中。</blockquote><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.exception;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.entities.ErrorInfo;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class=line><span class=keyword>import</span> javax.servlet.http.HttpServletRequest;</span><br><span class=line></span><br><span class=line><span class=meta>@ControllerAdvice</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">GlobalExceptionHandler</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>String</span> <span class=variable>DEFAULT_ERROR_VIEW</span> <span class=operator>=</span> <span class=string>"error"</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@ExceptionHandler(value = Exception.class)</span></span><br><span class=line>    <span class=keyword>public</span> ModelAndView <span class="title function_">defaultErrorHandler</span><span class=params>(HttpServletRequest req, Exception e)</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        <span class=type>ModelAndView</span> <span class=variable>mav</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ModelAndView</span>();</span><br><span class=line>        mav.addObject(<span class=string>"exception"</span>, e);</span><br><span class=line>        mav.addObject(<span class=string>"url"</span>, req.getRequestURL());</span><br><span class=line>        mav.setViewName(DEFAULT_ERROR_VIEW);</span><br><span class=line>        <span class=keyword>return</span> mav;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><blockquote><p>实现<code>error.html</code>页面展示：在<code>templates</code>目录下创建<code>error.html</code>，将请求的URL和Exception对象的message输出。</blockquote><figure class="highlight htmlbars"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=language-xml><span class=meta>&lt;!DOCTYPE <span class=keyword>html</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>html</span> <span class=attr>xmlns:th</span>=<span class=string>"http://www.w3.org/1999/xhtml"</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>head</span> <span class=attr>lang</span>=<span class=string>"en"</span>></span></span></span><br><span class=line><span class=language-xml>    <span class=tag>&lt;<span class=name>meta</span> <span class=attr>charset</span>=<span class=string>"UTF-8"</span>/></span></span></span><br><span class=line><span class=language-xml>    <span class=tag>&lt;<span class=name>title</span>></span>统一异常处理<span class=tag>&lt;/<span class=name>title</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>head</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>body</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>h1</span>></span>Error Handler<span class=tag>&lt;/<span class=name>h1</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>div</span> <span class=attr>th:text</span>=<span class=string>"${url}"</span>></span><span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>div</span> <span class=attr>th:text</span>=<span class=string>"${exception.message}"</span>></span><span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>body</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>html</span>></span></span></span><br></pre></table></figure><blockquote><p>启动该应用，访问：<code>http://localhost:8080/hello</code>，可以看到如下错误提示页面。</blockquote><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwgrmsg0j31a80mm10h.jpg><blockquote><p>通过实现上述内容之后，我们只需要在Controller中抛出Exception，当然我们可能会有多种不同的Exception。然后在<code>@ControllerAdvice</code>类中，根据抛出的具体Exception类型匹配<code>@ExceptionHandler</code>中配置的异常类型来匹配错误映射和处理。</blockquote><h3 id=返回json格式><a class=headerlink href=#返回json格式 title=返回json格式></a>返回json格式</h3><blockquote><p>创建统一的JSON返回对象，code：消息类型，message：消息内容，url：请求的url，data：请求返回的数据。</blockquote><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.entities;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ErrorInfo</span>&lt;T> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>Integer</span> <span class=variable>OK</span> <span class=operator>=</span> <span class=number>0</span>;</span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=type>Integer</span> <span class=variable>ERROR</span> <span class=operator>=</span> <span class=number>100</span>;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> Integer code;</span><br><span class=line>    <span class=keyword>private</span> String message;</span><br><span class=line>    <span class=keyword>private</span> String url;</span><br><span class=line>    <span class=keyword>private</span> T data;</span><br><span class=line>}</span><br></pre></table></figure><p>创建一个自定义异常，用来实验捕获该异常，并返回json。<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.exception;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">MyException</span> <span class=keyword>extends</span> <span class="title class_">Exception</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">MyException</span><span class=params>(String message)</span> {</span><br><span class=line>        <span class=built_in>super</span>(message);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><p><code>Controller</code>中增加json映射，抛出<code>MyException</code>异常。<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.exception.MyException;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Controller;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line></span><br><span class=line><span class=meta>@Controller</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">HelloController</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@RequestMapping("/json")</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">json</span><span class=params>()</span> <span class=keyword>throws</span> MyException {</span><br><span class=line>        <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">MyException</span>(<span class=string>"发生错误2"</span>);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><p>为<code>MyException</code>异常创建对应的处理。<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br></pre><td class=code><pre><span class=line><span class=meta>@ExceptionHandler(value = MyException.class)</span></span><br><span class=line>    <span class=meta>@ResponseBody</span></span><br><span class=line>    <span class=keyword>public</span> ErrorInfo&lt;String> <span class="title function_">jsonErrorHandler</span><span class=params>(HttpServletRequest req, MyException e)</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        ErrorInfo&lt;String> r = <span class=keyword>new</span> <span class="title class_">ErrorInfo</span>&lt;>();</span><br><span class=line>        r.setMessage(e.getMessage());</span><br><span class=line>        r.setCode(ErrorInfo.ERROR);</span><br><span class=line>        r.setData(<span class=string>"Some Data"</span>);</span><br><span class=line>        r.setUrl(req.getRequestURL().toString());</span><br><span class=line>        <span class=keyword>return</span> r;</span><br><span class=line>    }</span><br></pre></table></figure><p>启动应用，访问：<code>http://localhost:8080/json</code>，可以得到如下返回内容：<p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwhe1igxj30xy0cmdif.jpg><hr><h2 id=Authorize用户有效性鉴定><a class=headerlink href=#Authorize用户有效性鉴定 title=Authorize用户有效性鉴定></a>Authorize用户有效性鉴定</h2><h3 id=SellerAuthorizeAspect><a class=headerlink href=#SellerAuthorizeAspect title=SellerAuthorizeAspect></a>SellerAuthorizeAspect</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.aspect;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.constant.CookieConstant;</span><br><span class=line><span class=keyword>import</span> com.imooc.constant.RedisConstant;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellerAuthorizeException;</span><br><span class=line><span class=keyword>import</span> com.imooc.utils.CookieUtil;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class=line><span class=keyword>import</span> org.aspectj.lang.annotation.Before;</span><br><span class=line><span class=keyword>import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Component;</span><br><span class=line><span class=keyword>import</span> org.springframework.util.StringUtils;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.context.request.RequestContextHolder;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class=line><span class=keyword>import</span> javax.servlet.http.Cookie;</span><br><span class=line><span class=keyword>import</span> javax.servlet.http.HttpServletRequest;</span><br><span class=line></span><br><span class=line><span class=meta>@Aspect</span></span><br><span class=line><span class=meta>@Component</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">SellerAuthorizeAspect</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> StringRedisTemplate redisTemplate;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Pointcut("execution(public * com.imooc.controller.Seller*.*(..))" +</span></span><br><span class=line><span class=meta>            "&& !execution(public * com.imooc.controller.SellerUserController.*(..))")</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">verify</span><span class=params>()</span> {</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Before("verify()")</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">doVerify</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ServletRequestAttributes</span> <span class=variable>attributes</span> <span class=operator>=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class=line>        <span class=type>HttpServletRequest</span> <span class=variable>request</span> <span class=operator>=</span> attributes.getRequest();</span><br><span class=line></span><br><span class=line>        <span class=comment>//查询cookie</span></span><br><span class=line>        <span class=type>Cookie</span> <span class=variable>cookie</span> <span class=operator>=</span> CookieUtil.get(request, CookieConstant.TOKEN);</span><br><span class=line>        <span class=keyword>if</span> (cookie == <span class=literal>null</span>) {</span><br><span class=line>            log.warn(<span class=string>"【登录校验】Cookie中查不到token"</span>);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellerAuthorizeException</span>();</span><br><span class=line>        }</span><br><span class=line></span><br><span class=line>        <span class=comment>//去redis里查询</span></span><br><span class=line>        <span class=type>String</span> <span class=variable>tokenValue</span> <span class=operator>=</span> redisTemplate.opsForValue().get(String.format(RedisConstant.TOKEN_PREFIX, cookie.getValue()));</span><br><span class=line>        <span class=keyword>if</span> (StringUtils.isEmpty(tokenValue)) {</span><br><span class=line>            log.warn(<span class=string>"【登录校验】Redis中查不到token"</span>);</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellerAuthorizeException</span>();</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><hr><h2 id=使用Mabatis注解方式实现增删改查><a class=headerlink href=#使用Mabatis注解方式实现增删改查 title=使用Mabatis注解方式实现增删改查></a>使用Mabatis注解方式实现增删改查</h2><h3 id=mapper层><a class=headerlink href=#mapper层 title=mapper层></a>mapper层</h3><h4 id=ProductCategoryMapper><a class=headerlink href=#ProductCategoryMapper title=ProductCategoryMapper></a>ProductCategoryMapper</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject.mapper;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> org.apache.ibatis.annotations.*;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">ProductCategoryMapper</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Insert("insert into product_category(category_name, category_type) values (#{categoryName, jdbcType=VARCHAR}, #{category_type, jdbcType=INTEGER})")</span></span><br><span class=line>    <span class=type>int</span> <span class="title function_">insertByMap</span><span class=params>(Map&lt;String, Object> map)</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Insert("insert into product_category(category_name, category_type) values (#{categoryName, jdbcType=VARCHAR}, #{categoryType, jdbcType=INTEGER})")</span></span><br><span class=line>    <span class=type>int</span> <span class="title function_">insertByObject</span><span class=params>(ProductCategory productCategory)</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Select("select * from product_category where category_type = #{categoryType}")</span></span><br><span class=line>    <span class=meta>@Results({</span></span><br><span class=line><span class=meta>            @Result(column = "category_id", property = "categoryId"),</span></span><br><span class=line><span class=meta>            @Result(column = "category_name", property = "categoryName"),</span></span><br><span class=line><span class=meta>            @Result(column = "category_type", property = "categoryType")</span></span><br><span class=line><span class=meta>    })</span></span><br><span class=line>    ProductCategory <span class="title function_">findByCategoryType</span><span class=params>(Integer categoryType)</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Select("select * from product_category where category_name = #{categoryName}")</span></span><br><span class=line>    <span class=meta>@Results({</span></span><br><span class=line><span class=meta>            @Result(column = "category_id", property = "categoryId"),</span></span><br><span class=line><span class=meta>            @Result(column = "category_name", property = "categoryName"),</span></span><br><span class=line><span class=meta>            @Result(column = "category_type", property = "categoryType")</span></span><br><span class=line><span class=meta>    })</span></span><br><span class=line>    List&lt;ProductCategory> <span class="title function_">findByCategoryName</span><span class=params>(String categoryName)</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Update("update product_category set category_name = #{categoryName} where category_type = #{categoryType}")</span></span><br><span class=line>    <span class=type>int</span> <span class="title function_">updateByCategoryType</span><span class=params>(<span class=meta>@Param("categoryName")</span> String categoryName,</span></span><br><span class=line><span class=params>                             <span class=meta>@Param("categoryType")</span> Integer categoryType)</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Update("update product_category set category_name = #{categoryName} where category_type = #{categoryType}")</span></span><br><span class=line>    <span class=type>int</span> <span class="title function_">updateByObject</span><span class=params>(ProductCategory productCategory)</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Delete("delete from product_category where category_type = #{categoryType}")</span></span><br><span class=line>    <span class=type>int</span> <span class="title function_">deleteByCategoryType</span><span class=params>(Integer categoryType)</span>;</span><br><span class=line></span><br><span class=line>    ProductCategory <span class="title function_">selectByCategoryType</span><span class=params>(Integer categoryType)</span>;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=mapper单元测试><a class=headerlink href=#mapper单元测试 title=mapper单元测试></a>mapper单元测试</h3><h4 id=ProductCategoryMapperTest><a class=headerlink href=#ProductCategoryMapperTest title=ProductCategoryMapperTest></a>ProductCategoryMapperTest</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject.mapper;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.ProductCategory;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line><span class=keyword>import</span> java.util.HashMap;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductCategoryMapperTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ProductCategoryMapper mapper;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">insertByMap</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        Map&lt;String, Object> map = <span class=keyword>new</span> <span class="title class_">HashMap</span>&lt;>();</span><br><span class=line>        map.put(<span class=string>"categoryName"</span>, <span class=string>"师兄最不爱"</span>);</span><br><span class=line>        map.put(<span class=string>"category_type"</span>, <span class=number>101</span>);</span><br><span class=line>        <span class=type>int</span> <span class=variable>result</span> <span class=operator>=</span> mapper.insertByMap(map);</span><br><span class=line>        Assert.assertEquals(<span class=number>1</span>, result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">insertByObject</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductCategory</span>();</span><br><span class=line>        productCategory.setCategoryName(<span class=string>"师兄最不爱"</span>);</span><br><span class=line>        productCategory.setCategoryType(<span class=number>102</span>);</span><br><span class=line>        <span class=type>int</span> <span class=variable>result</span> <span class=operator>=</span> mapper.insertByObject(productCategory);</span><br><span class=line>        Assert.assertEquals(<span class=number>1</span>, result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findByCategoryType</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>result</span> <span class=operator>=</span> mapper.findByCategoryType(<span class=number>102</span>);</span><br><span class=line>        Assert.assertNotNull(result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">findByCategoryName</span><span class=params>()</span> {</span><br><span class=line>        List&lt;ProductCategory> result = mapper.findByCategoryName(<span class=string>"师兄最不爱"</span>);</span><br><span class=line>        Assert.assertNotEquals(<span class=number>0</span>, result.size());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">updateByCategoryType</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>int</span> <span class=variable>result</span> <span class=operator>=</span> mapper.updateByCategoryType(<span class=string>"师兄最不爱的分类"</span>, <span class=number>102</span>);</span><br><span class=line>        Assert.assertEquals(<span class=number>1</span>, result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">updateByObject</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">ProductCategory</span>();</span><br><span class=line>        productCategory.setCategoryName(<span class=string>"师兄最不爱"</span>);</span><br><span class=line>        productCategory.setCategoryType(<span class=number>102</span>);</span><br><span class=line>        <span class=type>int</span> <span class=variable>result</span> <span class=operator>=</span> mapper.updateByObject(productCategory);</span><br><span class=line>        Assert.assertEquals(<span class=number>1</span>, result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">deleteByCategoryType</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>int</span> <span class=variable>result</span> <span class=operator>=</span> mapper.deleteByCategoryType(<span class=number>102</span>);</span><br><span class=line>        Assert.assertEquals(<span class=number>1</span>, result);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">selectByCategoryType</span><span class=params>()</span> {</span><br><span class=line>        <span class=type>ProductCategory</span> <span class=variable>productCategory</span> <span class=operator>=</span> mapper.selectByCategoryType(<span class=number>101</span>);</span><br><span class=line>        Assert.assertNotNull(productCategory);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h3 id=DAO层><a class=headerlink href=#DAO层 title=DAO层></a>DAO层</h3><h4 id=ProductCategoryDao><a class=headerlink href=#ProductCategoryDao title=ProductCategoryDao></a>ProductCategoryDao</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.dataobject.dao;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.mapper.ProductCategoryMapper;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Map;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ProductCategoryDao</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    ProductCategoryMapper mapper;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=type>int</span> <span class="title function_">insertByMap</span><span class=params>(Map&lt;String, Object> map)</span> {</span><br><span class=line>        <span class=keyword>return</span> mapper.insertByMap(map);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=对象转换><a class=headerlink href=#对象转换 title=对象转换></a>对象转换</h2><h3 id=Form表单对象（Json）转成DTO><a class=headerlink href=#Form表单对象（Json）转成DTO title=Form表单对象（Json）转成DTO></a>Form表单对象（Json）转成DTO</h3><h4 id=OrderForm2OrderDTOConverter><a class=headerlink href=#OrderForm2OrderDTOConverter title=OrderForm2OrderDTOConverter></a>OrderForm2OrderDTOConverter</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.converter;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.google.gson.Gson;</span><br><span class=line><span class=keyword>import</span> com.google.gson.reflect.TypeToken;</span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderDetail;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> com.imooc.enums.ResultEnum;</span><br><span class=line><span class=keyword>import</span> com.imooc.exception.SellException;</span><br><span class=line><span class=keyword>import</span> com.imooc.form.OrderForm;</span><br><span class=line><span class=keyword>import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=line><span class=keyword>import</span> java.util.ArrayList;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line></span><br><span class=line><span class=meta>@Slf4j</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderForm2OrderDTOConverter</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> OrderDTO <span class="title function_">convert</span><span class=params>(OrderForm orderForm)</span> {</span><br><span class=line>        <span class=type>Gson</span> <span class=variable>gson</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">Gson</span>();</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDTO</span>();</span><br><span class=line></span><br><span class=line>        orderDTO.setBuyerName(orderForm.getName());</span><br><span class=line>        orderDTO.setBuyerPhone(orderForm.getPhone());</span><br><span class=line>        orderDTO.setBuyerAddress(orderForm.getAddress());</span><br><span class=line>        orderDTO.setBuyerOpenid(orderForm.getOpenid());</span><br><span class=line></span><br><span class=line>        List&lt;OrderDetail> orderDetailList = <span class=keyword>new</span> <span class="title class_">ArrayList</span>&lt;>();</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            orderDetailList = gson.fromJson(orderForm.getItems(),</span><br><span class=line>                    <span class=keyword>new</span> <span class="title class_">TypeToken</span>&lt;List&lt;OrderDetail>>() {</span><br><span class=line>                    }.getType());</span><br><span class=line>        } <span class=keyword>catch</span> (Exception e) {</span><br><span class=line>            log.error(<span class=string>"【对象转换】错误, string={}"</span>, orderForm.getItems());</span><br><span class=line>            <span class=keyword>throw</span> <span class=keyword>new</span> <span class="title class_">SellException</span>(ResultEnum.PARAM_ERROR);</span><br><span class=line>        }</span><br><span class=line>        orderDTO.setOrderDetailList(orderDetailList);</span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=Data-Object转DTO><a title="Data Object转DTO" class=headerlink href=#Data-Object转DTO></a>Data Object转DTO</h3><h4 id=OrderMaster2OrderDTOConverter><a class=headerlink href=#OrderMaster2OrderDTOConverter title=OrderMaster2OrderDTOConverter></a>OrderMaster2OrderDTOConverter</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.imooc.converter;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.imooc.dataobject.OrderMaster;</span><br><span class=line><span class=keyword>import</span> com.imooc.dto.OrderDTO;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.BeanUtils;</span><br><span class=line><span class=keyword>import</span> java.util.List;</span><br><span class=line><span class=keyword>import</span> java.util.stream.Collectors;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">OrderMaster2OrderDTOConverter</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> OrderDTO <span class="title function_">convert</span><span class=params>(OrderMaster orderMaster)</span> {</span><br><span class=line>        <span class=type>OrderDTO</span> <span class=variable>orderDTO</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">OrderDTO</span>();</span><br><span class=line>        BeanUtils.copyProperties(orderMaster, orderDTO);</span><br><span class=line>        <span class=keyword>return</span> orderDTO;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>static</span> List&lt;OrderDTO> <span class="title function_">convert</span><span class=params>(List&lt;OrderMaster> orderMasterList)</span> {</span><br><span class=line>        <span class=keyword>return</span> orderMasterList.stream().map(e -></span><br><span class=line>                convert(e)</span><br><span class=line>        ).collect(Collectors.toList());</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=中文字符乱码><a class=headerlink href=#中文字符乱码 title=中文字符乱码></a>中文字符乱码</h2><h3 id=application-properties><a class=headerlink href=#application-properties title=application.properties></a>application.properties</h3><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=string>spring.http.encoding.force=true</span></span><br><span class=line><span class=string>spring.http.encoding.charset=UTF-8</span></span><br><span class=line><span class=string>spring.http.encoding.enabled=true</span></span><br><span class=line><span class=string>server.tomcat.uri-encoding=UTF-8</span></span><br></pre></table></figure><h3 id=IDEA设置><a class=headerlink href=#IDEA设置 title=IDEA设置></a>IDEA设置</h3><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwin8e8rj31d80wyn9d.jpg><h2 id=网页模板><a class=headerlink href=#网页模板 title=网页模板></a>网页模板</h2><h3 id=Freemarker><a class=headerlink href=#Freemarker title=Freemarker></a>Freemarker</h3><h4 id=common-header-ftl><a class=headerlink href=#common-header-ftl title=common/header.ftl></a>common/header.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>head</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>meta</span> <span class=attr>charset</span>=<span class=string>"utf-8"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>title</span>></span>卖家后端管理系统<span class=tag>&lt;/<span class=name>title</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>link</span> <span class=attr>href</span>=<span class=string>"https://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css"</span> <span class=attr>rel</span>=<span class=string>"stylesheet"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>link</span> <span class=attr>rel</span>=<span class=string>"stylesheet"</span> <span class=attr>href</span>=<span class=string>"/sell/css/style.css"</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>head</span>></span></span><br></pre></table></figure><h4 id=common-nav-ftl><a class=headerlink href=#common-nav-ftl title=common/nav.ftl></a>common/nav.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>nav</span> <span class=attr>class</span>=<span class=string>"navbar navbar-inverse navbar-fixed-top"</span> <span class=attr>id</span>=<span class=string>"sidebar-wrapper"</span> <span class=attr>role</span>=<span class=string>"navigation"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>ul</span> <span class=attr>class</span>=<span class=string>"nav sidebar-nav"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"sidebar-brand"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span>></span></span><br><span class=line>                卖家管理系统</span><br><span class=line>            <span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>li</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/list"</span>></span><span class=tag>&lt;<span class=name>i</span> <span class=attr>class</span>=<span class=string>"fa fa-fw fa-list-alt"</span>></span><span class=tag>&lt;/<span class=name>i</span>></span> 订单<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"dropdown open"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span> <span class=attr>class</span>=<span class=string>"dropdown-toggle"</span> <span class=attr>data-toggle</span>=<span class=string>"dropdown"</span> <span class=attr>aria-expanded</span>=<span class=string>"true"</span>></span><span class=tag>&lt;<span class=name>i</span> <span class=attr>class</span>=<span class=string>"fa fa-fw fa-plus"</span>></span><span class=tag>&lt;/<span class=name>i</span>></span> 商品 <span class=tag>&lt;<span class=name>span</span> <span class=attr>class</span>=<span class=string>"caret"</span>></span><span class=tag>&lt;/<span class=name>span</span>></span><span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>ul</span> <span class=attr>class</span>=<span class=string>"dropdown-menu"</span> <span class=attr>role</span>=<span class=string>"menu"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"dropdown-header"</span>></span>操作<span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/list"</span>></span>列表<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/index"</span>></span>新增<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>ul</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"dropdown open"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span> <span class=attr>class</span>=<span class=string>"dropdown-toggle"</span> <span class=attr>data-toggle</span>=<span class=string>"dropdown"</span> <span class=attr>aria-expanded</span>=<span class=string>"true"</span>></span><span class=tag>&lt;<span class=name>i</span> <span class=attr>class</span>=<span class=string>"fa fa-fw fa-plus"</span>></span><span class=tag>&lt;/<span class=name>i</span>></span> 类目 <span class=tag>&lt;<span class=name>span</span> <span class=attr>class</span>=<span class=string>"caret"</span>></span><span class=tag>&lt;/<span class=name>span</span>></span><span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>ul</span> <span class=attr>class</span>=<span class=string>"dropdown-menu"</span> <span class=attr>role</span>=<span class=string>"menu"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"dropdown-header"</span>></span>操作<span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/category/list"</span>></span>列表<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/category/index"</span>></span>新增<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>ul</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line></span><br><span class=line>        <span class=tag>&lt;<span class=name>li</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/logout"</span>></span><span class=tag>&lt;<span class=name>i</span> <span class=attr>class</span>=<span class=string>"fa fa-fw fa-list-alt"</span>></span><span class=tag>&lt;/<span class=name>i</span>></span> 登出<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>ul</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>nav</span>></span></span><br></pre></table></figure><h4 id=common-success-ftl><a class=headerlink href=#common-success-ftl title=common/success.ftl></a>common/success.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>head</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>title</span>></span>成功提示<span class=tag>&lt;/<span class=name>title</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>meta</span> <span class=attr>charset</span>=<span class=string>"UTF-8"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>link</span> <span class=attr>href</span>=<span class=string>"https://cdn.bootcss.com/twitter-bootstrap/3.0.1/css/bootstrap.min.css"</span> <span class=attr>rel</span>=<span class=string>"stylesheet"</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>head</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"alert alert-dismissable alert-success"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>button</span> <span class=attr>type</span>=<span class=string>"button"</span> <span class=attr>class</span>=<span class=string>"close"</span> <span class=attr>data-dismiss</span>=<span class=string>"alert"</span> <span class=attr>aria-hidden</span>=<span class=string>"true"</span>></span>×<span class=tag>&lt;/<span class=name>button</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>h4</span>></span></span><br><span class=line>                    成功!</span><br><span class=line>                <span class=tag>&lt;/<span class=name>h4</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>strong</span>></span>${msg!""}<span class=tag>&lt;/<span class=name>strong</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"${url}"</span> <span class=attr>class</span>=<span class=string>"alert-link"</span>></span>3s后自动跳转<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>script</span>></span><span class=language-javascript></span></span><br><span class=line><span class=language-javascript>    <span class=built_in>setTimeout</span>(<span class=string>'location.href="${url}"'</span>, <span class=number>3000</span>);</span></span><br><span class=line><span class=language-javascript></span><span class=tag>&lt;/<span class=name>script</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>></span></span><br></pre></table></figure><h4 id=common-error-ftl><a class=headerlink href=#common-error-ftl title=common/error.ftl></a>common/error.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>head</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>title</span>></span>错误提示<span class=tag>&lt;/<span class=name>title</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>meta</span> <span class=attr>charset</span>=<span class=string>"UTF-8"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>link</span> <span class=attr>href</span>=<span class=string>"https://cdn.bootcss.com/twitter-bootstrap/3.0.1/css/bootstrap.min.css"</span> <span class=attr>rel</span>=<span class=string>"stylesheet"</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>head</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container"</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"alert alert-dismissable alert-danger"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>button</span> <span class=attr>type</span>=<span class=string>"button"</span> <span class=attr>class</span>=<span class=string>"close"</span> <span class=attr>data-dismiss</span>=<span class=string>"alert"</span> <span class=attr>aria-hidden</span>=<span class=string>"true"</span>></span>×<span class=tag>&lt;/<span class=name>button</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>h4</span>></span></span><br><span class=line>                    错误!</span><br><span class=line>                <span class=tag>&lt;/<span class=name>h4</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>strong</span>></span>${msg}<span class=tag>&lt;/<span class=name>strong</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"${url}"</span> <span class=attr>class</span>=<span class=string>"alert-link"</span>></span>3s后自动跳转<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>script</span>></span><span class=language-javascript></span></span><br><span class=line><span class=language-javascript>    <span class=built_in>setTimeout</span>(<span class=string>'location.href="${url}"'</span>, <span class=number>3000</span>);</span></span><br><span class=line><span class=language-javascript></span><span class=tag>&lt;/<span class=name>script</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>></span></span><br></pre></table></figure><h4 id=category-index-ftl><a class=headerlink href=#category-index-ftl title=category/index.ftl></a>category/index.ftl</h4><figure class="highlight htmlbars"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre><td class=code><pre><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>html</span>></span></span></span><br><span class=line><span class=language-xml>&lt;#include "../common/header.ftl"></span></span><br><span class=line><span class=language-xml></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>body</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"wrapper"</span> <span class=attr>class</span>=<span class=string>"toggled"</span>></span></span></span><br><span class=line><span class=language-xml></span></span><br><span class=line><span class=language-xml>&lt;#--边栏sidebar--></span></span><br><span class=line><span class=language-xml>&lt;#include "../common/nav.ftl"></span></span><br><span class=line><span class=language-xml></span></span><br><span class=line><span class=language-xml>&lt;#--主要内容content--></span></span><br><span class=line><span class=language-xml>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"page-content-wrapper"</span>></span></span></span><br><span class=line><span class=language-xml>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container-fluid"</span>></span></span></span><br><span class=line><span class=language-xml>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span></span><br><span class=line><span class=language-xml>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span></span><br><span class=line><span class=language-xml>                    <span class=tag>&lt;<span class=name>form</span> <span class=attr>role</span>=<span class=string>"form"</span> <span class=attr>method</span>=<span class=string>"post"</span> <span class=attr>action</span>=<span class=string>"/sell/seller/category/save"</span>></span></span></span><br><span class=line><span class=language-xml>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span></span><br><span class=line><span class=language-xml>                            <span class=tag>&lt;<span class=name>label</span>></span>名字<span class=tag>&lt;/<span class=name>label</span>></span></span></span><br><span class=line><span class=language-xml>                            <span class=tag>&lt;<span class=name>input</span> <span class=attr>name</span>=<span class=string>"categoryName"</span> <span class=attr>type</span>=<span class=string>"text"</span> <span class=attr>class</span>=<span class=string>"form-control"</span> <span class=attr>value</span>=<span class=string>"${(category.categoryName)!''}"</span>/></span></span></span><br><span class=line><span class=language-xml>                        <span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span></span><br><span class=line><span class=language-xml>                            <span class=tag>&lt;<span class=name>label</span>></span>类别<span class=tag>&lt;/<span class=name>label</span>></span></span></span><br><span class=line><span class=language-xml>                            <span class=tag>&lt;<span class=name>input</span> <span class=attr>name</span>=<span class=string>"categoryType"</span> <span class=attr>type</span>=<span class=string>"number"</span> <span class=attr>class</span>=<span class=string>"form-control"</span> <span class=attr>value</span>=<span class=string>"${(category.categoryType)!''}"</span>/></span></span></span><br><span class=line><span class=language-xml>                        <span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml>                        <span class=tag>&lt;<span class=name>input</span> <span class=attr>hidden</span> <span class=attr>type</span>=<span class=string>"text"</span> <span class=attr>name</span>=<span class=string>"categoryId"</span> <span class=attr>value</span>=<span class=string>"${(category.categoryId)!''}"</span>></span></span></span><br><span class=line><span class=language-xml>                        <span class=tag>&lt;<span class=name>button</span> <span class=attr>type</span>=<span class=string>"submit"</span> <span class=attr>class</span>=<span class=string>"btn btn-default"</span>></span>提交<span class=tag>&lt;/<span class=name>button</span>></span></span></span><br><span class=line><span class=language-xml>                    <span class=tag>&lt;/<span class=name>form</span>></span></span></span><br><span class=line><span class=language-xml>                <span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml>            <span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml>        <span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml>    <span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>div</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>body</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>html</span>></span></span></span><br></pre></table></figure><h4 id=category-list-ftl><a class=headerlink href=#category-list-ftl title=category/list.ftl></a>category/list.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>></span></span><br><span class=line>&lt;#include "../common/header.ftl"></span><br><span class=line></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"wrapper"</span> <span class=attr>class</span>=<span class=string>"toggled"</span>></span></span><br><span class=line></span><br><span class=line>    &lt;#--边栏sidebar--></span><br><span class=line>    &lt;#include "../common/nav.ftl"></span><br><span class=line></span><br><span class=line>    &lt;#--主要内容content--></span><br><span class=line>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"page-content-wrapper"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container-fluid"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                    <span class=tag>&lt;<span class=name>table</span> <span class=attr>class</span>=<span class=string>"table table-bordered table-condensed"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>类目id<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>名字<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>类别<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>创建时间<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>修改时间<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>操作<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tbody</span>></span></span><br><span class=line></span><br><span class=line>                        &lt;#list categoryList as category></span><br><span class=line>                            <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${category.categoryId}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${category.categoryName}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${category.categoryType}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${category.createTime}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${category.updateTime}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/category/index?categoryId=${category.categoryId}"</span>></span>修改<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                            <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        &lt;/#list></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tbody</span>></span></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>table</span>></span></span><br><span class=line>                <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>></span></span><br></pre></table></figure><h4 id=product-index-ftl><a class=headerlink href=#product-index-ftl title=product/index.ftl></a>product/index.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>></span></span><br><span class=line>&lt;#include "../common/header.ftl"></span><br><span class=line></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"wrapper"</span> <span class=attr>class</span>=<span class=string>"toggled"</span>></span></span><br><span class=line></span><br><span class=line>    &lt;#--边栏sidebar--></span><br><span class=line>    &lt;#include "../common/nav.ftl"></span><br><span class=line></span><br><span class=line>    &lt;#--主要内容content--></span><br><span class=line>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"page-content-wrapper"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container-fluid"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                    <span class=tag>&lt;<span class=name>form</span> <span class=attr>role</span>=<span class=string>"form"</span> <span class=attr>method</span>=<span class=string>"post"</span> <span class=attr>action</span>=<span class=string>"/sell/seller/product/save"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>label</span>></span>名称<span class=tag>&lt;/<span class=name>label</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>input</span> <span class=attr>name</span>=<span class=string>"productName"</span> <span class=attr>type</span>=<span class=string>"text"</span> <span class=attr>class</span>=<span class=string>"form-control"</span> <span class=attr>value</span>=<span class=string>"${(productInfo.productName)!''}"</span>/></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>label</span>></span>价格<span class=tag>&lt;/<span class=name>label</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>input</span> <span class=attr>name</span>=<span class=string>"productPrice"</span> <span class=attr>type</span>=<span class=string>"number"</span> <span class=attr>class</span>=<span class=string>"form-control"</span> <span class=attr>value</span>=<span class=string>"${(productInfo.productPrice)!''}"</span>/></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>label</span>></span>库存<span class=tag>&lt;/<span class=name>label</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>input</span> <span class=attr>name</span>=<span class=string>"productStock"</span> <span class=attr>type</span>=<span class=string>"number"</span> <span class=attr>class</span>=<span class=string>"form-control"</span> <span class=attr>value</span>=<span class=string>"${(productInfo.productStock)!''}"</span>/></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>label</span>></span>描述<span class=tag>&lt;/<span class=name>label</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>input</span> <span class=attr>name</span>=<span class=string>"productDescription"</span> <span class=attr>type</span>=<span class=string>"text"</span> <span class=attr>class</span>=<span class=string>"form-control"</span> <span class=attr>value</span>=<span class=string>"${(productInfo.productDescription)!''}"</span>/></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>label</span>></span>图片<span class=tag>&lt;/<span class=name>label</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>input</span> <span class=attr>name</span>=<span class=string>"productIcon"</span> <span class=attr>type</span>=<span class=string>"text"</span> <span class=attr>class</span>=<span class=string>"form-control"</span> <span class=attr>value</span>=<span class=string>"${(productInfo.productIcon)!''}"</span>/></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"form-group"</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>label</span>></span>类目<span class=tag>&lt;/<span class=name>label</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>select</span> <span class=attr>name</span>=<span class=string>"categoryType"</span> <span class=attr>class</span>=<span class=string>"form-control"</span>></span></span><br><span class=line>                                &lt;#list categoryList as category></span><br><span class=line>                                    <span class=tag>&lt;<span class=name>option</span> <span class=attr>value</span>=<span class=string>"${category.categoryType}"</span></span></span><br><span class=line><span class=tag>                                            &lt;#<span class=attr>if</span> (<span class=attr>productInfo.categoryType</span>)?? && <span class=attr>productInfo.categoryType</span> == <span class=string>category.categoryType</span>></span></span><br><span class=line>                                                selected</span><br><span class=line>                                            &lt;/#if></span><br><span class=line>                                    >${category.categoryName}</span><br><span class=line>                                    <span class=tag>&lt;/<span class=name>option</span>></span></span><br><span class=line>                                &lt;/#list></span><br><span class=line>                            <span class=tag>&lt;/<span class=name>select</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>&lt;#--                        <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>"hidden"</span> <span class=attr>name</span>=<span class=string>"productStatus"</span> <span class=attr>value</span>=<span class=string>"${(productInfo.productStatus)!0}"</span>></span>--></span><br><span class=line>                        <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>"hidden"</span> <span class=attr>name</span>=<span class=string>"productId"</span> <span class=attr>value</span>=<span class=string>"${(productInfo.productId)!''}"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>button</span> <span class=attr>type</span>=<span class=string>"submit"</span> <span class=attr>class</span>=<span class=string>"btn btn-default"</span>></span>提交<span class=tag>&lt;/<span class=name>button</span>></span></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>form</span>></span></span><br><span class=line>                <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>></span></span><br></pre></table></figure><h4 id=product-list-ftl><a class=headerlink href=#product-list-ftl title=product/list.ftl></a>product/list.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>></span></span><br><span class=line>&lt;#include "../common/header.ftl"></span><br><span class=line></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"wrapper"</span> <span class=attr>class</span>=<span class=string>"toggled"</span>></span></span><br><span class=line></span><br><span class=line>    &lt;#--边栏sidebar--></span><br><span class=line>    &lt;#include "../common/nav.ftl"></span><br><span class=line></span><br><span class=line>    &lt;#--主要内容content--></span><br><span class=line>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"page-content-wrapper"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container-fluid"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                    <span class=tag>&lt;<span class=name>table</span> <span class=attr>class</span>=<span class=string>"table table-bordered table-condensed"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>商品id<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>名称<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>图片<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>单价<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>库存<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>描述<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>类目<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>创建时间<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>修改时间<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span> <span class=attr>colspan</span>=<span class=string>"2"</span>></span>操作<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tbody</span>></span></span><br><span class=line></span><br><span class=line>                        &lt;#list productInfoPage.content as productInfo></span><br><span class=line>                            <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.productId}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.productName}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span><span class=tag>&lt;<span class=name>img</span> <span class=attr>height</span>=<span class=string>"100"</span> <span class=attr>width</span>=<span class=string>"100"</span> <span class=attr>src</span>=<span class=string>"${productInfo.productIcon}"</span> <span class=attr>alt</span>=<span class=string>""</span>></span><span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.productPrice}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.productStock}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.productDescription}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.categoryType}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.createTime}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${productInfo.updateTime}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/index?productId=${productInfo.productId}"</span>></span>修改<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span></span><br><span class=line>                                    &lt;#if productInfo.getProductStatusEnum().message == "上架"></span><br><span class=line>                                        <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/off_sale?productId=${productInfo.productId}"</span>></span>下架<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>                                    &lt;#else></span><br><span class=line>                                        <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/on_sale?productId=${productInfo.productId}"</span>></span>上架<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>                                    &lt;/#if></span><br><span class=line>                                <span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                            <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        &lt;/#list></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tbody</span>></span></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>table</span>></span></span><br><span class=line>                <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line></span><br><span class=line>                &lt;#--分页--></span><br><span class=line>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                    <span class=tag>&lt;<span class=name>ul</span> <span class=attr>class</span>=<span class=string>"pagination pull-right"</span>></span></span><br><span class=line>                        &lt;#if currentPage lte 1></span><br><span class=line>                            <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"disabled"</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span>></span>上一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                        &lt;#else></span><br><span class=line>                            <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/list?page=${currentPage - 1}&size=${size}"</span>></span>上一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                        &lt;/#if></span><br><span class=line></span><br><span class=line>                        &lt;#list 1..productInfoPage.getTotalPages() as index></span><br><span class=line>                            &lt;#if currentPage == index></span><br><span class=line>                                <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"disabled"</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span>></span>${index}<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                            &lt;#else></span><br><span class=line>                                <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/list?page=${index}&size=${size}"</span>></span>${index}<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                            &lt;/#if></span><br><span class=line>                        &lt;/#list></span><br><span class=line></span><br><span class=line>                        &lt;#if currentPage gte productInfoPage.getTotalPages()></span><br><span class=line>                            <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"disabled"</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span>></span>下一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                        &lt;#else></span><br><span class=line>                            <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/product/list?page=${currentPage + 1}&size=${size}"</span>></span>下一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                        &lt;/#if></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>ul</span>></span></span><br><span class=line>                <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>></span></span><br></pre></table></figure><h4 id=order-list-ftl><a class=headerlink href=#order-list-ftl title=order/list.ftl></a>order/list.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>></span></span><br><span class=line>&lt;#include "../common/header.ftl"></span><br><span class=line></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"wrapper"</span> <span class=attr>class</span>=<span class=string>"toggled"</span>></span></span><br><span class=line></span><br><span class=line>    &lt;#--边栏sidebar--></span><br><span class=line>    &lt;#include "../common/nav.ftl"></span><br><span class=line></span><br><span class=line>    &lt;#--主要内容content--></span><br><span class=line>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"page-content-wrapper"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container-fluid"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                    <span class=tag>&lt;<span class=name>table</span> <span class=attr>class</span>=<span class=string>"table table-bordered table-condensed"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>订单id<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>姓名<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>手机号<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>地址<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>金额<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>订单状态<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>支付状态<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>创建时间<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span> <span class=attr>colspan</span>=<span class=string>"2"</span>></span>操作<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tbody</span>></span></span><br><span class=line>                        &lt;#list orderDTOPage.content as orderDTO></span><br><span class=line>                            <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.orderId}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.buyerName}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.buyerPhone}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.buyerAddress}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.orderAmount}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.getOrderStatusEnum().msg}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.getPayStatusEnum().msg}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span>${orderDTO.createTime}<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/detail?orderId=${orderDTO.orderId}"</span>></span>详情<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>th</span>></span></span><br><span class=line>                                    &lt;#if orderDTO.getOrderStatusEnum().msg == "新订单"></span><br><span class=line>                                        <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/cancel?orderId=${orderDTO.orderId}"</span>></span>取消<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>                                    &lt;/#if></span><br><span class=line>                                <span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        &lt;/#list></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tbody</span>></span></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>table</span>></span></span><br><span class=line>                <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>ul</span> <span class=attr>class</span>=<span class=string>"pagination pull-right"</span>></span></span><br><span class=line>                    &lt;#if currentPage lte 1></span><br><span class=line>                        <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"disabled"</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span>></span>上一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                    &lt;#else ></span><br><span class=line>                        <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/list?page=${currentPage - 1}&size=${size}"</span>></span>上一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                    &lt;/#if></span><br><span class=line>                    &lt;#list 1..orderDTOPage.getTotalPages() as index></span><br><span class=line>                        &lt;#if currentPage == index></span><br><span class=line>                            <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"disabled"</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span>></span>${index}<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                        &lt;#else></span><br><span class=line>                            <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/list?page=${index}&size=${size}"</span>></span>${index}<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                        &lt;/#if></span><br><span class=line>                    &lt;/#list></span><br><span class=line>                    &lt;#if currentPage gte orderDTOPage.getTotalPages()></span><br><span class=line>                        <span class=tag>&lt;<span class=name>li</span> <span class=attr>class</span>=<span class=string>"disabled"</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"#"</span>></span>下一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                    &lt;#else ></span><br><span class=line>                        <span class=tag>&lt;<span class=name>li</span>></span><span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/list?page=${currentPage + 1}&size=${size}"</span>></span>下一页<span class=tag>&lt;/<span class=name>a</span>></span><span class=tag>&lt;/<span class=name>li</span>></span></span><br><span class=line>                    &lt;/#if></span><br><span class=line>                <span class=tag>&lt;/<span class=name>ul</span>></span></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>></span></span><br></pre></table></figure><h4 id=order-detail-ftl><a class=headerlink href=#order-detail-ftl title=order/detail.ftl></a>order/detail.ftl</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>></span></span><br><span class=line>&lt;#include "../common/header.ftl"></span><br><span class=line></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"wrapper"</span> <span class=attr>class</span>=<span class=string>"toggled"</span>></span></span><br><span class=line></span><br><span class=line>    &lt;#--边栏sidebar--></span><br><span class=line>    &lt;#include "../common/nav.ftl"></span><br><span class=line></span><br><span class=line>    &lt;#--主要内容content--></span><br><span class=line>    <span class=tag>&lt;<span class=name>div</span> <span class=attr>id</span>=<span class=string>"page-content-wrapper"</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"container-fluid"</span>></span></span><br><span class=line>            <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"row clearfix"</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-4 column"</span>></span></span><br><span class=line>                    <span class=tag>&lt;<span class=name>table</span> <span class=attr>class</span>=<span class=string>"table table-bordered"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>订单id<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>订单总金额<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tbody</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>td</span>></span>${orderDTO.orderId}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>td</span>></span>${orderDTO.orderAmount}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tbody</span>></span></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>table</span>></span></span><br><span class=line>                <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                    <span class=tag>&lt;<span class=name>table</span> <span class=attr>class</span>=<span class=string>"table table-bordered"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>商品id<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>商品名称<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>价格<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>数量<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                            <span class=tag>&lt;<span class=name>th</span>></span>总金额<span class=tag>&lt;/<span class=name>th</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>thead</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>tbody</span>></span></span><br><span class=line>                        &lt;#list orderDTO.orderDetailList as orderDetail></span><br><span class=line>                            <span class=tag>&lt;<span class=name>tr</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${orderDetail.productId}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${orderDetail.productName}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${orderDetail.productPrice}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${orderDetail.productQuantity}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                                <span class=tag>&lt;<span class=name>td</span>></span>${orderDetail.productPrice * orderDetail.productQuantity}<span class=tag>&lt;/<span class=name>td</span>></span></span><br><span class=line>                            <span class=tag>&lt;/<span class=name>tr</span>></span></span><br><span class=line>                        &lt;/#list></span><br><span class=line>                        <span class=tag>&lt;/<span class=name>tbody</span>></span></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>table</span>></span></span><br><span class=line>                <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                &lt;#if orderDTO.getOrderStatusEnum().msg == "新订单"></span><br><span class=line>                    <span class=tag>&lt;<span class=name>div</span> <span class=attr>class</span>=<span class=string>"col-md-12 column"</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/finish?orderId=${orderDTO.orderId}"</span> <span class=attr>type</span>=<span class=string>"button"</span></span></span><br><span class=line><span class=tag>                           <span class=attr>class</span>=<span class=string>"btn btn-default btn-primary"</span>></span>完结订单<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>                        <span class=tag>&lt;<span class=name>a</span> <span class=attr>href</span>=<span class=string>"/sell/seller/order/cancel?orderId=${orderDTO.orderId}"</span> <span class=attr>type</span>=<span class=string>"button"</span></span></span><br><span class=line><span class=tag>                           <span class=attr>class</span>=<span class=string>"btn btn-default btn-danger"</span>></span>取消订单<span class=tag>&lt;/<span class=name>a</span>></span></span><br><span class=line>                    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>                &lt;/#if></span><br><span class=line>            <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>        <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>div</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>></span></span><br></pre></table></figure><h3 id=CSS样式><a class=headerlink href=#CSS样式 title=CSS样式></a>CSS样式</h3><h4 id=static-css><a class=headerlink href=#static-css title=static/css></a>static/css</h4><h5 id=style-css><a class=headerlink href=#style-css title=style.css></a>style.css</h5><figure class="highlight css"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br><span class=line>183</span><br><span class=line>184</span><br><span class=line>185</span><br><span class=line>186</span><br><span class=line>187</span><br><span class=line>188</span><br><span class=line>189</span><br><span class=line>190</span><br><span class=line>191</span><br><span class=line>192</span><br><span class=line>193</span><br><span class=line>194</span><br><span class=line>195</span><br><span class=line>196</span><br><span class=line>197</span><br><span class=line>198</span><br><span class=line>199</span><br><span class=line>200</span><br><span class=line>201</span><br><span class=line>202</span><br><span class=line>203</span><br><span class=line>204</span><br><span class=line>205</span><br><span class=line>206</span><br><span class=line>207</span><br><span class=line>208</span><br><span class=line>209</span><br><span class=line>210</span><br><span class=line>211</span><br><span class=line>212</span><br><span class=line>213</span><br><span class=line>214</span><br><span class=line>215</span><br><span class=line>216</span><br><span class=line>217</span><br><span class=line>218</span><br><span class=line>219</span><br><span class=line>220</span><br><span class=line>221</span><br><span class=line>222</span><br><span class=line>223</span><br><span class=line>224</span><br><span class=line>225</span><br><span class=line>226</span><br><span class=line>227</span><br><span class=line>228</span><br><span class=line>229</span><br><span class=line>230</span><br><span class=line>231</span><br><span class=line>232</span><br><span class=line>233</span><br><span class=line>234</span><br><span class=line>235</span><br><span class=line>236</span><br><span class=line>237</span><br><span class=line>238</span><br><span class=line>239</span><br><span class=line>240</span><br><span class=line>241</span><br><span class=line>242</span><br><span class=line>243</span><br><span class=line>244</span><br><span class=line>245</span><br><span class=line>246</span><br><span class=line>247</span><br><span class=line>248</span><br><span class=line>249</span><br><span class=line>250</span><br><span class=line>251</span><br><span class=line>252</span><br><span class=line>253</span><br><span class=line>254</span><br><span class=line>255</span><br><span class=line>256</span><br><span class=line>257</span><br><span class=line>258</span><br><span class=line>259</span><br><span class=line>260</span><br><span class=line>261</span><br><span class=line>262</span><br><span class=line>263</span><br><span class=line>264</span><br></pre><td class=code><pre><span class=line><span class=selector-tag>body</span> {</span><br><span class=line>  <span class=attribute>position</span>: relative;</span><br><span class=line>  <span class=attribute>overflow-x</span>: hidden;</span><br><span class=line>}</span><br><span class=line><span class=selector-tag>body</span>,</span><br><span class=line><span class=selector-tag>html</span> {</span><br><span class=line>  <span class=attribute>height</span>: <span class=number>100%</span>;</span><br><span class=line>  <span class=comment>/*background-color: #583e7e;*/</span></span><br><span class=line>}</span><br><span class=line><span class=selector-class>.nav</span> <span class=selector-class>.open</span> > <span class=selector-tag>a</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: transparent;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.nav</span> <span class=selector-class>.open</span> > <span class=selector-tag>a</span><span class=selector-pseudo>:hover</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: transparent;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.nav</span> <span class=selector-class>.open</span> > <span class=selector-tag>a</span><span class=selector-pseudo>:focus</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: transparent;</span><br><span class=line>}</span><br><span class=line><span class=comment>/*-------------------------------*/</span></span><br><span class=line><span class=comment>/*           Wrappers            */</span></span><br><span class=line><span class=comment>/*-------------------------------*/</span></span><br><span class=line><span class=selector-id>#wrapper</span> {</span><br><span class=line>  -moz-<span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>  -o-<span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>  <span class=attribute>padding-left</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>}</span><br><span class=line><span class=selector-id>#wrapper</span><span class=selector-class>.toggled</span> {</span><br><span class=line>  <span class=attribute>padding-left</span>: <span class=number>180px</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-id>#wrapper</span><span class=selector-class>.toggled</span> <span class=selector-id>#sidebar-wrapper</span> {</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>180px</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-id>#sidebar-wrapper</span> {</span><br><span class=line>  -moz-<span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>  -o-<span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>  <span class=attribute>background</span>: <span class=number>#1a1a1a</span>;</span><br><span class=line>  <span class=attribute>height</span>: <span class=number>100%</span>;</span><br><span class=line>  <span class=attribute>left</span>: <span class=number>220px</span>;</span><br><span class=line>  <span class=attribute>margin-left</span>: -<span class=number>220px</span>;</span><br><span class=line>  <span class=attribute>overflow-x</span>: hidden;</span><br><span class=line>  <span class=attribute>overflow-y</span>: auto;</span><br><span class=line>  <span class=attribute>transition</span>: all <span class=number>0.5s</span> ease;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>z-index</span>: <span class=number>1000</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-id>#sidebar-wrapper</span>::-webkit-scrollbar {</span><br><span class=line>  <span class=attribute>display</span>: none;</span><br><span class=line>}</span><br><span class=line><span class=selector-id>#page-content-wrapper</span> {</span><br><span class=line>  <span class=attribute>padding-top</span>: <span class=number>70px</span>;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100%</span>;</span><br><span class=line>}</span><br><span class=line><span class=comment>/*-------------------------------*/</span></span><br><span class=line><span class=comment>/*     Sidebar nav styles        */</span></span><br><span class=line><span class=comment>/*-------------------------------*/</span></span><br><span class=line><span class=selector-class>.sidebar-nav</span> {</span><br><span class=line>  <span class=attribute>list-style</span>: none;</span><br><span class=line>  <span class=attribute>margin</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>padding</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>position</span>: absolute;</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>220px</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span> {</span><br><span class=line>  <span class=attribute>display</span>: inline-block;</span><br><span class=line>  <span class=attribute>line-height</span>: <span class=number>20px</span>;</span><br><span class=line>  <span class=attribute>position</span>: relative;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#1c1c1c</span>;</span><br><span class=line>  <span class=attribute>content</span>: <span class=string>''</span>;</span><br><span class=line>  <span class=attribute>height</span>: <span class=number>100%</span>;</span><br><span class=line>  <span class=attribute>left</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>position</span>: absolute;</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>0</span>;</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: width <span class=number>0.2s</span> ease-in;</span><br><span class=line>  <span class=attribute>transition</span>: width <span class=number>0.2s</span> ease-in;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>3px</span>;</span><br><span class=line>  <span class=attribute>z-index</span>: -<span class=number>1</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:first-child</span> <span class=selector-tag>a</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#1a1a1a</span>;</span><br><span class=line>  <span class=attribute>color</span>: <span class=number>#ffffff</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>2</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#402d5c</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>3</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#4c366d</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>4</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#583e7e</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>5</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#64468f</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>6</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#704fa0</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>7</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#7c5aae</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>8</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#8a6cb6</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:nth-child</span>(<span class=number>9</span>)<span class=selector-pseudo>:before</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#987dbf</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-pseudo>:hover</span><span class=selector-pseudo>:before</span> {</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: width <span class=number>0.2s</span> ease-in;</span><br><span class=line>  <span class=attribute>transition</span>: width <span class=number>0.2s</span> ease-in;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span> <span class=selector-tag>a</span> {</span><br><span class=line>  <span class=attribute>color</span>: <span class=number>#dddddd</span>;</span><br><span class=line>  <span class=attribute>display</span>: block;</span><br><span class=line>  <span class=attribute>padding</span>: <span class=number>10px</span> <span class=number>15px</span> <span class=number>10px</span> <span class=number>30px</span>;</span><br><span class=line>  <span class=attribute>text-decoration</span>: none;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-class>.open</span><span class=selector-pseudo>:hover</span> before {</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: width <span class=number>0.2s</span> ease-in;</span><br><span class=line>  <span class=attribute>transition</span>: width <span class=number>0.2s</span> ease-in;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-class>.dropdown-menu</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#222222</span>;</span><br><span class=line>  <span class=attribute>border-radius</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>border</span>: none;</span><br><span class=line>  <span class=attribute>box-shadow</span>: none;</span><br><span class=line>  <span class=attribute>margin</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>padding</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>position</span>: relative;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span> <span class=selector-tag>a</span><span class=selector-pseudo>:hover</span>,</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span> <span class=selector-tag>a</span><span class=selector-pseudo>:active</span>,</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span> <span class=selector-tag>a</span><span class=selector-pseudo>:focus</span>,</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-class>.open</span> <span class=selector-tag>a</span><span class=selector-pseudo>:hover</span>,</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-class>.open</span> <span class=selector-tag>a</span><span class=selector-pseudo>:active</span>,</span><br><span class=line><span class=selector-class>.sidebar-nav</span> <span class=selector-tag>li</span><span class=selector-class>.open</span> <span class=selector-tag>a</span><span class=selector-pseudo>:focus</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: transparent;</span><br><span class=line>  <span class=attribute>color</span>: <span class=number>#ffffff</span>;</span><br><span class=line>  <span class=attribute>text-decoration</span>: none;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.sidebar-nav</span> > <span class=selector-class>.sidebar-brand</span> {</span><br><span class=line>  <span class=attribute>font-size</span>: <span class=number>20px</span>;</span><br><span class=line>  <span class=attribute>height</span>: <span class=number>65px</span>;</span><br><span class=line>  <span class=attribute>line-height</span>: <span class=number>44px</span>;</span><br><span class=line>}</span><br><span class=line><span class=comment>/*-------------------------------*/</span></span><br><span class=line><span class=comment>/*       Hamburger-Cross         */</span></span><br><span class=line><span class=comment>/*-------------------------------*/</span></span><br><span class=line><span class=selector-class>.hamburger</span> {</span><br><span class=line>  <span class=attribute>background</span>: transparent;</span><br><span class=line>  <span class=attribute>border</span>: none;</span><br><span class=line>  <span class=attribute>display</span>: block;</span><br><span class=line>  <span class=attribute>height</span>: <span class=number>32px</span>;</span><br><span class=line>  <span class=attribute>margin-left</span>: <span class=number>15px</span>;</span><br><span class=line>  <span class=attribute>position</span>: fixed;</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>20px</span>;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>32px</span>;</span><br><span class=line>  <span class=attribute>z-index</span>: <span class=number>999</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-pseudo>:hover</span> {</span><br><span class=line>  <span class=attribute>outline</span>: none;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-pseudo>:focus</span> {</span><br><span class=line>  <span class=attribute>outline</span>: none;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-pseudo>:active</span> {</span><br><span class=line>  <span class=attribute>outline</span>: none;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span><span class=selector-pseudo>:before</span> {</span><br><span class=line>  -webkit-<span class=attribute>transform</span>: <span class=built_in>translate3d</span>(<span class=number>0</span>, <span class=number>0</span>, <span class=number>0</span>);</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>color</span>: <span class=number>#ffffff</span>;</span><br><span class=line>  <span class=attribute>content</span>: <span class=string>''</span>;</span><br><span class=line>  <span class=attribute>display</span>: block;</span><br><span class=line>  <span class=attribute>font-size</span>: <span class=number>14px</span>;</span><br><span class=line>  <span class=attribute>line-height</span>: <span class=number>32px</span>;</span><br><span class=line>  <span class=attribute>opacity</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>text-align</span>: center;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100px</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span><span class=selector-pseudo>:hover</span> before {</span><br><span class=line>  -webkit-<span class=attribute>transform</span>: <span class=built_in>translate3d</span>(-<span class=number>100px</span>, <span class=number>0</span>, <span class=number>0</span>);</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>display</span>: block;</span><br><span class=line>  <span class=attribute>opacity</span>: <span class=number>1</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span><span class=selector-pseudo>:hover</span> <span class=selector-class>.hamb-top</span> {</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>0</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span><span class=selector-pseudo>:hover</span> <span class=selector-class>.hamb-bottom</span> {</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>bottom</span>: <span class=number>0</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span> <span class=selector-class>.hamb-top</span> {</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=built_in>rgba</span>(<span class=number>255</span>, <span class=number>255</span>, <span class=number>255</span>, <span class=number>0.7</span>);</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>5px</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span> <span class=selector-class>.hamb-middle</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=built_in>rgba</span>(<span class=number>255</span>, <span class=number>255</span>, <span class=number>255</span>, <span class=number>0.7</span>);</span><br><span class=line>  <span class=attribute>margin-top</span>: -<span class=number>2px</span>;</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>50%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span> <span class=selector-class>.hamb-bottom</span> {</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=built_in>rgba</span>(<span class=number>255</span>, <span class=number>255</span>, <span class=number>255</span>, <span class=number>0.7</span>);</span><br><span class=line>  <span class=attribute>bottom</span>: <span class=number>5px</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span> <span class=selector-class>.hamb-top</span>,</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span> <span class=selector-class>.hamb-middle</span>,</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-closed</span> <span class=selector-class>.hamb-bottom</span>,</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span> <span class=selector-class>.hamb-top</span>,</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span> <span class=selector-class>.hamb-middle</span>,</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span> <span class=selector-class>.hamb-bottom</span> {</span><br><span class=line>  <span class=attribute>height</span>: <span class=number>4px</span>;</span><br><span class=line>  <span class=attribute>left</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>position</span>: absolute;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span> <span class=selector-class>.hamb-top</span> {</span><br><span class=line>  -webkit-<span class=attribute>transform</span>: <span class=built_in>rotate</span>(<span class=number>45deg</span>);</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: -webkit-transform <span class=number>0.2s</span> <span class=built_in>cubic-bezier</span>(<span class=number>0.73</span>, <span class=number>1</span>, <span class=number>0.28</span>, <span class=number>0.08</span>);</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#ffffff</span>;</span><br><span class=line>  <span class=attribute>margin-top</span>: -<span class=number>2px</span>;</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>50%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span> <span class=selector-class>.hamb-middle</span> {</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#ffffff</span>;</span><br><span class=line>  <span class=attribute>display</span>: none;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span> <span class=selector-class>.hamb-bottom</span> {</span><br><span class=line>  -webkit-<span class=attribute>transform</span>: <span class=built_in>rotate</span>(-<span class=number>45deg</span>);</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: -webkit-transform <span class=number>0.2s</span> <span class=built_in>cubic-bezier</span>(<span class=number>0.73</span>, <span class=number>1</span>, <span class=number>0.28</span>, <span class=number>0.08</span>);</span><br><span class=line>  <span class=attribute>background-color</span>: <span class=number>#ffffff</span>;</span><br><span class=line>  <span class=attribute>margin-top</span>: -<span class=number>2px</span>;</span><br><span class=line>  <span class=attribute>top</span>: <span class=number>50%</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span><span class=selector-pseudo>:before</span> {</span><br><span class=line>  -webkit-<span class=attribute>transform</span>: <span class=built_in>translate3d</span>(<span class=number>0</span>, <span class=number>0</span>, <span class=number>0</span>);</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>color</span>: <span class=number>#ffffff</span>;</span><br><span class=line>  <span class=attribute>content</span>: <span class=string>''</span>;</span><br><span class=line>  <span class=attribute>display</span>: block;</span><br><span class=line>  <span class=attribute>font-size</span>: <span class=number>14px</span>;</span><br><span class=line>  <span class=attribute>line-height</span>: <span class=number>32px</span>;</span><br><span class=line>  <span class=attribute>opacity</span>: <span class=number>0</span>;</span><br><span class=line>  <span class=attribute>text-align</span>: center;</span><br><span class=line>  <span class=attribute>width</span>: <span class=number>100px</span>;</span><br><span class=line>}</span><br><span class=line><span class=selector-class>.hamburger</span><span class=selector-class>.is-open</span><span class=selector-pseudo>:hover</span> before {</span><br><span class=line>  -webkit-<span class=attribute>transform</span>: <span class=built_in>translate3d</span>(-<span class=number>100px</span>, <span class=number>0</span>, <span class=number>0</span>);</span><br><span class=line>  -webkit-<span class=attribute>transition</span>: all <span class=number>0.35s</span> ease-in-out;</span><br><span class=line>  <span class=attribute>display</span>: block;</span><br><span class=line>  <span class=attribute>opacity</span>: <span class=number>1</span>;</span><br><span class=line>}</span><br></pre></table></figure><h3 id=Thymeleaf><a class=headerlink href=#Thymeleaf title=Thymeleaf></a>Thymeleaf</h3><h4 id=pom-xml-1><a class=headerlink href=#pom-xml-1 title=pom.xml></a>pom.xml</h4><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-thymeleaf<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line></span><br><span class=line>...</span><br><span class=line></span><br><span class=line><span class=tag>&lt;<span class=name>resources</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>resource</span>></span></span><br><span class=line>        <span class=tag>&lt;<span class=name>directory</span>></span>src/main/resources<span class=tag>&lt;/<span class=name>directory</span>></span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>resource</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>resources</span>></span></span><br></pre></table></figure><h4 id=index-html><a class=headerlink href=#index-html title=index.html></a>index.html</h4><figure class="highlight htmlbars"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=language-xml><span class=meta>&lt;!DOCTYPE <span class=keyword>html</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>html</span> <span class=attr>xmlns</span>=<span class=string>"http://www.w3.org/1999/xhtml"</span></span></span></span><br><span class=line><span class=tag><span class=language-xml>      <span class=attr>xmlns:th</span>=<span class=string>"http://www.thymeleaf.org"</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>head</span> <span class=attr>lang</span>=<span class=string>"en"</span>></span></span></span><br><span class=line><span class=language-xml>    <span class=tag>&lt;<span class=name>meta</span> <span class=attr>charset</span>=<span class=string>"UTF-8"</span>/></span></span></span><br><span class=line><span class=language-xml>    <span class=tag>&lt;<span class=name>title</span>></span><span class=tag>&lt;/<span class=name>title</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>head</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>body</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;<span class=name>h1</span> <span class=attr>th:text</span>=<span class=string>"${host}"</span>></span>Hello World<span class=tag>&lt;/<span class=name>h1</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>body</span>></span></span></span><br><span class=line><span class=language-xml><span class=tag>&lt;/<span class=name>html</span>></span></span></span><br></pre></table></figure><blockquote><p>注意：模板的位置可以直接放在src/main/resources/templates/目录下。</blockquote><p><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwjifycyj30vi14cwo5.jpg><h4 id=application-properties-1><a class=headerlink href=#application-properties-1 title=application.properties></a>application.properties</h4><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br></pre><td class=code><pre><span class=line><span class=string>spring.http.encoding.force=true</span></span><br><span class=line><span class=string>spring.http.encoding.charset=UTF-8</span></span><br><span class=line><span class=string>spring.http.encoding.enabled=true</span></span><br><span class=line><span class=string>server.tomcat.uri-encoding=UTF-8</span></span><br><span class=line></span><br><span class=line><span class=comment># Enable template caching.</span></span><br><span class=line><span class=string>spring.thymeleaf.cache=true</span></span><br><span class=line><span class=comment># Check that the templates location exists.</span></span><br><span class=line><span class=string>spring.thymeleaf.check-template-location=true</span></span><br><span class=line><span class=comment># Content-Type value.</span></span><br><span class=line><span class=string>spring.thymeleaf.content-type=text/html</span></span><br><span class=line><span class=comment># Enable MVC Thymeleaf view resolution.</span></span><br><span class=line><span class=string>spring.thymeleaf.enabled=true</span></span><br><span class=line><span class=comment># Template encoding.</span></span><br><span class=line><span class=string>spring.thymeleaf.encoding=UTF-8</span></span><br><span class=line><span class=comment># Comma-separated list of view names that should be excluded from resolution.</span></span><br><span class=line><span class=string>spring.thymeleaf.excluded-view-names=</span></span><br><span class=line><span class=comment># Template mode to be applied to templates. See also StandardTemplateModeHandlers.</span></span><br><span class=line><span class=string>spring.thymeleaf.mode=HTML5</span></span><br><span class=line><span class=comment># Prefix that gets prepended to view names when building a URL.</span></span><br><span class=line><span class=string>spring.thymeleaf.prefix=classpath:/templates/</span></span><br><span class=line><span class=comment># Suffix that gets appended to view names when building a URL.</span></span><br><span class=line><span class=string>spring.thymeleaf.suffix=.html</span></span><br></pre></table></figure><h4 id=ThymeleafTest-java><a class=headerlink href=#ThymeleafTest-java title=ThymeleafTest.java></a>ThymeleafTest.java</h4><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.controller;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Controller;</span><br><span class=line><span class=keyword>import</span> org.springframework.ui.ModelMap;</span><br><span class=line><span class=keyword>import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=line></span><br><span class=line><span class=meta>@Controller</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">ThymeleafTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@RequestMapping("/")</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">index</span><span class=params>(ModelMap map)</span> {</span><br><span class=line>        map.addAttribute(<span class=string>"host"</span>, <span class=string>"http://www.mindex.com"</span>);</span><br><span class=line>        <span class=keyword>return</span> <span class=string>"index"</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><p>运行结果如下：<br><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwk4t00xj30zk0bcq6o.jpg><h2 id=数据库操作><a class=headerlink href=#数据库操作 title=数据库操作></a>数据库操作</h2><h3 id=JDBC方式-JdbcTemplate><a title="JDBC方式 - JdbcTemplate" class=headerlink href=#JDBC方式-JdbcTemplate></a>JDBC方式 - JdbcTemplate</h3><p>引入POM依赖<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-jdbc<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>mysql<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>mysql-connector-java<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>version</span>></span>5.1.21<span class=tag>&lt;/<span class=name>version</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br></pre></table></figure><p>修改配置文件<code>application.properties</code><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=string>spring.datasource.url=jdbc:mysql://localhost:3306/test</span></span><br><span class=line><span class=string>spring.datasource.username=root</span></span><br><span class=line><span class=string>spring.datasource.password=welcome</span></span><br><span class=line><span class=string>spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span></span><br></pre></table></figure><p>Service接口：<code>UserService.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.service;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">UserService</span> {</span><br><span class=line></span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">create</span><span class=params>(String name, Integer age)</span>;</span><br><span class=line>    </span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">deleteByName</span><span class=params>(String name)</span>;</span><br><span class=line>    </span><br><span class=line>    Integer <span class="title function_">getAllUsers</span><span class=params>()</span>;</span><br><span class=line>    </span><br><span class=line>    <span class=keyword>void</span> <span class="title function_">deleteAllUsers</span><span class=params>()</span>;</span><br><span class=line>}</span><br></pre></table></figure><p>Service实现：<code>UserServiceImpl.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.service.UserService;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Service;</span><br><span class=line></span><br><span class=line><span class=meta>@Service</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">UserServiceImpl</span> <span class=keyword>implements</span> <span class="title class_">UserService</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> JdbcTemplate jdbcTemplate;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">create</span><span class=params>(String name, Integer age)</span> {</span><br><span class=line>        jdbcTemplate.update(<span class=string>"INSERT INTO user (name, age) VALUES (?,?);"</span>, name, age);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">deleteByName</span><span class=params>(String name)</span> {</span><br><span class=line>        jdbcTemplate.update(<span class=string>"delete from USER where NAME = ?"</span>, name);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> Integer <span class="title function_">getAllUsers</span><span class=params>()</span> {</span><br><span class=line>        <span class=keyword>return</span> jdbcTemplate.queryForObject(<span class=string>"select count(1) from USER"</span>, Integer.class);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">deleteAllUsers</span><span class=params>()</span> {</span><br><span class=line>        jdbcTemplate.update(<span class=string>"delete from USER"</span>);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><p>单元测试：<code>UserServiceImplTest.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.service.UserService;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">UserServiceImplTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> UserService userService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">create</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        <span class=comment>// 插入5个用户</span></span><br><span class=line>        userService.create(<span class=string>"a"</span>, <span class=number>1</span>);</span><br><span class=line>        userService.create(<span class=string>"b"</span>, <span class=number>2</span>);</span><br><span class=line>        userService.create(<span class=string>"c"</span>, <span class=number>3</span>);</span><br><span class=line>        userService.create(<span class=string>"d"</span>, <span class=number>4</span>);</span><br><span class=line>        userService.create(<span class=string>"e"</span>, <span class=number>5</span>);</span><br><span class=line></span><br><span class=line>        Assert.assertEquals(<span class=number>5</span>, userService.getAllUsers().intValue());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">deleteByName</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        userService.deleteByName(<span class=string>"b"</span>);</span><br><span class=line>        userService.deleteByName(<span class=string>"c"</span>);</span><br><span class=line></span><br><span class=line>        Assert.assertEquals(<span class=number>3</span>, userService.getAllUsers().intValue());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">getAllUsers</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">deleteAllUsers</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=JPA方式-Spring-data-jpa><a title="JPA方式 - Spring-data-jpa" class=headerlink href=#JPA方式-Spring-data-jpa></a>JPA方式 - Spring-data-jpa</h3><p>引入pom依赖：<code>pom.xml</code><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-data-jpa<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br></pre></table></figure><p>在<code>application.properties</code>创建数据库连接信息。<figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=string>spring.datasource.url=jdbc:mysql://localhost:3306/test</span></span><br><span class=line><span class=string>spring.datasource.username=root</span></span><br><span class=line><span class=string>spring.datasource.password=123qweasd</span></span><br><span class=line><span class=string>spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span></span><br><span class=line><span class=string>spring.jpa.properties.hibernate.hbm2ddl.auto=create-drop</span></span><br></pre></table></figure><p><code>spring.jpa.properties.hibernate.hbm2ddl.auto</code>是hibernate的配置属性，其主要作用是：自动创建、更新、验证数据库表结构。该参数的几种配置如下：<ul><li><code>create</code>：每次加载hibernate时都会删除上一次的生成的表，然后根据你的model类再重新来生成新表，哪怕两次没有任何改变也要这样执行，这就是导致数据库表数据丢失的一个重要原因。<li><code>create-drop</code>：每次加载hibernate时根据model类生成表，但是sessionFactory一关闭,表就自动删除。<li><code>update</code>：最常用的属性，第一次加载hibernate时根据model类会自动建立起表的结构（前提是先建立好数据库），以后加载hibernate时根据model类自动更新表结构，即使表结构改变了但表中的行仍然存在不会删除以前的行。要注意的是当部署到服务器后，表结构是不会被马上建立起来的，是要等应用第一次运行起来后才会。<li><code>validate</code>：每次加载hibernate时，验证创建数据库表结构，只会和数据库中的表进行比较，不会创建新表，但是会插入新值。</ul><h4 id=实体类（Entity）><a class=headerlink href=#实体类（Entity） title=实体类（Entity）></a>实体类（Entity）</h4><p>创建一个User实体，包含id（主键）、name（姓名）、age（年龄）属性，通过ORM框架其会被映射到数据库表中，由于配置了<code>hibernate.hbm2ddl.auto</code>，在应用启动的时候框架会自动去数据库中创建对应的表。<h5 id=User><a class=headerlink href=#User title=User></a>User</h5><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.entities;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> javax.persistence.Column;</span><br><span class=line><span class=keyword>import</span> javax.persistence.Entity;</span><br><span class=line><span class=keyword>import</span> javax.persistence.GeneratedValue;</span><br><span class=line><span class=keyword>import</span> javax.persistence.Id;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@Entity</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">User</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Id</span></span><br><span class=line>    <span class=meta>@GeneratedValue</span></span><br><span class=line>    <span class=keyword>private</span> Long id;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Column(nullable = false)</span></span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Column(nullable = false)</span></span><br><span class=line>    <span class=keyword>private</span> Integer age;</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">User</span><span class=params>(String name, Integer age)</span> {</span><br><span class=line>        <span class=built_in>this</span>.name = name;</span><br><span class=line>        <span class=built_in>this</span>.age = age;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>public</span> <span class="title function_">User</span><span class=params>()</span> {</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h4 id=数据访问接口（Repository）><a class=headerlink href=#数据访问接口（Repository） title=数据访问接口（Repository）></a>数据访问接口（Repository）</h4><h5 id=UserRepository><a class=headerlink href=#UserRepository title=UserRepository></a>UserRepository</h5><p>下面针对User实体创建对应的Repository接口实现对该实体的数据访问，如下代码：<code>UserRepository.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.repository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.entities.User;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.jpa.repository.Query;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.repository.query.Param;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">UserRepository</span> <span class=keyword>extends</span> <span class="title class_">JpaRepository</span>&lt;User, Long> {</span><br><span class=line></span><br><span class=line>    User <span class="title function_">findByName</span><span class=params>(String name)</span>;</span><br><span class=line></span><br><span class=line>    User <span class="title function_">findByNameAndAge</span><span class=params>(String name, Integer age)</span>;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Query("from User u where u.name=:name")</span></span><br><span class=line>    User <span class="title function_">findUser</span><span class=params>(<span class=meta>@Param("name")</span> String name)</span>;</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><p>在Spring-data-jpa中，只需要编写类似上面这样的接口就可实现数据访问。不再像我们以往编写了接口时候还需要自己编写接口实现类，直接减少了我们的文件清单。<p>下面对上面的<code>UserRepository</code>做一些解释，该接口继承自<code>JpaRepository</code>，通过查看<code>JpaRepository</code>接口的<a href=https://docs.spring.io/spring-data/data-jpa/docs/current/api/ rel=noopener target=_blank>API</a>文档，可以看到该接口本身已经实现了创建（save）、更新（save）、删除（delete）、查询（findAll、findOne）等基本操作的函数，因此对于这些基础操作的数据访问就不需要开发者再自己定义。<p>在我们实际开发中，<code>JpaRepository</code>接口定义的接口往往还不够或者性能不够优化，我们需要进一步实现更复杂一些的查询或操作。由于本文重点在spring boot中整合spring-data-jpa，在这里先抛砖引玉简单介绍一下spring-data-jpa中让我们兴奋的功能，后续再单独开篇讲一下spring-data-jpa中的常见使用。<p>在上例中，我们可以看到下面两个函数：<ul><li><code>User findByName(String name)</code><li><code>User findByNameAndAge(String name, Integer age)</code></ul><p>它们分别实现了按name查询User实体和按name和age查询User实体，可以看到我们这里没有任何类SQL语句就完成了两个条件查询方法。这就是Spring-data-jpa的一大特性：<strong>通过解析方法名创建查询</strong>。<p>除了通过解析方法名来创建查询外，它也提供通过使用@Query 注解来创建查询，您只需要编写JPQL语句，并通过类似“:name”来映射@Param指定的参数，就像例子中的第三个findUser函数一样。<blockquote><p>Spring-data-jpa的能力远不止本文提到的这些，由于本文主要以整合介绍为主，对于Spring-data-jpa的使用只是介绍了常见的使用方式。</blockquote><h4 id=单元测试><a class=headerlink href=#单元测试 title=单元测试></a>单元测试</h4><h5 id=UserRepositoryTest><a class=headerlink href=#UserRepositoryTest title=UserRepositoryTest></a>UserRepositoryTest</h5><p>在完成了上面的数据访问接口之后，按照惯例就是编写对应的单元测试来验证编写的内容是否正确。这里就不多做介绍，主要通过数据操作和查询来反复验证操作的正确性。<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.repository;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.entities.User;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class=line></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=meta>@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">UserRepositoryTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> UserRepository userRepository;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">test</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        <span class=comment>// 创建10条记录</span></span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"AAA"</span>, <span class=number>10</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"BBB"</span>, <span class=number>20</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"CCC"</span>, <span class=number>30</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"DDD"</span>, <span class=number>40</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"EEE"</span>, <span class=number>50</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"FFF"</span>, <span class=number>60</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"GGG"</span>, <span class=number>70</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"HHH"</span>, <span class=number>80</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"III"</span>, <span class=number>90</span>));</span><br><span class=line>        userRepository.save(<span class=keyword>new</span> <span class="title class_">User</span>(<span class=string>"JJJ"</span>, <span class=number>100</span>));</span><br><span class=line></span><br><span class=line>        <span class=comment>// 测试findAll, 查询所有记录</span></span><br><span class=line>        Assert.assertEquals(<span class=number>10</span>, userRepository.findAll().size());</span><br><span class=line></span><br><span class=line>        <span class=comment>// 测试findByName, 查询姓名为FFF的User</span></span><br><span class=line>        Assert.assertEquals(<span class=number>60</span>, userRepository.findByName(<span class=string>"FFF"</span>).getAge().longValue());</span><br><span class=line></span><br><span class=line>        <span class=comment>// 测试findUser, 查询姓名为FFF的User</span></span><br><span class=line>        Assert.assertEquals(<span class=number>60</span>, userRepository.findUser(<span class=string>"FFF"</span>).getAge().longValue());</span><br><span class=line></span><br><span class=line>        <span class=comment>// 测试findByNameAndAge, 查询姓名为FFF并且年龄为60的User</span></span><br><span class=line>        Assert.assertEquals(<span class=string>"FFF"</span>, userRepository.findByNameAndAge(<span class=string>"FFF"</span>, <span class=number>60</span>).getName());</span><br><span class=line></span><br><span class=line>        <span class=comment>// 测试删除姓名为AAA的User</span></span><br><span class=line>        userRepository.delete(userRepository.findByName(<span class=string>"AAA"</span>));</span><br><span class=line></span><br><span class=line>        <span class=comment>// 测试findAll, 查询所有记录, 验证上面的删除是否成功</span></span><br><span class=line>        Assert.assertEquals(<span class=number>9</span>, userRepository.findAll().size());</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><h2 id=集成Redis><a class=headerlink href=#集成Redis title=集成Redis></a>集成Redis</h2><h3 id=手动配置集成Redis><a class=headerlink href=#手动配置集成Redis title=手动配置集成Redis></a>手动配置集成Redis</h3><p>引入POM依赖：<code>pom.xml</code><figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=comment>&lt;!--此处并不是直接使用spring提供的redis-starter--></span></span><br><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>groupId</span>></span>redis.clients<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>    <span class=tag>&lt;<span class=name>artifactId</span>></span>jedis<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line><span class=tag>&lt;/<span class=name>dependency</span>></span></span><br></pre></table></figure><p>外部配置文件：<code>application.yaml</code><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre><td class=code><pre><span class=line><span class=attr>jedis:</span></span><br><span class=line>  <span class=attr>host:</span> <span class=number>127.0</span><span class=number>.0</span><span class=number>.1</span></span><br><span class=line>  <span class=attr>port:</span> <span class=number>6379</span></span><br><span class=line>  <span class=attr>pool:</span></span><br><span class=line>    <span class=attr>max-idle:</span> <span class=number>300</span></span><br><span class=line>    <span class=attr>min-idle:</span> <span class=number>10</span></span><br><span class=line>    <span class=attr>max-total:</span> <span class=number>600</span></span><br><span class=line>    <span class=attr>max-wait:</span> <span class=number>1000</span></span><br><span class=line>    <span class=attr>block-when-exhausted:</span> <span class=literal>true</span></span><br></pre></table></figure><p>Java配置类（替代传统xml）：<code>RedisConfig.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.config;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> lombok.Data;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Bean;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Component;</span><br><span class=line><span class=keyword>import</span> redis.clients.jedis.JedisPool;</span><br><span class=line><span class=keyword>import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class=line></span><br><span class=line><span class=meta>@Data</span></span><br><span class=line><span class=meta>@Component</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">RedisConfig</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean("jedis.config")</span></span><br><span class=line>    <span class=keyword>public</span> JedisPoolConfig <span class="title function_">jedisPoolConfig</span><span class=params>(<span class=meta>@Value("${jedis.pool.min-idle}")</span> <span class=type>int</span> minIdle,</span></span><br><span class=line><span class=params>                                           <span class=meta>@Value("${jedis.pool.max-idle}")</span> <span class=type>int</span> maxIdle,</span></span><br><span class=line><span class=params>                                           <span class=meta>@Value("${jedis.pool.max-wait}")</span> <span class=type>int</span> maxWaitMillis,</span></span><br><span class=line><span class=params>                                           <span class=meta>@Value("${jedis.pool.block-when-exhausted}")</span> <span class=type>boolean</span> blockWhenExhausted,</span></span><br><span class=line><span class=params>                                           <span class=meta>@Value("${jedis.pool.max-total}")</span> <span class=type>int</span> maxTotal)</span> {</span><br><span class=line></span><br><span class=line>        <span class=type>JedisPoolConfig</span> <span class=variable>config</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class=line>        config.setMinIdle(minIdle);</span><br><span class=line>        config.setMaxIdle(maxIdle);</span><br><span class=line>        config.setMaxWaitMillis(maxWaitMillis);</span><br><span class=line>        config.setMaxTotal(maxTotal);</span><br><span class=line>        <span class=comment>// 连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true</span></span><br><span class=line>        config.setBlockWhenExhausted(blockWhenExhausted);</span><br><span class=line>        <span class=comment>// 是否启用pool的jmx管理功能, 默认true</span></span><br><span class=line>        config.setJmxEnabled(<span class=literal>true</span>);</span><br><span class=line>        <span class=keyword>return</span> config;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> JedisPool <span class="title function_">jedisPool</span><span class=params>(<span class=meta>@Qualifier("jedis.config")</span> JedisPoolConfig config,</span></span><br><span class=line><span class=params>                               <span class=meta>@Value("${jedis.host}")</span> String host,</span></span><br><span class=line><span class=params>                               <span class=meta>@Value("${jedis.port}")</span> <span class=type>int</span> port)</span> {</span><br><span class=line>        <span class=keyword>return</span> <span class=keyword>new</span> <span class="title class_">JedisPool</span>(config, host, port);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><p>Service接口定义：<code>RedisService.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.service;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=keyword>interface</span> <span class="title class_">RedisService</span> {</span><br><span class=line></span><br><span class=line>    String <span class="title function_">get</span><span class=params>(String key)</span>;</span><br><span class=line></span><br><span class=line>    <span class=type>boolean</span> <span class="title function_">set</span><span class=params>(String key, String val)</span>;</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><p>Service接口实现类：<code>RedisServiceImpl.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.service.RedisService;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.stereotype.Service;</span><br><span class=line><span class=keyword>import</span> redis.clients.jedis.Jedis;</span><br><span class=line><span class=keyword>import</span> redis.clients.jedis.JedisPool;</span><br><span class=line></span><br><span class=line><span class=meta>@Service</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">RedisServiceImpl</span> <span class=keyword>implements</span> <span class="title class_">RedisService</span> {</span><br><span class=line></span><br><span class=line>    <span class=comment>// 此处直接注入即可</span></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> JedisPool jedisPool;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> String <span class="title function_">get</span><span class=params>(String key)</span> {</span><br><span class=line>        <span class=type>Jedis</span> <span class=variable>jedis</span> <span class=operator>=</span> <span class=built_in>this</span>.jedisPool.getResource();</span><br><span class=line>        String ret;</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            ret = jedis.get(key);</span><br><span class=line>        } <span class=keyword>finally</span> {</span><br><span class=line>            <span class=keyword>if</span> (jedis != <span class=literal>null</span>)</span><br><span class=line>                jedis.close();</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> ret;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Override</span></span><br><span class=line>    <span class=keyword>public</span> <span class=type>boolean</span> <span class="title function_">set</span><span class=params>(String key, String val)</span> {</span><br><span class=line>        <span class=type>Jedis</span> <span class=variable>jedis</span> <span class=operator>=</span> <span class=built_in>this</span>.jedisPool.getResource();</span><br><span class=line>        <span class=keyword>try</span> {</span><br><span class=line>            <span class=keyword>return</span> <span class=string>"OK"</span>.equals(jedis.set(key, val));</span><br><span class=line>        } <span class=keyword>finally</span> {</span><br><span class=line>            <span class=keyword>if</span> (jedis != <span class=literal>null</span>)</span><br><span class=line>                jedis.close();</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><p>测试：<code>RedisServiceImplTest.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.service.impl;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> com.mindex.service.RedisService;</span><br><span class=line><span class=keyword>import</span> org.junit.Assert;</span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">RedisServiceImplTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> RedisService redisService;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">testGet</span><span class=params>()</span> {</span><br><span class=line>        <span class=comment>// test set</span></span><br><span class=line>        <span class=type>boolean</span> <span class=variable>status</span> <span class=operator>=</span> <span class=built_in>this</span>.redisService.set(<span class=string>"foo"</span>, <span class=string>"bar"</span>);</span><br><span class=line>        Assert.assertTrue(status);</span><br><span class=line></span><br><span class=line>        <span class=comment>// test get</span></span><br><span class=line>        <span class=type>String</span> <span class=variable>str</span> <span class=operator>=</span> <span class=built_in>this</span>.redisService.get(<span class=string>"foo"</span>);</span><br><span class=line>        Assert.assertEquals(<span class=string>"bar"</span>, str);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><p>在Redis中检查结果：<br><img src=https://ws1.sinaimg.cn/large/006By2pOgy1fqtwl62vk3j31cq0wkdox.jpg><h3 id=使用spring-boot-starter-data-redis><a class=headerlink href=#使用spring-boot-starter-data-redis title=使用spring-boot-starter-data-redis></a>使用spring-boot-starter-data-redis</h3><p>外部配置文件：<code>application.yaml</code><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br></pre><td class=code><pre><span class=line><span class=attr>jedis:</span></span><br><span class=line>  <span class=attr>host:</span> <span class=number>127.0</span><span class=number>.0</span><span class=number>.1</span></span><br><span class=line>  <span class=attr>port:</span> <span class=number>6379</span></span><br><span class=line>  <span class=attr>pool:</span></span><br><span class=line>    <span class=attr>max-idle:</span> <span class=number>300</span></span><br><span class=line>    <span class=attr>min-idle:</span> <span class=number>10</span></span><br><span class=line>    <span class=attr>max-total:</span> <span class=number>600</span></span><br><span class=line>    <span class=attr>max-wait:</span> <span class=number>1000</span></span><br><span class=line>    <span class=attr>block-when-exhausted:</span> <span class=literal>true</span></span><br></pre></table></figure><p>配置类：<code>RedisConfig1.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex.config;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Bean;</span><br><span class=line><span class=keyword>import</span> org.springframework.context.annotation.Configuration;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.redis.core.*;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.redis.serializer.JdkSerializationRedisSerializer;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class=line></span><br><span class=line><span class=meta>@Configuration</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">RedisConfig1</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> RedisConnectionFactory redisConnectionFactory;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 实例化 RedisTemplate 对象</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> RedisTemplate&lt;String, Object> <span class="title function_">functionDomainRedisTemplate</span><span class=params>()</span> {</span><br><span class=line>        RedisTemplate&lt;String, Object> redisTemplate = <span class=keyword>new</span> <span class="title class_">RedisTemplate</span>&lt;>();</span><br><span class=line>        <span class=built_in>this</span>.initRedisTemplate(redisTemplate, redisConnectionFactory);</span><br><span class=line>        <span class=keyword>return</span> redisTemplate;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 序列化设置</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=keyword>private</span> <span class=keyword>void</span> <span class="title function_">initRedisTemplate</span><span class=params>(RedisTemplate&lt;String, Object> redisTemplate, RedisConnectionFactory factory)</span> {</span><br><span class=line>        redisTemplate.setKeySerializer(<span class=keyword>new</span> <span class="title class_">StringRedisSerializer</span>());</span><br><span class=line>        redisTemplate.setHashKeySerializer(<span class=keyword>new</span> <span class="title class_">StringRedisSerializer</span>());</span><br><span class=line>        redisTemplate.setHashValueSerializer(<span class=keyword>new</span> <span class="title class_">JdkSerializationRedisSerializer</span>());</span><br><span class=line>        redisTemplate.setValueSerializer(<span class=keyword>new</span> <span class="title class_">JdkSerializationRedisSerializer</span>());</span><br><span class=line>        redisTemplate.setConnectionFactory(factory);</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> HashOperations&lt;String, String, Object> <span class="title function_">hashOperations</span><span class=params>(RedisTemplate&lt;String, Object> redisTemplate)</span> {</span><br><span class=line>        <span class=keyword>return</span> redisTemplate.opsForHash();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> ValueOperations&lt;String, Object> <span class="title function_">valueOperations</span><span class=params>(RedisTemplate&lt;String, Object> redisTemplate)</span> {</span><br><span class=line>        <span class=keyword>return</span> redisTemplate.opsForValue();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> ListOperations&lt;String, Object> <span class="title function_">listOperations</span><span class=params>(RedisTemplate&lt;String, Object> redisTemplate)</span> {</span><br><span class=line>        <span class=keyword>return</span> redisTemplate.opsForList();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> SetOperations&lt;String, Object> <span class="title function_">setOperations</span><span class=params>(RedisTemplate&lt;String, Object> redisTemplate)</span> {</span><br><span class=line>        <span class=keyword>return</span> redisTemplate.opsForSet();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Bean</span></span><br><span class=line>    <span class=keyword>public</span> ZSetOperations&lt;String, Object> <span class="title function_">zSetOperations</span><span class=params>(RedisTemplate&lt;String, Object> redisTemplate)</span> {</span><br><span class=line>        <span class=keyword>return</span> redisTemplate.opsForZSet();</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>}</span><br></pre></table></figure><p>简单测试：<code>RedisAnotherConfigTest.java</code><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class=line><span class=keyword>import</span> org.springframework.data.redis.core.ValueOperations;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> org.junit.Assert.assertEquals;</span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> org.junit.Assert.assertNotNull;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">RedisAnotherConfigTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> ValueOperations&lt;String, Object> valueOperations;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> RedisTemplate&lt;String, Object> redisTemplate;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">contextLoads</span><span class=params>()</span> {</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">testStringOps</span><span class=params>()</span> {</span><br><span class=line>        <span class=built_in>this</span>.valueOperations.set(<span class=string>"k1"</span>, <span class=string>"spring-redis"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>Boolean</span> <span class=variable>hasKey</span> <span class=operator>=</span> <span class=built_in>this</span>.redisTemplate.hasKey(<span class=string>"k1"</span>);</span><br><span class=line>        assertEquals(<span class=literal>true</span>, hasKey);</span><br><span class=line></span><br><span class=line>        <span class=type>Object</span> <span class=variable>str</span> <span class=operator>=</span> <span class=built_in>this</span>.valueOperations.get(<span class=string>"k1"</span>);</span><br><span class=line>        assertNotNull(str);</span><br><span class=line>        assertEquals(<span class=string>"spring-redis"</span>, str.toString());</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h2 id=邮件><a class=headerlink href=#邮件 title=邮件></a>邮件</h2><h3 id=使用JavaMailSender发送邮件><a class=headerlink href=#使用JavaMailSender发送邮件 title=使用JavaMailSender发送邮件></a>使用JavaMailSender发送邮件</h3><p>引入POM依赖：<figure class="highlight xml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>dependency</span>></span></span><br><span class=line>     <span class=tag>&lt;<span class=name>groupId</span>></span>org.springframework.boot<span class=tag>&lt;/<span class=name>groupId</span>></span></span><br><span class=line>     <span class=tag>&lt;<span class=name>artifactId</span>></span>spring-boot-starter-mail<span class=tag>&lt;/<span class=name>artifactId</span>></span></span><br><span class=line> <span class=tag>&lt;/<span class=name>dependency</span>></span></span><br></pre></table></figure><p>增加配置：<code>application.properties</code><blockquote><p>注意：这里的<code>password</code>是邮箱授权码，不是邮箱密码。</blockquote><figure class="highlight yaml"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=string>spring.mail.host=smtp.qq.com</span></span><br><span class=line><span class=string>spring.mail.username=85648606@qq.com</span></span><br><span class=line><span class=string>spring.mail.password=clqpsraiifwqbidg</span></span><br><span class=line><span class=string>spring.mail.properties.mail.smtp.auth=true</span></span><br><span class=line><span class=string>spring.mail.properties.mail.smtp.starttls.enable=true</span></span><br><span class=line><span class=string>spring.mail.properties.mail.smtp.starttls.required=true</span></span><br></pre></table></figure><p>单元测试：MailTest.java<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.mindex;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> org.junit.Test;</span><br><span class=line><span class=keyword>import</span> org.junit.runner.RunWith;</span><br><span class=line><span class=keyword>import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=line><span class=keyword>import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class=line><span class=keyword>import</span> org.springframework.mail.SimpleMailMessage;</span><br><span class=line><span class=keyword>import</span> org.springframework.mail.javamail.JavaMailSender;</span><br><span class=line><span class=keyword>import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class=line></span><br><span class=line><span class=meta>@RunWith(SpringRunner.class)</span></span><br><span class=line><span class=meta>@SpringBootTest</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>class</span> <span class="title class_">MailTest</span> {</span><br><span class=line></span><br><span class=line>    <span class=meta>@Autowired</span></span><br><span class=line>    <span class=keyword>private</span> JavaMailSender mailSender;</span><br><span class=line></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendSimpleMail</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        <span class=type>SimpleMailMessage</span> <span class=variable>message</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">SimpleMailMessage</span>();</span><br><span class=line>        message.setFrom(<span class=string>"85648606@qq.com"</span>);</span><br><span class=line>        message.setTo(<span class=string>"wfgdlut@msn.com"</span>);</span><br><span class=line>        message.setSubject(<span class=string>"主题：简单邮件"</span>);</span><br><span class=line>        message.setText(<span class=string>"测试邮件内容"</span>);</span><br><span class=line></span><br><span class=line>        mailSender.send(message);</span><br><span class=line>    }</span><br><span class=line>}</span><br></pre></table></figure><h3 id=发送html格式邮件><a class=headerlink href=#发送html格式邮件 title=发送html格式邮件></a>发送html格式邮件</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line><span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendAttachmentsMail</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line></span><br><span class=line>        <span class=type>MimeMessage</span> <span class=variable>mimeMessage</span> <span class=operator>=</span> mailSender.createMimeMessage();</span><br><span class=line>        <span class=type>MimeMessageHelper</span> <span class=variable>mimeMessageHelper</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage);</span><br><span class=line>        mimeMessageHelper.setFrom(<span class=string>"85648606@qq.com"</span>);</span><br><span class=line>        mimeMessageHelper.setTo(<span class=string>"wfgdlut@msn.com"</span>);</span><br><span class=line>        mimeMessageHelper.setSubject(<span class=string>"Spring Boot Mail 邮件测试【HTML】"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>StringBuilder</span> <span class=variable>sb</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">StringBuilder</span>();</span><br><span class=line>        sb.append(<span class=string>"&lt;html>&lt;head>&lt;/head>"</span>);</span><br><span class=line>        sb.append(<span class=string>"&lt;body>&lt;h1>spring 邮件测试&lt;/h1>&lt;p>hello!this is spring mail test。&lt;/p>&lt;/body>"</span>);</span><br><span class=line>        sb.append(<span class=string>"&lt;/html>"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 启用html</span></span><br><span class=line>        mimeMessageHelper.setText(sb.toString(), <span class=literal>true</span>);</span><br><span class=line>        <span class=comment>// 发送邮件</span></span><br><span class=line>        mailSender.send(mimeMessage);</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"邮件已发送"</span>);</span><br><span class=line></span><br><span class=line>    }</span><br></pre></table></figure><h3 id=发送包含内嵌图片的邮件><a class=headerlink href=#发送包含内嵌图片的邮件 title=发送包含内嵌图片的邮件></a>发送包含内嵌图片的邮件</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment>     * 发送包含内嵌图片的邮件</span></span><br><span class=line><span class=comment>     *</span></span><br><span class=line><span class=comment>     * <span class=doctag>@throws</span> Exception</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendAttachedImageMail</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        <span class=type>MimeMessage</span> <span class=variable>mimeMessage</span> <span class=operator>=</span> mailSender.createMimeMessage();</span><br><span class=line>        <span class=comment>// multipart模式</span></span><br><span class=line>        <span class=type>MimeMessageHelper</span> <span class=variable>mimeMessageHelper</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage, <span class=literal>true</span>);</span><br><span class=line>        mimeMessageHelper.setFrom(<span class=string>"85648606@qq.com"</span>);</span><br><span class=line>        mimeMessageHelper.setTo(<span class=string>"wfgdlut@msn.com"</span>);</span><br><span class=line>        mimeMessageHelper.setSubject(<span class=string>"Spring Boot Mail 邮件测试【图片】"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>StringBuilder</span> <span class=variable>sb</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">StringBuilder</span>();</span><br><span class=line>        sb.append(<span class=string>"&lt;html>&lt;head>&lt;/head>"</span>);</span><br><span class=line>        sb.append(<span class=string>"&lt;body>&lt;h1>spring 邮件测试&lt;/h1>&lt;p>hello!this is spring mail test。&lt;/p>"</span>);</span><br><span class=line>        <span class=comment>// cid为固定写法，imageId指定一个标识</span></span><br><span class=line>        sb.append(<span class=string>"&lt;img src=\"cid:imageId\"/>&lt;/body>"</span>);</span><br><span class=line>        sb.append(<span class=string>"&lt;/html>"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 启用html</span></span><br><span class=line>        mimeMessageHelper.setText(sb.toString(), <span class=literal>true</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 设置imageId</span></span><br><span class=line>        <span class=type>FileSystemResource</span> <span class=variable>img</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FileSystemResource</span>(<span class=keyword>new</span> <span class="title class_">File</span>(<span class=string>"/Users/kwang/IdeaProjects/SpringBootDemoProject/src/main/resources/static/test.png"</span>));</span><br><span class=line>        mimeMessageHelper.addInline(<span class=string>"imageId"</span>, img);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 发送邮件</span></span><br><span class=line>        mailSender.send(mimeMessage);</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"邮件已发送"</span>);</span><br><span class=line>    }</span><br></pre></table></figure><h3 id=发送包含附件的邮件><a class=headerlink href=#发送包含附件的邮件 title=发送包含附件的邮件></a>发送包含附件的邮件</h3><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br></pre><td class=code><pre><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment>     * 发送包含附件的邮件</span></span><br><span class=line><span class=comment>     * <span class=doctag>@throws</span> Exception</span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=meta>@Test</span></span><br><span class=line>    <span class=keyword>public</span> <span class=keyword>void</span> <span class="title function_">sendAttendedFileMail</span><span class=params>()</span> <span class=keyword>throws</span> Exception {</span><br><span class=line>        <span class=type>MimeMessage</span> <span class=variable>mimeMessage</span> <span class=operator>=</span> mailSender.createMimeMessage();</span><br><span class=line>        <span class=comment>// multipart模式</span></span><br><span class=line>        <span class=type>MimeMessageHelper</span> <span class=variable>mimeMessageHelper</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">MimeMessageHelper</span>(mimeMessage, <span class=literal>true</span>, <span class=string>"utf-8"</span>);</span><br><span class=line>        mimeMessageHelper.setFrom(<span class=string>"85648606@qq.com"</span>);</span><br><span class=line>        mimeMessageHelper.setTo(<span class=string>"wfgdlut@msn.com"</span>);</span><br><span class=line>        mimeMessageHelper.setSubject(<span class=string>"Spring Boot Mail 邮件测试【附件】"</span>);</span><br><span class=line></span><br><span class=line>        <span class=type>StringBuilder</span> <span class=variable>sb</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">StringBuilder</span>();</span><br><span class=line>        sb.append(<span class=string>"&lt;html>&lt;head>&lt;/head>"</span>);</span><br><span class=line>        sb.append(<span class=string>"&lt;body>&lt;h1>spring 邮件测试&lt;/h1>&lt;p>hello!this is spring mail test。&lt;/p>&lt;/body>"</span>);</span><br><span class=line>        sb.append(<span class=string>"&lt;/html>"</span>);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 启用html</span></span><br><span class=line>        mimeMessageHelper.setText(sb.toString(), <span class=literal>true</span>);</span><br><span class=line>        <span class=comment>// 设置附件</span></span><br><span class=line>        <span class=type>FileSystemResource</span> <span class=variable>img</span> <span class=operator>=</span> <span class=keyword>new</span> <span class="title class_">FileSystemResource</span>(<span class=keyword>new</span> <span class="title class_">File</span>(<span class=string>"/Users/kwang/IdeaProjects/SpringBootDemoProject/src/main/resources/static/test.png"</span>));</span><br><span class=line>        mimeMessageHelper.addAttachment(<span class=string>"test.png"</span>, img);</span><br><span class=line></span><br><span class=line>        <span class=comment>// 发送邮件</span></span><br><span class=line>        mailSender.send(mimeMessage);</span><br><span class=line></span><br><span class=line>        System.out.println(<span class=string>"邮件已发送"</span>);</span><br><span class=line>    }</span><br></pre></table></figure></div><footer class=post-footer><div class=post-copyright><ul><li class=post-copyright-author><strong>本文作者： </strong>王方钢 / Kenny Wang<li class=post-copyright-link><strong>本文链接：</strong> <a title="Spring Boot 学习笔记 - 钢钢更新" href=https://wangfanggang.com/Java/Spring-Boot/springboot/>https://wangfanggang.com/Java/Spring-Boot/springboot/</a><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh rel=noopener target=_blank><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</ul></div><div class=post-tags><a href=/tags/Java/ rel=tag># Java</a><a href=/tags/Spring-Boot/ rel=tag># Spring Boot</a></div><div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style"><a class=a2a_dd href=https://www.addtoany.com/share rel=noopener target=_blank></a><a class=a2a_button_facebook></a><a class=a2a_button_twitter></a><a class=a2a_button_wechat></a></div><div class=post-nav><div class=post-nav-item><a title="腾讯云COSFS工具使用说明 - 钢钢更新" href=/%E8%85%BE%E8%AE%AF%E4%BA%91/cosfs/ rel=prev> <i class="fa fa-angle-left"></i> 腾讯云COSFS工具使用说明 - 钢钢更新 </a></div><div class=post-nav-item><a title="ElasticSearch学习笔记 - 钢钢更新" href=/ElasticSearch/ElasticSearch/ rel=next> ElasticSearch学习笔记 - 钢钢更新 <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2017 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>王方钢 / Kenny Wang</span></div><div class=wordcount><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-chart-line"></i> </span> <span title=站点总字数>330k</span> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="fa fa-coffee"></i> </span> <span title=站点阅读时长>20:01</span> </span></div><div class=powered-by>由 <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/muse/ rel=noopener target=_blank>NexT.Muse</a> 强力驱动</div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript>